<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cocoon: RAG Large Data Pipeline</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #333;
        }
        .highlight {
            background: #272822;
            color: #f8f8f2;
            border-radius: 4px;
            padding: 1em;
            margin: 1em 0;
            overflow-x: auto;
            font-size: 12px;
        }
        pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #49483e }
.highlight { background: #272822; color: #f8f8f2 }
.highlight .c { color: #959077 } /* Comment */
.highlight .err { color: #ed007e; background-color: #1e0010 } /* Error */
.highlight .esc { color: #f8f8f2 } /* Escape */
.highlight .g { color: #f8f8f2 } /* Generic */
.highlight .k { color: #66d9ef } /* Keyword */
.highlight .l { color: #ae81ff } /* Literal */
.highlight .n { color: #f8f8f2 } /* Name */
.highlight .o { color: #ff4689 } /* Operator */
.highlight .x { color: #f8f8f2 } /* Other */
.highlight .p { color: #f8f8f2 } /* Punctuation */
.highlight .ch { color: #959077 } /* Comment.Hashbang */
.highlight .cm { color: #959077 } /* Comment.Multiline */
.highlight .cp { color: #959077 } /* Comment.Preproc */
.highlight .cpf { color: #959077 } /* Comment.PreprocFile */
.highlight .c1 { color: #959077 } /* Comment.Single */
.highlight .cs { color: #959077 } /* Comment.Special */
.highlight .gd { color: #ff4689 } /* Generic.Deleted */
.highlight .ge { color: #f8f8f2; font-style: italic } /* Generic.Emph */
.highlight .ges { color: #f8f8f2; font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.highlight .gr { color: #f8f8f2 } /* Generic.Error */
.highlight .gh { color: #f8f8f2 } /* Generic.Heading */
.highlight .gi { color: #a6e22e } /* Generic.Inserted */
.highlight .go { color: #66d9ef } /* Generic.Output */
.highlight .gp { color: #ff4689; font-weight: bold } /* Generic.Prompt */
.highlight .gs { color: #f8f8f2; font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #959077 } /* Generic.Subheading */
.highlight .gt { color: #f8f8f2 } /* Generic.Traceback */
.highlight .kc { color: #66d9ef } /* Keyword.Constant */
.highlight .kd { color: #66d9ef } /* Keyword.Declaration */
.highlight .kn { color: #ff4689 } /* Keyword.Namespace */
.highlight .kp { color: #66d9ef } /* Keyword.Pseudo */
.highlight .kr { color: #66d9ef } /* Keyword.Reserved */
.highlight .kt { color: #66d9ef } /* Keyword.Type */
.highlight .ld { color: #e6db74 } /* Literal.Date */
.highlight .m { color: #ae81ff } /* Literal.Number */
.highlight .s { color: #e6db74 } /* Literal.String */
.highlight .na { color: #a6e22e } /* Name.Attribute */
.highlight .nb { color: #f8f8f2 } /* Name.Builtin */
.highlight .nc { color: #a6e22e } /* Name.Class */
.highlight .no { color: #66d9ef } /* Name.Constant */
.highlight .nd { color: #a6e22e } /* Name.Decorator */
.highlight .ni { color: #f8f8f2 } /* Name.Entity */
.highlight .ne { color: #a6e22e } /* Name.Exception */
.highlight .nf { color: #a6e22e } /* Name.Function */
.highlight .nl { color: #f8f8f2 } /* Name.Label */
.highlight .nn { color: #f8f8f2 } /* Name.Namespace */
.highlight .nx { color: #a6e22e } /* Name.Other */
.highlight .py { color: #f8f8f2 } /* Name.Property */
.highlight .nt { color: #ff4689 } /* Name.Tag */
.highlight .nv { color: #f8f8f2 } /* Name.Variable */
.highlight .ow { color: #ff4689 } /* Operator.Word */
.highlight .pm { color: #f8f8f2 } /* Punctuation.Marker */
.highlight .w { color: #f8f8f2 } /* Text.Whitespace */
.highlight .mb { color: #ae81ff } /* Literal.Number.Bin */
.highlight .mf { color: #ae81ff } /* Literal.Number.Float */
.highlight .mh { color: #ae81ff } /* Literal.Number.Hex */
.highlight .mi { color: #ae81ff } /* Literal.Number.Integer */
.highlight .mo { color: #ae81ff } /* Literal.Number.Oct */
.highlight .sa { color: #e6db74 } /* Literal.String.Affix */
.highlight .sb { color: #e6db74 } /* Literal.String.Backtick */
.highlight .sc { color: #e6db74 } /* Literal.String.Char */
.highlight .dl { color: #e6db74 } /* Literal.String.Delimiter */
.highlight .sd { color: #e6db74 } /* Literal.String.Doc */
.highlight .s2 { color: #e6db74 } /* Literal.String.Double */
.highlight .se { color: #ae81ff } /* Literal.String.Escape */
.highlight .sh { color: #e6db74 } /* Literal.String.Heredoc */
.highlight .si { color: #e6db74 } /* Literal.String.Interpol */
.highlight .sx { color: #e6db74 } /* Literal.String.Other */
.highlight .sr { color: #e6db74 } /* Literal.String.Regex */
.highlight .s1 { color: #e6db74 } /* Literal.String.Single */
.highlight .ss { color: #e6db74 } /* Literal.String.Symbol */
.highlight .bp { color: #f8f8f2 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #a6e22e } /* Name.Function.Magic */
.highlight .vc { color: #f8f8f2 } /* Name.Variable.Class */
.highlight .vg { color: #f8f8f2 } /* Name.Variable.Global */
.highlight .vi { color: #f8f8f2 } /* Name.Variable.Instance */
.highlight .vm { color: #f8f8f2 } /* Name.Variable.Magic */
.highlight .il { color: #ae81ff } /* Literal.Number.Integer.Long */
        .tag {
    display: inline-block;
    padding: 0.25em 0.6em;
    font-size: 75%;
    font-weight: 700;
    line-height: 1;
    text-align: center;
    white-space: nowrap;
    vertical-align: baseline;
    border-radius: 0.4rem;
    margin-right: 0.5em; /* Adds space between tags */
}
        
table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
tr, th, td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
th {
  font-weight: bold;
}

tbody tr:nth-child(even) {
    background: #f5f5f5;
}

tbody {
    display: table-row-group;
    vertical-align: middle;
    unicode-bidi: isolate;
    border-color: inherit;
}

tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

        .container {
            max-width: 1200px;
            padding: 40px 20px;
        }
        .search-form {
            display: flex;
            margin-bottom: 30px;
        }
        .search-input {
            flex-grow: 1;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 4px 0 0 4px;
            font-size: 16px;
        }
        .search-button {
            background-color: #000;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 0 4px 4px 0;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        .search-button:hover {
            background-color: #333;
        }
        .recommended {
            margin-top: 30px;
        }
        .recommended a {
            display: inline-block;
            margin-right: 10px;
            margin-bottom: 10px;
            padding: 8px 16px;
            border: 1px solid #ddd;
            border-radius: 20px;
            text-decoration: none;
            color: #555;
            font-size: 14px;
            transition: all 0.3s;
        }
        .recommended a:hover {
            background-color: #e9ecef;
            color: #333;
        }
        .header {
            margin-bottom: 40px;
        }
        .logo {
            font-size: 24px;
            font-weight: bold;
        }
        .subtitle {
            font-size: 16px;
            color: #6c757d;
        }
        .cocoon-info {
            background-color: #e9ecef;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
        }
        .video-container {
            margin-top: 40px;
            text-align: center;
        }
        .lineage-container {
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin-top: 30px;
        }
    </style>
</head>
<body class="bg-light">
  <div class="container py-5">
    <header class="text-center d-flex align-items-start justify-content-center mb-5">
        <div class="bg-white rounded-circle p-2 me-3" style="width: 150px; height: 150px; display: flex; align-items: center; justify-content: center; margin-top: -10px;">
          <img src="https://raw.githubusercontent.com/Cocoon-Data-Transformation/cocoon/main/images/cocoon_icon.png" alt="cocoon icon" width="70">
        </div>
        <div>
          <h1 class="fw-bold mb-2">
            Cocoon: RAG Large Data Pipeline
          </h1>
          <p class="lead mb-2">Cocoon prepares large & complex data pipeline for RAG, enabling dbt copilot functionality: </p>
          <div class="recommended mt-1">
            <a href="#" class="m-1 text-decoration-none text-center" title="Models & Lineage Discovery" onclick="document.getElementById('question').value='What end reports are this DBT project building?'; document.querySelector('.search-form').scrollIntoView({behavior: 'smooth', block: 'center'}); return false;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-diagram-3" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M6 3.5A1.5 1.5 0 0 1 7.5 2h1A1.5 1.5 0 0 1 10 3.5v1A1.5 1.5 0 0 1 8.5 6v1H14a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-1 0V8h-5v.5a.5.5 0 0 1-1 0V8h-5v.5a.5.5 0 0 1-1 0v-1A.5.5 0 0 1 2 7h5.5V6A1.5 1.5 0 0 1 6 4.5v-1zM8.5 5a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1zM0 11.5A1.5 1.5 0 0 1 1.5 10h1A1.5 1.5 0 0 1 4 11.5v1A1.5 1.5 0 0 1 2.5 14h-1A1.5 1.5 0 0 1 0 12.5v-1zm1.5-.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5h-1zm4.5.5A1.5 1.5 0 0 1 7.5 10h1a1.5 1.5 0 0 1 1.5 1.5v1A1.5 1.5 0 0 1 8.5 14h-1A1.5 1.5 0 0 1 6 12.5v-1zm1.5-.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5h-1zm4.5.5a1.5 1.5 0 0 1 1.5-1.5h1a1.5 1.5 0 0 1 1.5 1.5v1a1.5 1.5 0 0 1-1.5 1.5h-1a1.5 1.5 0 0 1-1.5-1.5v-1zm1.5-.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5h-1z"/>
                    </svg>
                <small>Models & Lineage Discovery</small>
            </a>
            <a href="#" class="m-1 text-decoration-none text-center" title="Safe Model Edits & Debugging" onclick="document.getElementById('question').value='For `stg_shopify__abandoned_checkout`, I want to update `checkout_id` to `abandoned_checkout_id`. Help me find the edits I need to make for downstream models.'; document.querySelector('.search-form').scrollIntoView({behavior: 'smooth', block: 'center'}); return false;">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-shield-check" viewBox="0 0 16 16">
                    <path d="M5.338 1.59a61.44 61.44 0 0 0-2.837.856.481.481 0 0 0-.328.39c-.554 4.157.726 7.19 2.253 9.188a10.725 10.725 0 0 0 2.287 2.233c.346.244.652.42.893.533.12.057.218.095.293.118a.55.55 0 0 0 .101.025.615.615 0 0 0 .1-.025c.076-.023.174-.061.294-.118.24-.113.547-.29.893-.533a10.726 10.726 0 0 0 2.287-2.233c1.527-1.997 2.807-5.031 2.253-9.188a.48.48 0 0 0-.328-.39c-.651-.213-1.75-.56-2.837-.855C9.552 1.29 8.531 1.067 8 1.067c-.53 0-1.552.223-2.662.524zM5.072.56C6.157.265 7.31 0 8 0s1.843.265 2.928.56c1.11.3 2.229.655 2.887.87a1.54 1.54 0 0 1 1.044 1.262c.596 4.477-.787 7.795-2.465 9.99a11.775 11.775 0 0 1-2.517 2.453 7.159 7.159 0 0 1-1.048.625c-.28.132-.581.24-.829.24s-.548-.108-.829-.24a7.158 7.158 0 0 1-1.048-.625 11.777 11.777 0 0 1-2.517-2.453C1.928 10.487.545 7.169 1.141 2.692A1.54 1.54 0 0 1 2.185 1.43 62.456 62.456 0 0 1 5.072.56z"/>
                    <path d="M10.854 5.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 7.793l2.646-2.647a.5.5 0 0 1 .708 0z"/>
                </svg>
                <small>Safe Model Edits & Debugging</small>
            </a>
            <a href="#" class="m-1 text-decoration-none text-center" title="New Pipelines Prototyping" onclick="document.getElementById('question').value='How many abandoned checkouts were there last month?'; document.querySelector('.search-form').scrollIntoView({behavior: 'smooth', block: 'center'}); return false;">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-lightning" viewBox="0 0 16 16">
                    <path d="M5.52.359A.5.5 0 0 1 6 0h4a.5.5 0 0 1 .474.658L8.694 6H12.5a.5.5 0 0 1 .395.807l-7 9a.5.5 0 0 1-.873-.454L6.823 9.5H3.5a.5.5 0 0 1-.48-.641l2.5-8.5zM6.374 1 4.168 8.5H7.5a.5.5 0 0 1 .478.647L6.78 13.04 11.478 7H8a.5.5 0 0 1-.474-.658L9.306 1H6.374z"/>
                </svg>
                <small>New Pipelines Prototyping</small>
            </a>
            <a href="#" class="m-1 text-decoration-none text-center" title="Natural Language Querying" onclick="document.getElementById('question').value='Are there any bottlenecks in our shipping process?'; document.querySelector('.search-form').scrollIntoView({behavior: 'smooth', block: 'center'}); return false;">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chat-dots" viewBox="0 0 16 16">
                    <path d="M5 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/>
                    <path d="m2.165 15.803.02-.004c1.83-.363 2.948-.842 3.468-1.105A9.06 9.06 0 0 0 8 15c4.418 0 8-3.134 8-7s-3.582-7-8-7-8 3.134-8 7c0 1.76.743 3.37 1.97 4.6a10.437 10.437 0 0 1-.524 2.318l-.003.011a10.722 10.722 0 0 1-.244.637c-.079.186.074.394.273.362a21.673 21.673 0 0 0 .693-.125zm.8-3.108a1 1 0 0 0-.287-.801C1.618 10.83 1 9.468 1 8c0-3.192 3.004-6 7-6s7 2.808 7 6c0 3.193-3.004 6-7 6a8.06 8.06 0 0 1-2.088-.272 1 1 0 0 0-.711.074c-.387.196-1.24.57-2.634.893a10.97 10.97 0 0 0 .398-2z"/>
                </svg>
                <small>Natural Language Querying</small>
            </a>
            </div>
        </div>
    </header>



        <!-- Video and Notebook CTA Section -->
        <section class="bg-white p-4 rounded shadow-sm mb-5">
        <div class="row align-items-center">
            <div class="col-lg-7 mb-4 mb-lg-0">
                <div class="ratio ratio-16x9">
                    <iframe src="https://www.youtube.com/embed/kv5mwTkpfY0" allowfullscreen></iframe>
                </div>
            </div>
            <div class="col-lg-5 text-center d-flex flex-column justify-content-center">
                <h1 class="h3 mb-4">Get Started with Notebook</h1>
                <a href="https://colab.research.google.com/github/Cocoon-Data-Transformation/cocoon/blob/main/demo/Cocoon_RAG_pipeline.ipynb" target="_blank" class="btn btn-primary btn-lg w-100 mb-3">Try Cocoon</a>
            </div>
        </div>
        </section>


        

          <!-- Live RAG Demo Section -->
          <section class="bg-white p-4 rounded shadow-sm mb-5">
            <h2 class="h1 mb-5 text-center">Live Demo: RAG Shopify dbt project in 2 steps</h1>
            <hr>


            <h3 class="h3 mt-5 mb-2 text-center">Step 1: Prepare Lightweight RAG in Seconds</h3>
            <p class="text-muted text-center mb-4"><small>Instead of traditional Vector RAG, Cocoon builds novel RAG based on pipeline lineage.<br> Optionally, Cocoon offers Deep RAG preparation that generates model & column description, and column lineage.</small></p>
     
            <!-- Preparation Section -->
            <div class="mb-5">
                <div class="card">
                    <div class="card-body">
                        

  <div class="dropdown mb-3">
    <button class="btn btn-dark dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
        Explore Model
    </button>
    <ul class="dropdown-menu">
        <li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_0Content" aria-expanded="true" aria-controls="model_summary_all_0Content">Model Lineage</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_1Content" aria-expanded="false" aria-controls="model_summary_all_1Content">1. model.shopify.shopify__calendar</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_2Content" aria-expanded="false" aria-controls="model_summary_all_2Content">2. model.shopify_source.stg_shopify__abandoned_checkout_discount_code_tmp</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_3Content" aria-expanded="false" aria-controls="model_summary_all_3Content">3. model.shopify_source.stg_shopify__abandoned_checkout_shipping_line_tmp</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_4Content" aria-expanded="false" aria-controls="model_summary_all_4Content">4. model.shopify_source.stg_shopify__abandoned_checkout_tmp</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_5Content" aria-expanded="false" aria-controls="model_summary_all_5Content">5. model.shopify_source.stg_shopify__collection_product_tmp</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_6Content" aria-expanded="false" aria-controls="model_summary_all_6Content">6. model.shopify_source.stg_shopify__collection_tmp</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_7Content" aria-expanded="false" aria-controls="model_summary_all_7Content">7. model.shopify_source.stg_shopify__customer_tag_tmp</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_8Content" aria-expanded="false" aria-controls="model_summary_all_8Content">8. model.shopify_source.stg_shopify__customer_tmp</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_9Content" aria-expanded="false" aria-controls="model_summary_all_9Content">9. model.shopify_source.stg_shopify__discount_code_tmp</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_10Content" aria-expanded="false" aria-controls="model_summary_all_10Content">10. model.shopify_source.stg_shopify__fulfillment_tmp</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_11Content" aria-expanded="false" aria-controls="model_summary_all_11Content">11. model.shopify_source.stg_shopify__inventory_item_tmp</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_12Content" aria-expanded="false" aria-controls="model_summary_all_12Content">12. model.shopify_source.stg_shopify__inventory_level_tmp</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_13Content" aria-expanded="false" aria-controls="model_summary_all_13Content">13. model.shopify_source.stg_shopify__location_tmp</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_14Content" aria-expanded="false" aria-controls="model_summary_all_14Content">14. model.shopify_source.stg_shopify__metafield_tmp</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_15Content" aria-expanded="false" aria-controls="model_summary_all_15Content">15. model.shopify_source.stg_shopify__order_adjustment_tmp</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_16Content" aria-expanded="false" aria-controls="model_summary_all_16Content">16. model.shopify_source.stg_shopify__order_discount_code_tmp</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_17Content" aria-expanded="false" aria-controls="model_summary_all_17Content">17. model.shopify_source.stg_shopify__order_line_refund_tmp</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_18Content" aria-expanded="false" aria-controls="model_summary_all_18Content">18. model.shopify_source.stg_shopify__order_line_tmp</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_19Content" aria-expanded="false" aria-controls="model_summary_all_19Content">19. model.shopify_source.stg_shopify__order_note_attribute_tmp</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_20Content" aria-expanded="false" aria-controls="model_summary_all_20Content">20. model.shopify_source.stg_shopify__order_shipping_line_tmp</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_21Content" aria-expanded="false" aria-controls="model_summary_all_21Content">21. model.shopify_source.stg_shopify__order_shipping_tax_line_tmp</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_22Content" aria-expanded="false" aria-controls="model_summary_all_22Content">22. model.shopify_source.stg_shopify__order_tag_tmp</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_23Content" aria-expanded="false" aria-controls="model_summary_all_23Content">23. model.shopify_source.stg_shopify__order_tmp</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_24Content" aria-expanded="false" aria-controls="model_summary_all_24Content">24. model.shopify_source.stg_shopify__order_url_tag_tmp</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_25Content" aria-expanded="false" aria-controls="model_summary_all_25Content">25. model.shopify_source.stg_shopify__price_rule_tmp</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_26Content" aria-expanded="false" aria-controls="model_summary_all_26Content">26. model.shopify_source.stg_shopify__product_image_tmp</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_27Content" aria-expanded="false" aria-controls="model_summary_all_27Content">27. model.shopify_source.stg_shopify__product_tag_tmp</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_28Content" aria-expanded="false" aria-controls="model_summary_all_28Content">28. model.shopify_source.stg_shopify__product_tmp</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_29Content" aria-expanded="false" aria-controls="model_summary_all_29Content">29. model.shopify_source.stg_shopify__product_variant_tmp</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_30Content" aria-expanded="false" aria-controls="model_summary_all_30Content">30. model.shopify_source.stg_shopify__refund_tmp</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_31Content" aria-expanded="false" aria-controls="model_summary_all_31Content">31. model.shopify_source.stg_shopify__shop_tmp</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_32Content" aria-expanded="false" aria-controls="model_summary_all_32Content">32. model.shopify_source.stg_shopify__tax_line_tmp</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_33Content" aria-expanded="false" aria-controls="model_summary_all_33Content">33. model.shopify_source.stg_shopify__tender_transaction_tmp</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_34Content" aria-expanded="false" aria-controls="model_summary_all_34Content">34. model.shopify_source.stg_shopify__transaction_tmp</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_35Content" aria-expanded="false" aria-controls="model_summary_all_35Content">35. model.shopify_source.stg_shopify__abandoned_checkout</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_36Content" aria-expanded="false" aria-controls="model_summary_all_36Content">36. model.shopify_source.stg_shopify__abandoned_checkout_discount_code</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_37Content" aria-expanded="false" aria-controls="model_summary_all_37Content">37. model.shopify_source.stg_shopify__abandoned_checkout_shipping_line</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_38Content" aria-expanded="false" aria-controls="model_summary_all_38Content">38. model.shopify_source.stg_shopify__collection</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_39Content" aria-expanded="false" aria-controls="model_summary_all_39Content">39. model.shopify_source.stg_shopify__collection_product</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_40Content" aria-expanded="false" aria-controls="model_summary_all_40Content">40. model.shopify_source.stg_shopify__customer</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_41Content" aria-expanded="false" aria-controls="model_summary_all_41Content">41. model.shopify_source.stg_shopify__customer_tag</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_42Content" aria-expanded="false" aria-controls="model_summary_all_42Content">42. model.shopify_source.stg_shopify__discount_code</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_43Content" aria-expanded="false" aria-controls="model_summary_all_43Content">43. model.shopify_source.stg_shopify__fulfillment</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_44Content" aria-expanded="false" aria-controls="model_summary_all_44Content">44. model.shopify_source.stg_shopify__inventory_item</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_45Content" aria-expanded="false" aria-controls="model_summary_all_45Content">45. model.shopify_source.stg_shopify__inventory_level</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_46Content" aria-expanded="false" aria-controls="model_summary_all_46Content">46. model.shopify_source.stg_shopify__location</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_47Content" aria-expanded="false" aria-controls="model_summary_all_47Content">47. model.shopify_source.stg_shopify__metafield</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_48Content" aria-expanded="false" aria-controls="model_summary_all_48Content">48. model.shopify_source.stg_shopify__order</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_49Content" aria-expanded="false" aria-controls="model_summary_all_49Content">49. model.shopify_source.stg_shopify__order_adjustment</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_50Content" aria-expanded="false" aria-controls="model_summary_all_50Content">50. model.shopify_source.stg_shopify__order_discount_code</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_51Content" aria-expanded="false" aria-controls="model_summary_all_51Content">51. model.shopify_source.stg_shopify__order_line</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_52Content" aria-expanded="false" aria-controls="model_summary_all_52Content">52. model.shopify_source.stg_shopify__order_line_refund</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_53Content" aria-expanded="false" aria-controls="model_summary_all_53Content">53. model.shopify_source.stg_shopify__order_note_attribute</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_54Content" aria-expanded="false" aria-controls="model_summary_all_54Content">54. model.shopify_source.stg_shopify__order_shipping_line</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_55Content" aria-expanded="false" aria-controls="model_summary_all_55Content">55. model.shopify_source.stg_shopify__order_shipping_tax_line</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_56Content" aria-expanded="false" aria-controls="model_summary_all_56Content">56. model.shopify_source.stg_shopify__order_tag</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_57Content" aria-expanded="false" aria-controls="model_summary_all_57Content">57. model.shopify_source.stg_shopify__order_url_tag</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_58Content" aria-expanded="false" aria-controls="model_summary_all_58Content">58. model.shopify_source.stg_shopify__price_rule</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_59Content" aria-expanded="false" aria-controls="model_summary_all_59Content">59. model.shopify_source.stg_shopify__product</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_60Content" aria-expanded="false" aria-controls="model_summary_all_60Content">60. model.shopify_source.stg_shopify__product_image</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_61Content" aria-expanded="false" aria-controls="model_summary_all_61Content">61. model.shopify_source.stg_shopify__product_tag</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_62Content" aria-expanded="false" aria-controls="model_summary_all_62Content">62. model.shopify_source.stg_shopify__product_variant</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_63Content" aria-expanded="false" aria-controls="model_summary_all_63Content">63. model.shopify_source.stg_shopify__refund</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_64Content" aria-expanded="false" aria-controls="model_summary_all_64Content">64. model.shopify_source.stg_shopify__shop</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_65Content" aria-expanded="false" aria-controls="model_summary_all_65Content">65. model.shopify_source.stg_shopify__tax_line</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_66Content" aria-expanded="false" aria-controls="model_summary_all_66Content">66. model.shopify_source.stg_shopify__tender_transaction</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_67Content" aria-expanded="false" aria-controls="model_summary_all_67Content">67. model.shopify_source.stg_shopify__transaction</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_68Content" aria-expanded="false" aria-controls="model_summary_all_68Content">68. model.shopify.int_shopify__daily_abandoned_checkouts</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_69Content" aria-expanded="false" aria-controls="model_summary_all_69Content">69. model.shopify.int_shopify__customer_email_rollup</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_70Content" aria-expanded="false" aria-controls="model_summary_all_70Content">70. model.shopify.int_shopify__order__shipping_aggregates</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_71Content" aria-expanded="false" aria-controls="model_summary_all_71Content">71. model.shopify.shopify__orders__order_refunds</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_72Content" aria-expanded="false" aria-controls="model_summary_all_72Content">72. model.shopify.shopify__transactions</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_73Content" aria-expanded="false" aria-controls="model_summary_all_73Content">73. model.shopify.int_shopify__discounts__abandoned_checkouts</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_74Content" aria-expanded="false" aria-controls="model_summary_all_74Content">74. model.shopify.shopify__orders__order_line_aggregates</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_75Content" aria-expanded="false" aria-controls="model_summary_all_75Content">75. model.shopify.int_shopify__inventory_level__aggregates</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_76Content" aria-expanded="false" aria-controls="model_summary_all_76Content">76. model.shopify.int_shopify__products_with_aggregates</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_77Content" aria-expanded="false" aria-controls="model_summary_all_77Content">77. model.shopify.shopify__order_lines</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_78Content" aria-expanded="false" aria-controls="model_summary_all_78Content">78. model.shopify.int_shopify__emails__order_aggregates</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_79Content" aria-expanded="false" aria-controls="model_summary_all_79Content">79. model.shopify.shopify__customers__order_aggregates</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_80Content" aria-expanded="false" aria-controls="model_summary_all_80Content">80. model.shopify.shopify__inventory_levels</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_81Content" aria-expanded="false" aria-controls="model_summary_all_81Content">81. model.shopify.shopify__orders</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_82Content" aria-expanded="false" aria-controls="model_summary_all_82Content">82. model.shopify.shopify__customers</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_83Content" aria-expanded="false" aria-controls="model_summary_all_83Content">83. model.shopify.shopify__customer_emails</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_84Content" aria-expanded="false" aria-controls="model_summary_all_84Content">84. model.shopify.int_shopify__discounts__order_aggregates</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_85Content" aria-expanded="false" aria-controls="model_summary_all_85Content">85. model.shopify.int_shopify__daily_orders</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_86Content" aria-expanded="false" aria-controls="model_summary_all_86Content">86. model.shopify.int_shopify__product__order_line_aggregates</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_87Content" aria-expanded="false" aria-controls="model_summary_all_87Content">87. model.shopify.shopify__discounts</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_88Content" aria-expanded="false" aria-controls="model_summary_all_88Content">88. model.shopify.shopify__daily_shop</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_89Content" aria-expanded="false" aria-controls="model_summary_all_89Content">89. model.shopify.shopify__customer_cohorts</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_90Content" aria-expanded="false" aria-controls="model_summary_all_90Content">90. model.shopify.shopify__customer_email_cohorts</a></li><li><a class="dropdown-item" data-bs-toggle="collapse" data-bs-target="#model_summary_all_91Content" aria-expanded="false" aria-controls="model_summary_all_91Content">91. model.shopify.shopify__products</a></li>
    </ul>
</div>

<div id="model_summary_all">
    
        <div class="collapse show" id="model_summary_all_0Content" data-bs-parent="#model_summary_all">
            
    <div style="max-height: 500px; overflow: auto; border: 1px solid #e0e0e0; border-radius: 12px; background-color: white; box-shadow: 0 2px 10px rgba(0,0,0,0.1); max-width: 100%;">
        <div style="min-width: min-content; display: inline-block; padding: 16px;">
            <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
-->
<!-- Title: %3 Pages: 1 -->
<svg width="2142pt" height="1100pt"
viewBox="0.00 0.00 2142.00 1100.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1096)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1096 2138,-1096 2138,4 -4,4"/>
<!-- 1. model.shopify.shopify__calendar_0 -->
<g id="node1" class="node">
<title>1. model.shopify.shopify__calendar_0</title>
<polygon fill="#ffffff" stroke="#000000" points="1825,-400 1682,-400 1682,-378 1825,-378 1825,-400"/>
<text text-anchor="middle" x="1753.5" y="-387.1" font-family="Segoe UI" font-size="8.00" fill="#000000">1. model.shopify.shopify__calendar</text>
</g>
<!-- 88. model.shopify.shopify__daily_shop_87 -->
<g id="node88" class="node">
<title>88. model.shopify.shopify__daily_shop_87</title>
<polygon fill="#ffffff" stroke="#000000" points="2106.5,-469 1950.5,-469 1950.5,-447 2106.5,-447 2106.5,-469"/>
<text text-anchor="middle" x="2028.5" y="-456.1" font-family="Segoe UI" font-size="8.00" fill="#000000">88. model.shopify.shopify__daily_shop</text>
</g>
<!-- 1. model.shopify.shopify__calendar_0&#45;&gt;88. model.shopify.shopify__daily_shop_87 -->
<g id="edge24" class="edge">
<title>1. model.shopify.shopify__calendar_0&#45;&gt;88. model.shopify.shopify__daily_shop_87</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1798.06,-400.01C1846.95,-412.37 1926.15,-432.38 1977.52,-445.37"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1977.31,-447.48 1983.64,-446.92 1978.34,-443.41 1977.31,-447.48"/>
</g>
<!-- 89. model.shopify.shopify__customer_cohorts_88 -->
<g id="node89" class="node">
<title>89. model.shopify.shopify__customer_cohorts_88</title>
<polygon fill="#ffffff" stroke="#000000" points="2121,-401 1936,-401 1936,-379 2121,-379 2121,-401"/>
<text text-anchor="middle" x="2028.5" y="-388.1" font-family="Segoe UI" font-size="8.00" fill="#000000">89. model.shopify.shopify__customer_cohorts</text>
</g>
<!-- 1. model.shopify.shopify__calendar_0&#45;&gt;89. model.shopify.shopify__customer_cohorts_88 -->
<g id="edge1" class="edge">
<title>1. model.shopify.shopify__calendar_0&#45;&gt;89. model.shopify.shopify__customer_cohorts_88</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1825.16,-389.26C1856.91,-389.38 1894.92,-389.51 1929.37,-389.64"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1929.75,-391.74 1935.76,-389.66 1929.77,-387.54 1929.75,-391.74"/>
</g>
<!-- 90. model.shopify.shopify__customer_email_cohorts_89 -->
<g id="node90" class="node">
<title>90. model.shopify.shopify__customer_email_cohorts_89</title>
<polygon fill="#ffffff" stroke="#000000" points="2134,-361 1923,-361 1923,-339 2134,-339 2134,-361"/>
<text text-anchor="middle" x="2028.5" y="-348.1" font-family="Segoe UI" font-size="8.00" fill="#000000">90. model.shopify.shopify__customer_email_cohorts</text>
</g>
<!-- 1. model.shopify.shopify__calendar_0&#45;&gt;90. model.shopify.shopify__customer_email_cohorts_89 -->
<g id="edge27" class="edge">
<title>1. model.shopify.shopify__calendar_0&#45;&gt;90. model.shopify.shopify__customer_email_cohorts_89</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1825.16,-378.91C1861.6,-373.7 1906.27,-367.32 1944.37,-361.88"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1944.78,-363.94 1950.42,-361.01 1944.18,-359.78 1944.78,-363.94"/>
</g>
<!-- 2. model.shopify_source.stg_shopify__abandoned_checkout_discount_code_tmp_1 -->
<g id="node2" class="node">
<title>2. model.shopify_source.stg_shopify__abandoned_checkout_discount_code_tmp_1</title>
<polygon fill="#ffffff" stroke="#000000" points="1235,-62 908,-62 908,-40 1235,-40 1235,-62"/>
<text text-anchor="middle" x="1071.5" y="-49.1" font-family="Segoe UI" font-size="8.00" fill="#000000">2. model.shopify_source.stg_shopify__abandoned_checkout_discount_code_tmp</text>
</g>
<!-- 36. model.shopify_source.stg_shopify__abandoned_checkout_discount_code_35 -->
<g id="node36" class="node">
<title>36. model.shopify_source.stg_shopify__abandoned_checkout_discount_code_35</title>
<polygon fill="#ffffff" stroke="#000000" points="1584,-62 1271,-62 1271,-40 1584,-40 1584,-62"/>
<text text-anchor="middle" x="1427.5" y="-49.1" font-family="Segoe UI" font-size="8.00" fill="#000000">36. model.shopify_source.stg_shopify__abandoned_checkout_discount_code</text>
</g>
<!-- 2. model.shopify_source.stg_shopify__abandoned_checkout_discount_code_tmp_1&#45;&gt;36. model.shopify_source.stg_shopify__abandoned_checkout_discount_code_35 -->
<g id="edge97" class="edge">
<title>2. model.shopify_source.stg_shopify__abandoned_checkout_discount_code_tmp_1&#45;&gt;36. model.shopify_source.stg_shopify__abandoned_checkout_discount_code_35</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1235.25,-51C1245.1,-51 1255.01,-51 1264.86,-51"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1264.98,-53.1 1270.98,-51 1264.98,-48.9 1264.98,-53.1"/>
</g>
<!-- 3. model.shopify_source.stg_shopify__abandoned_checkout_shipping_line_tmp_2 -->
<g id="node3" class="node">
<title>3. model.shopify_source.stg_shopify__abandoned_checkout_shipping_line_tmp_2</title>
<polygon fill="#ffffff" stroke="#000000" points="1232.5,-102 910.5,-102 910.5,-80 1232.5,-80 1232.5,-102"/>
<text text-anchor="middle" x="1071.5" y="-89.1" font-family="Segoe UI" font-size="8.00" fill="#000000">3. model.shopify_source.stg_shopify__abandoned_checkout_shipping_line_tmp</text>
</g>
<!-- 37. model.shopify_source.stg_shopify__abandoned_checkout_shipping_line_36 -->
<g id="node37" class="node">
<title>37. model.shopify_source.stg_shopify__abandoned_checkout_shipping_line_36</title>
<polygon fill="#ffffff" stroke="#000000" points="1581,-102 1274,-102 1274,-80 1581,-80 1581,-102"/>
<text text-anchor="middle" x="1427.5" y="-89.1" font-family="Segoe UI" font-size="8.00" fill="#000000">37. model.shopify_source.stg_shopify__abandoned_checkout_shipping_line</text>
</g>
<!-- 3. model.shopify_source.stg_shopify__abandoned_checkout_shipping_line_tmp_2&#45;&gt;37. model.shopify_source.stg_shopify__abandoned_checkout_shipping_line_36 -->
<g id="edge80" class="edge">
<title>3. model.shopify_source.stg_shopify__abandoned_checkout_shipping_line_tmp_2&#45;&gt;37. model.shopify_source.stg_shopify__abandoned_checkout_shipping_line_36</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1232.67,-91C1244.36,-91 1256.15,-91 1267.84,-91"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1267.94,-93.1 1273.94,-91 1267.94,-88.9 1267.94,-93.1"/>
</g>
<!-- 4. model.shopify_source.stg_shopify__abandoned_checkout_tmp_3 -->
<g id="node4" class="node">
<title>4. model.shopify_source.stg_shopify__abandoned_checkout_tmp_3</title>
<polygon fill="#ffffff" stroke="#000000" points="1203.5,-178 939.5,-178 939.5,-156 1203.5,-156 1203.5,-178"/>
<text text-anchor="middle" x="1071.5" y="-165.1" font-family="Segoe UI" font-size="8.00" fill="#000000">4. model.shopify_source.stg_shopify__abandoned_checkout_tmp</text>
</g>
<!-- 35. model.shopify_source.stg_shopify__abandoned_checkout_34 -->
<g id="node35" class="node">
<title>35. model.shopify_source.stg_shopify__abandoned_checkout_34</title>
<polygon fill="#ffffff" stroke="#000000" points="1552.5,-182 1302.5,-182 1302.5,-160 1552.5,-160 1552.5,-182"/>
<text text-anchor="middle" x="1427.5" y="-169.1" font-family="Segoe UI" font-size="8.00" fill="#000000">35. model.shopify_source.stg_shopify__abandoned_checkout</text>
</g>
<!-- 4. model.shopify_source.stg_shopify__abandoned_checkout_tmp_3&#45;&gt;35. model.shopify_source.stg_shopify__abandoned_checkout_34 -->
<g id="edge112" class="edge">
<title>4. model.shopify_source.stg_shopify__abandoned_checkout_tmp_3&#45;&gt;35. model.shopify_source.stg_shopify__abandoned_checkout_34</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1203.56,-168.48C1233.83,-168.82 1266.02,-169.19 1296.25,-169.53"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1296.25,-171.63 1302.27,-169.6 1296.3,-167.43 1296.25,-171.63"/>
</g>
<!-- 5. model.shopify_source.stg_shopify__collection_product_tmp_4 -->
<g id="node5" class="node">
<title>5. model.shopify_source.stg_shopify__collection_product_tmp_4</title>
<polygon fill="#ffffff" stroke="#000000" points="1196.5,-1012 946.5,-1012 946.5,-990 1196.5,-990 1196.5,-1012"/>
<text text-anchor="middle" x="1071.5" y="-999.1" font-family="Segoe UI" font-size="8.00" fill="#000000">5. model.shopify_source.stg_shopify__collection_product_tmp</text>
</g>
<!-- 39. model.shopify_source.stg_shopify__collection_product_38 -->
<g id="node39" class="node">
<title>39. model.shopify_source.stg_shopify__collection_product_38</title>
<polygon fill="#ffffff" stroke="#000000" points="1545.5,-1012 1309.5,-1012 1309.5,-990 1545.5,-990 1545.5,-1012"/>
<text text-anchor="middle" x="1427.5" y="-999.1" font-family="Segoe UI" font-size="8.00" fill="#000000">39. model.shopify_source.stg_shopify__collection_product</text>
</g>
<!-- 5. model.shopify_source.stg_shopify__collection_product_tmp_4&#45;&gt;39. model.shopify_source.stg_shopify__collection_product_38 -->
<g id="edge84" class="edge">
<title>5. model.shopify_source.stg_shopify__collection_product_tmp_4&#45;&gt;39. model.shopify_source.stg_shopify__collection_product_38</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1196.81,-1001C1231.22,-1001 1268.56,-1001 1302.94,-1001"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1303.32,-1003.1 1309.32,-1001 1303.32,-998.9 1303.32,-1003.1"/>
</g>
<!-- 6. model.shopify_source.stg_shopify__collection_tmp_5 -->
<g id="node6" class="node">
<title>6. model.shopify_source.stg_shopify__collection_tmp_5</title>
<polygon fill="#ffffff" stroke="#000000" points="1179,-1052 964,-1052 964,-1030 1179,-1030 1179,-1052"/>
<text text-anchor="middle" x="1071.5" y="-1039.1" font-family="Segoe UI" font-size="8.00" fill="#000000">6. model.shopify_source.stg_shopify__collection_tmp</text>
</g>
<!-- 38. model.shopify_source.stg_shopify__collection_37 -->
<g id="node38" class="node">
<title>38. model.shopify_source.stg_shopify__collection_37</title>
<polygon fill="#ffffff" stroke="#000000" points="1528,-1052 1327,-1052 1327,-1030 1528,-1030 1528,-1052"/>
<text text-anchor="middle" x="1427.5" y="-1039.1" font-family="Segoe UI" font-size="8.00" fill="#000000">38. model.shopify_source.stg_shopify__collection</text>
</g>
<!-- 6. model.shopify_source.stg_shopify__collection_tmp_5&#45;&gt;38. model.shopify_source.stg_shopify__collection_37 -->
<g id="edge104" class="edge">
<title>6. model.shopify_source.stg_shopify__collection_tmp_5&#45;&gt;38. model.shopify_source.stg_shopify__collection_37</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1179.19,-1041C1224.01,-1041 1276.01,-1041 1320.73,-1041"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1320.99,-1043.1 1326.99,-1041 1320.99,-1038.9 1320.99,-1043.1"/>
</g>
<!-- 7. model.shopify_source.stg_shopify__customer_tag_tmp_6 -->
<g id="node7" class="node">
<title>7. model.shopify_source.stg_shopify__customer_tag_tmp_6</title>
<polygon fill="#ffffff" stroke="#000000" points="855,-178 624,-178 624,-156 855,-156 855,-178"/>
<text text-anchor="middle" x="739.5" y="-165.1" font-family="Segoe UI" font-size="8.00" fill="#000000">7. model.shopify_source.stg_shopify__customer_tag_tmp</text>
</g>
<!-- 41. model.shopify_source.stg_shopify__customer_tag_40 -->
<g id="node41" class="node">
<title>41. model.shopify_source.stg_shopify__customer_tag_40</title>
<polygon fill="#ffffff" stroke="#000000" points="1180,-218 963,-218 963,-196 1180,-196 1180,-218"/>
<text text-anchor="middle" x="1071.5" y="-205.1" font-family="Segoe UI" font-size="8.00" fill="#000000">41. model.shopify_source.stg_shopify__customer_tag</text>
</g>
<!-- 7. model.shopify_source.stg_shopify__customer_tag_tmp_6&#45;&gt;41. model.shopify_source.stg_shopify__customer_tag_40 -->
<g id="edge91" class="edge">
<title>7. model.shopify_source.stg_shopify__customer_tag_tmp_6&#45;&gt;41. model.shopify_source.stg_shopify__customer_tag_40</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M831.55,-178.04C875.73,-183.39 928.84,-189.83 973.75,-195.27"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="973.54,-197.36 979.75,-196 974.05,-193.19 973.54,-197.36"/>
</g>
<!-- 8. model.shopify_source.stg_shopify__customer_tmp_7 -->
<g id="node8" class="node">
<title>8. model.shopify_source.stg_shopify__customer_tmp_7</title>
<polygon fill="#ffffff" stroke="#000000" points="846.5,-218 632.5,-218 632.5,-196 846.5,-196 846.5,-218"/>
<text text-anchor="middle" x="739.5" y="-205.1" font-family="Segoe UI" font-size="8.00" fill="#000000">8. model.shopify_source.stg_shopify__customer_tmp</text>
</g>
<!-- 40. model.shopify_source.stg_shopify__customer_39 -->
<g id="node40" class="node">
<title>40. model.shopify_source.stg_shopify__customer_39</title>
<polygon fill="#ffffff" stroke="#000000" points="1171,-258 972,-258 972,-236 1171,-236 1171,-258"/>
<text text-anchor="middle" x="1071.5" y="-245.1" font-family="Segoe UI" font-size="8.00" fill="#000000">40. model.shopify_source.stg_shopify__customer</text>
</g>
<!-- 8. model.shopify_source.stg_shopify__customer_tmp_7&#45;&gt;40. model.shopify_source.stg_shopify__customer_39 -->
<g id="edge87" class="edge">
<title>8. model.shopify_source.stg_shopify__customer_tmp_7&#45;&gt;40. model.shopify_source.stg_shopify__customer_39</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M831.55,-218.04C875.73,-223.39 928.84,-229.83 973.75,-235.27"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="973.54,-237.36 979.75,-236 974.05,-233.19 973.54,-237.36"/>
</g>
<!-- 9. model.shopify_source.stg_shopify__discount_code_tmp_8 -->
<g id="node9" class="node">
<title>9. model.shopify_source.stg_shopify__discount_code_tmp_8</title>
<polygon fill="#ffffff" stroke="#000000" points="1545,-22 1310,-22 1310,0 1545,0 1545,-22"/>
<text text-anchor="middle" x="1427.5" y="-9.1" font-family="Segoe UI" font-size="8.00" fill="#000000">9. model.shopify_source.stg_shopify__discount_code_tmp</text>
</g>
<!-- 42. model.shopify_source.stg_shopify__discount_code_41 -->
<g id="node42" class="node">
<title>42. model.shopify_source.stg_shopify__discount_code_41</title>
<polygon fill="#ffffff" stroke="#000000" points="1863.5,-42 1643.5,-42 1643.5,-20 1863.5,-20 1863.5,-42"/>
<text text-anchor="middle" x="1753.5" y="-29.1" font-family="Segoe UI" font-size="8.00" fill="#000000">42. model.shopify_source.stg_shopify__discount_code</text>
</g>
<!-- 9. model.shopify_source.stg_shopify__discount_code_tmp_8&#45;&gt;42. model.shopify_source.stg_shopify__discount_code_41 -->
<g id="edge85" class="edge">
<title>9. model.shopify_source.stg_shopify__discount_code_tmp_8&#45;&gt;42. model.shopify_source.stg_shopify__discount_code_41</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1545.01,-18.19C1574.91,-20.04 1607.05,-22.02 1636.9,-23.86"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1637.11,-25.98 1643.23,-24.26 1637.37,-21.79 1637.11,-25.98"/>
</g>
<!-- 10. model.shopify_source.stg_shopify__fulfillment_tmp_9 -->
<g id="node10" class="node">
<title>10. model.shopify_source.stg_shopify__fulfillment_tmp_9</title>
<polygon fill="#ffffff" stroke="#000000" points="850.5,-738 628.5,-738 628.5,-716 850.5,-716 850.5,-738"/>
<text text-anchor="middle" x="739.5" y="-725.1" font-family="Segoe UI" font-size="8.00" fill="#000000">10. model.shopify_source.stg_shopify__fulfillment_tmp</text>
</g>
<!-- 43. model.shopify_source.stg_shopify__fulfillment_42 -->
<g id="node43" class="node">
<title>43. model.shopify_source.stg_shopify__fulfillment_42</title>
<polygon fill="#ffffff" stroke="#000000" points="1172.5,-732 970.5,-732 970.5,-710 1172.5,-710 1172.5,-732"/>
<text text-anchor="middle" x="1071.5" y="-719.1" font-family="Segoe UI" font-size="8.00" fill="#000000">43. model.shopify_source.stg_shopify__fulfillment</text>
</g>
<!-- 10. model.shopify_source.stg_shopify__fulfillment_tmp_9&#45;&gt;43. model.shopify_source.stg_shopify__fulfillment_42 -->
<g id="edge82" class="edge">
<title>10. model.shopify_source.stg_shopify__fulfillment_tmp_9&#45;&gt;43. model.shopify_source.stg_shopify__fulfillment_42</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M850.84,-724.99C887.33,-724.33 927.84,-723.59 964.03,-722.94"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="964.31,-725.03 970.27,-722.82 964.23,-720.83 964.31,-725.03"/>
</g>
<!-- 11. model.shopify_source.stg_shopify__inventory_item_tmp_10 -->
<g id="node11" class="node">
<title>11. model.shopify_source.stg_shopify__inventory_item_tmp_10</title>
<polygon fill="#ffffff" stroke="#000000" points="1192,-852 951,-852 951,-830 1192,-830 1192,-852"/>
<text text-anchor="middle" x="1071.5" y="-839.1" font-family="Segoe UI" font-size="8.00" fill="#000000">11. model.shopify_source.stg_shopify__inventory_item_tmp</text>
</g>
<!-- 44. model.shopify_source.stg_shopify__inventory_item_43 -->
<g id="node44" class="node">
<title>44. model.shopify_source.stg_shopify__inventory_item_43</title>
<polygon fill="#ffffff" stroke="#000000" points="1538,-852 1317,-852 1317,-830 1538,-830 1538,-852"/>
<text text-anchor="middle" x="1427.5" y="-839.1" font-family="Segoe UI" font-size="8.00" fill="#000000">44. model.shopify_source.stg_shopify__inventory_item</text>
</g>
<!-- 11. model.shopify_source.stg_shopify__inventory_item_tmp_10&#45;&gt;44. model.shopify_source.stg_shopify__inventory_item_43 -->
<g id="edge99" class="edge">
<title>11. model.shopify_source.stg_shopify__inventory_item_tmp_10&#45;&gt;44. model.shopify_source.stg_shopify__inventory_item_43</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1192.35,-841C1230.62,-841 1272.88,-841 1310.85,-841"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1310.9,-843.1 1316.9,-841 1310.9,-838.9 1310.9,-843.1"/>
</g>
<!-- 12. model.shopify_source.stg_shopify__inventory_level_tmp_11 -->
<g id="node12" class="node">
<title>12. model.shopify_source.stg_shopify__inventory_level_tmp_11</title>
<polygon fill="#ffffff" stroke="#000000" points="1192.5,-812 950.5,-812 950.5,-790 1192.5,-790 1192.5,-812"/>
<text text-anchor="middle" x="1071.5" y="-799.1" font-family="Segoe UI" font-size="8.00" fill="#000000">12. model.shopify_source.stg_shopify__inventory_level_tmp</text>
</g>
<!-- 45. model.shopify_source.stg_shopify__inventory_level_44 -->
<g id="node45" class="node">
<title>45. model.shopify_source.stg_shopify__inventory_level_44</title>
<polygon fill="#ffffff" stroke="#000000" points="1539,-812 1316,-812 1316,-790 1539,-790 1539,-812"/>
<text text-anchor="middle" x="1427.5" y="-799.1" font-family="Segoe UI" font-size="8.00" fill="#000000">45. model.shopify_source.stg_shopify__inventory_level</text>
</g>
<!-- 12. model.shopify_source.stg_shopify__inventory_level_tmp_11&#45;&gt;45. model.shopify_source.stg_shopify__inventory_level_44 -->
<g id="edge86" class="edge">
<title>12. model.shopify_source.stg_shopify__inventory_level_tmp_11&#45;&gt;45. model.shopify_source.stg_shopify__inventory_level_44</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1192.84,-801C1230.45,-801 1271.88,-801 1309.27,-801"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1309.72,-803.1 1315.72,-801 1309.72,-798.9 1309.72,-803.1"/>
</g>
<!-- 13. model.shopify_source.stg_shopify__location_tmp_12 -->
<g id="node13" class="node">
<title>13. model.shopify_source.stg_shopify__location_tmp_12</title>
<polygon fill="#ffffff" stroke="#000000" points="1178.5,-892 964.5,-892 964.5,-870 1178.5,-870 1178.5,-892"/>
<text text-anchor="middle" x="1071.5" y="-879.1" font-family="Segoe UI" font-size="8.00" fill="#000000">13. model.shopify_source.stg_shopify__location_tmp</text>
</g>
<!-- 46. model.shopify_source.stg_shopify__location_45 -->
<g id="node46" class="node">
<title>46. model.shopify_source.stg_shopify__location_45</title>
<polygon fill="#ffffff" stroke="#000000" points="1524.5,-892 1330.5,-892 1330.5,-870 1524.5,-870 1524.5,-892"/>
<text text-anchor="middle" x="1427.5" y="-879.1" font-family="Segoe UI" font-size="8.00" fill="#000000">46. model.shopify_source.stg_shopify__location</text>
</g>
<!-- 13. model.shopify_source.stg_shopify__location_tmp_12&#45;&gt;46. model.shopify_source.stg_shopify__location_45 -->
<g id="edge103" class="edge">
<title>13. model.shopify_source.stg_shopify__location_tmp_12&#45;&gt;46. model.shopify_source.stg_shopify__location_45</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1178.71,-881C1224.81,-881 1278.57,-881 1324.22,-881"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1324.31,-883.1 1330.31,-881 1324.31,-878.9 1324.31,-883.1"/>
</g>
<!-- 14. model.shopify_source.stg_shopify__metafield_tmp_13 -->
<g id="node14" class="node">
<title>14. model.shopify_source.stg_shopify__metafield_tmp_13</title>
<polygon fill="#ffffff" stroke="#000000" points="248.5,-738 28.5,-738 28.5,-716 248.5,-716 248.5,-738"/>
<text text-anchor="middle" x="138.5" y="-725.1" font-family="Segoe UI" font-size="8.00" fill="#000000">14. model.shopify_source.stg_shopify__metafield_tmp</text>
</g>
<!-- 47. model.shopify_source.stg_shopify__metafield_46 -->
<g id="node47" class="node">
<title>47. model.shopify_source.stg_shopify__metafield_46</title>
<polygon fill="#ffffff" stroke="#000000" points="542,-738 342,-738 342,-716 542,-716 542,-738"/>
<text text-anchor="middle" x="442" y="-725.1" font-family="Segoe UI" font-size="8.00" fill="#000000">47. model.shopify_source.stg_shopify__metafield</text>
</g>
<!-- 14. model.shopify_source.stg_shopify__metafield_tmp_13&#45;&gt;47. model.shopify_source.stg_shopify__metafield_46 -->
<g id="edge94" class="edge">
<title>14. model.shopify_source.stg_shopify__metafield_tmp_13&#45;&gt;47. model.shopify_source.stg_shopify__metafield_46</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M248.77,-727C276.98,-727 307.28,-727 335.29,-727"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="335.61,-729.1 341.61,-727 335.61,-724.9 335.61,-729.1"/>
</g>
<!-- 15. model.shopify_source.stg_shopify__order_adjustment_tmp_14 -->
<g id="node15" class="node">
<title>15. model.shopify_source.stg_shopify__order_adjustment_tmp_14</title>
<polygon fill="#ffffff" stroke="#000000" points="866,-578 613,-578 613,-556 866,-556 866,-578"/>
<text text-anchor="middle" x="739.5" y="-565.1" font-family="Segoe UI" font-size="8.00" fill="#000000">15. model.shopify_source.stg_shopify__order_adjustment_tmp</text>
</g>
<!-- 49. model.shopify_source.stg_shopify__order_adjustment_48 -->
<g id="node49" class="node">
<title>49. model.shopify_source.stg_shopify__order_adjustment_48</title>
<polygon fill="#ffffff" stroke="#000000" points="1188,-576 955,-576 955,-554 1188,-554 1188,-576"/>
<text text-anchor="middle" x="1071.5" y="-563.1" font-family="Segoe UI" font-size="8.00" fill="#000000">49. model.shopify_source.stg_shopify__order_adjustment</text>
</g>
<!-- 15. model.shopify_source.stg_shopify__order_adjustment_tmp_14&#45;&gt;49. model.shopify_source.stg_shopify__order_adjustment_48 -->
<g id="edge89" class="edge">
<title>15. model.shopify_source.stg_shopify__order_adjustment_tmp_14&#45;&gt;49. model.shopify_source.stg_shopify__order_adjustment_48</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M866.2,-566.24C893.29,-566.07 921.89,-565.9 948.83,-565.74"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="948.92,-567.84 954.91,-565.7 948.9,-563.64 948.92,-567.84"/>
</g>
<!-- 16. model.shopify_source.stg_shopify__order_discount_code_tmp_15 -->
<g id="node16" class="node">
<title>16. model.shopify_source.stg_shopify__order_discount_code_tmp_15</title>
<polygon fill="#ffffff" stroke="#000000" points="872,-258 607,-258 607,-236 872,-236 872,-258"/>
<text text-anchor="middle" x="739.5" y="-245.1" font-family="Segoe UI" font-size="8.00" fill="#000000">16. model.shopify_source.stg_shopify__order_discount_code_tmp</text>
</g>
<!-- 50. model.shopify_source.stg_shopify__order_discount_code_49 -->
<g id="node50" class="node">
<title>50. model.shopify_source.stg_shopify__order_discount_code_49</title>
<polygon fill="#ffffff" stroke="#000000" points="1194.5,-298 948.5,-298 948.5,-276 1194.5,-276 1194.5,-298"/>
<text text-anchor="middle" x="1071.5" y="-285.1" font-family="Segoe UI" font-size="8.00" fill="#000000">50. model.shopify_source.stg_shopify__order_discount_code</text>
</g>
<!-- 16. model.shopify_source.stg_shopify__order_discount_code_tmp_15&#45;&gt;50. model.shopify_source.stg_shopify__order_discount_code_49 -->
<g id="edge100" class="edge">
<title>16. model.shopify_source.stg_shopify__order_discount_code_tmp_15&#45;&gt;50. model.shopify_source.stg_shopify__order_discount_code_49</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M831.55,-258.04C875.73,-263.39 928.84,-269.83 973.75,-275.27"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="973.54,-277.36 979.75,-276 974.05,-273.19 973.54,-277.36"/>
</g>
<!-- 17. model.shopify_source.stg_shopify__order_line_refund_tmp_16 -->
<g id="node17" class="node">
<title>17. model.shopify_source.stg_shopify__order_line_refund_tmp_16</title>
<polygon fill="#ffffff" stroke="#000000" points="568,-698 316,-698 316,-676 568,-676 568,-698"/>
<text text-anchor="middle" x="442" y="-685.1" font-family="Segoe UI" font-size="8.00" fill="#000000">17. model.shopify_source.stg_shopify__order_line_refund_tmp</text>
</g>
<!-- 52. model.shopify_source.stg_shopify__order_line_refund_51 -->
<g id="node52" class="node">
<title>52. model.shopify_source.stg_shopify__order_line_refund_51</title>
<polygon fill="#ffffff" stroke="#000000" points="855.5,-698 623.5,-698 623.5,-676 855.5,-676 855.5,-698"/>
<text text-anchor="middle" x="739.5" y="-685.1" font-family="Segoe UI" font-size="8.00" fill="#000000">52. model.shopify_source.stg_shopify__order_line_refund</text>
</g>
<!-- 17. model.shopify_source.stg_shopify__order_line_refund_tmp_16&#45;&gt;52. model.shopify_source.stg_shopify__order_line_refund_51 -->
<g id="edge106" class="edge">
<title>17. model.shopify_source.stg_shopify__order_line_refund_tmp_16&#45;&gt;52. model.shopify_source.stg_shopify__order_line_refund_51</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M568.32,-687C584.43,-687 600.9,-687 616.95,-687"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="617.31,-689.1 623.31,-687 617.31,-684.9 617.31,-689.1"/>
</g>
<!-- 18. model.shopify_source.stg_shopify__order_line_tmp_17 -->
<g id="node18" class="node">
<title>18. model.shopify_source.stg_shopify__order_line_tmp_17</title>
<polygon fill="#ffffff" stroke="#000000" points="552.5,-618 331.5,-618 331.5,-596 552.5,-596 552.5,-618"/>
<text text-anchor="middle" x="442" y="-605.1" font-family="Segoe UI" font-size="8.00" fill="#000000">18. model.shopify_source.stg_shopify__order_line_tmp</text>
</g>
<!-- 51. model.shopify_source.stg_shopify__order_line_50 -->
<g id="node51" class="node">
<title>51. model.shopify_source.stg_shopify__order_line_50</title>
<polygon fill="#ffffff" stroke="#000000" points="840.5,-618 638.5,-618 638.5,-596 840.5,-596 840.5,-618"/>
<text text-anchor="middle" x="739.5" y="-605.1" font-family="Segoe UI" font-size="8.00" fill="#000000">51. model.shopify_source.stg_shopify__order_line</text>
</g>
<!-- 18. model.shopify_source.stg_shopify__order_line_tmp_17&#45;&gt;51. model.shopify_source.stg_shopify__order_line_50 -->
<g id="edge105" class="edge">
<title>18. model.shopify_source.stg_shopify__order_line_tmp_17&#45;&gt;51. model.shopify_source.stg_shopify__order_line_50</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M552.61,-607C578.62,-607 606.31,-607 632.16,-607"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="632.34,-609.1 638.34,-607 632.34,-604.9 632.34,-609.1"/>
</g>
<!-- 19. model.shopify_source.stg_shopify__order_note_attribute_tmp_18 -->
<g id="node19" class="node">
<title>19. model.shopify_source.stg_shopify__order_note_attribute_tmp_18</title>
<polygon fill="#ffffff" stroke="#000000" points="270.5,-778 6.5,-778 6.5,-756 270.5,-756 270.5,-778"/>
<text text-anchor="middle" x="138.5" y="-765.1" font-family="Segoe UI" font-size="8.00" fill="#000000">19. model.shopify_source.stg_shopify__order_note_attribute_tmp</text>
</g>
<!-- 53. model.shopify_source.stg_shopify__order_note_attribute_52 -->
<g id="node53" class="node">
<title>53. model.shopify_source.stg_shopify__order_note_attribute_52</title>
<polygon fill="#ffffff" stroke="#000000" points="564,-778 320,-778 320,-756 564,-756 564,-778"/>
<text text-anchor="middle" x="442" y="-765.1" font-family="Segoe UI" font-size="8.00" fill="#000000">53. model.shopify_source.stg_shopify__order_note_attribute</text>
</g>
<!-- 19. model.shopify_source.stg_shopify__order_note_attribute_tmp_18&#45;&gt;53. model.shopify_source.stg_shopify__order_note_attribute_52 -->
<g id="edge92" class="edge">
<title>19. model.shopify_source.stg_shopify__order_note_attribute_tmp_18&#45;&gt;53. model.shopify_source.stg_shopify__order_note_attribute_52</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M270.87,-767C285.03,-767 299.42,-767 313.54,-767"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="313.57,-769.1 319.57,-767 313.57,-764.9 313.57,-769.1"/>
</g>
<!-- 20. model.shopify_source.stg_shopify__order_shipping_line_tmp_19 -->
<g id="node20" class="node">
<title>20. model.shopify_source.stg_shopify__order_shipping_line_tmp_19</title>
<polygon fill="#ffffff" stroke="#000000" points="268.5,-458 8.5,-458 8.5,-436 268.5,-436 268.5,-458"/>
<text text-anchor="middle" x="138.5" y="-445.1" font-family="Segoe UI" font-size="8.00" fill="#000000">20. model.shopify_source.stg_shopify__order_shipping_line_tmp</text>
</g>
<!-- 54. model.shopify_source.stg_shopify__order_shipping_line_53 -->
<g id="node54" class="node">
<title>54. model.shopify_source.stg_shopify__order_shipping_line_53</title>
<polygon fill="#ffffff" stroke="#000000" points="562.5,-458 321.5,-458 321.5,-436 562.5,-436 562.5,-458"/>
<text text-anchor="middle" x="442" y="-445.1" font-family="Segoe UI" font-size="8.00" fill="#000000">54. model.shopify_source.stg_shopify__order_shipping_line</text>
</g>
<!-- 20. model.shopify_source.stg_shopify__order_shipping_line_tmp_19&#45;&gt;54. model.shopify_source.stg_shopify__order_shipping_line_53 -->
<g id="edge111" class="edge">
<title>20. model.shopify_source.stg_shopify__order_shipping_line_tmp_19&#45;&gt;54. model.shopify_source.stg_shopify__order_shipping_line_53</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M268.68,-447C284.05,-447 299.74,-447 315.07,-447"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="315.16,-449.1 321.16,-447 315.16,-444.9 315.16,-449.1"/>
</g>
<!-- 21. model.shopify_source.stg_shopify__order_shipping_tax_line_tmp_20 -->
<g id="node21" class="node">
<title>21. model.shopify_source.stg_shopify__order_shipping_tax_line_tmp_20</title>
<polygon fill="#ffffff" stroke="#000000" points="277,-418 0,-418 0,-396 277,-396 277,-418"/>
<text text-anchor="middle" x="138.5" y="-405.1" font-family="Segoe UI" font-size="8.00" fill="#000000">21. model.shopify_source.stg_shopify__order_shipping_tax_line_tmp</text>
</g>
<!-- 55. model.shopify_source.stg_shopify__order_shipping_tax_line_54 -->
<g id="node55" class="node">
<title>55. model.shopify_source.stg_shopify__order_shipping_tax_line_54</title>
<polygon fill="#ffffff" stroke="#000000" points="570.5,-418 313.5,-418 313.5,-396 570.5,-396 570.5,-418"/>
<text text-anchor="middle" x="442" y="-405.1" font-family="Segoe UI" font-size="8.00" fill="#000000">55. model.shopify_source.stg_shopify__order_shipping_tax_line</text>
</g>
<!-- 21. model.shopify_source.stg_shopify__order_shipping_tax_line_tmp_20&#45;&gt;55. model.shopify_source.stg_shopify__order_shipping_tax_line_54 -->
<g id="edge107" class="edge">
<title>21. model.shopify_source.stg_shopify__order_shipping_tax_line_tmp_20&#45;&gt;55. model.shopify_source.stg_shopify__order_shipping_tax_line_54</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M277.02,-407C287.05,-407 297.16,-407 307.17,-407"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="307.39,-409.1 313.39,-407 307.39,-404.9 307.39,-409.1"/>
</g>
<!-- 22. model.shopify_source.stg_shopify__order_tag_tmp_21 -->
<g id="node22" class="node">
<title>22. model.shopify_source.stg_shopify__order_tag_tmp_21</title>
<polygon fill="#ffffff" stroke="#000000" points="849.5,-538 629.5,-538 629.5,-516 849.5,-516 849.5,-538"/>
<text text-anchor="middle" x="739.5" y="-525.1" font-family="Segoe UI" font-size="8.00" fill="#000000">22. model.shopify_source.stg_shopify__order_tag_tmp</text>
</g>
<!-- 56. model.shopify_source.stg_shopify__order_tag_55 -->
<g id="node56" class="node">
<title>56. model.shopify_source.stg_shopify__order_tag_55</title>
<polygon fill="#ffffff" stroke="#000000" points="1171.5,-536 971.5,-536 971.5,-514 1171.5,-514 1171.5,-536"/>
<text text-anchor="middle" x="1071.5" y="-523.1" font-family="Segoe UI" font-size="8.00" fill="#000000">56. model.shopify_source.stg_shopify__order_tag</text>
</g>
<!-- 22. model.shopify_source.stg_shopify__order_tag_tmp_21&#45;&gt;56. model.shopify_source.stg_shopify__order_tag_55 -->
<g id="edge90" class="edge">
<title>22. model.shopify_source.stg_shopify__order_tag_tmp_21&#45;&gt;56. model.shopify_source.stg_shopify__order_tag_55</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M849.93,-526.34C886.99,-526.11 928.3,-525.86 965.05,-525.64"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="965.39,-527.74 971.38,-525.6 965.37,-523.54 965.39,-527.74"/>
</g>
<!-- 23. model.shopify_source.stg_shopify__order_tmp_22 -->
<g id="node23" class="node">
<title>23. model.shopify_source.stg_shopify__order_tmp_22</title>
<polygon fill="#ffffff" stroke="#000000" points="840.5,-378 638.5,-378 638.5,-356 840.5,-356 840.5,-378"/>
<text text-anchor="middle" x="739.5" y="-365.1" font-family="Segoe UI" font-size="8.00" fill="#000000">23. model.shopify_source.stg_shopify__order_tmp</text>
</g>
<!-- 48. model.shopify_source.stg_shopify__order_47 -->
<g id="node48" class="node">
<title>48. model.shopify_source.stg_shopify__order_47</title>
<polygon fill="#ffffff" stroke="#000000" points="1163,-378 980,-378 980,-356 1163,-356 1163,-378"/>
<text text-anchor="middle" x="1071.5" y="-365.1" font-family="Segoe UI" font-size="8.00" fill="#000000">48. model.shopify_source.stg_shopify__order</text>
</g>
<!-- 23. model.shopify_source.stg_shopify__order_tmp_22&#45;&gt;48. model.shopify_source.stg_shopify__order_47 -->
<g id="edge88" class="edge">
<title>23. model.shopify_source.stg_shopify__order_tmp_22&#45;&gt;48. model.shopify_source.stg_shopify__order_47</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M840.85,-367C883.06,-367 931.96,-367 973.77,-367"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="973.88,-369.1 979.88,-367 973.88,-364.9 973.88,-369.1"/>
</g>
<!-- 24. model.shopify_source.stg_shopify__order_url_tag_tmp_23 -->
<g id="node24" class="node">
<title>24. model.shopify_source.stg_shopify__order_url_tag_tmp_23</title>
<polygon fill="#ffffff" stroke="#000000" points="856.5,-418 622.5,-418 622.5,-396 856.5,-396 856.5,-418"/>
<text text-anchor="middle" x="739.5" y="-405.1" font-family="Segoe UI" font-size="8.00" fill="#000000">24. model.shopify_source.stg_shopify__order_url_tag_tmp</text>
</g>
<!-- 57. model.shopify_source.stg_shopify__order_url_tag_56 -->
<g id="node57" class="node">
<title>57. model.shopify_source.stg_shopify__order_url_tag_56</title>
<polygon fill="#ffffff" stroke="#000000" points="1178.5,-418 964.5,-418 964.5,-396 1178.5,-396 1178.5,-418"/>
<text text-anchor="middle" x="1071.5" y="-405.1" font-family="Segoe UI" font-size="8.00" fill="#000000">57. model.shopify_source.stg_shopify__order_url_tag</text>
</g>
<!-- 24. model.shopify_source.stg_shopify__order_url_tag_tmp_23&#45;&gt;57. model.shopify_source.stg_shopify__order_url_tag_56 -->
<g id="edge101" class="edge">
<title>24. model.shopify_source.stg_shopify__order_url_tag_tmp_23&#45;&gt;57. model.shopify_source.stg_shopify__order_url_tag_56</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M856.85,-407C889.78,-407 925.54,-407 958.23,-407"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="958.29,-409.1 964.29,-407 958.29,-404.9 958.29,-409.1"/>
</g>
<!-- 25. model.shopify_source.stg_shopify__price_rule_tmp_24 -->
<g id="node25" class="node">
<title>25. model.shopify_source.stg_shopify__price_rule_tmp_24</title>
<polygon fill="#ffffff" stroke="#000000" points="1537.5,-142 1317.5,-142 1317.5,-120 1537.5,-120 1537.5,-142"/>
<text text-anchor="middle" x="1427.5" y="-129.1" font-family="Segoe UI" font-size="8.00" fill="#000000">25. model.shopify_source.stg_shopify__price_rule_tmp</text>
</g>
<!-- 58. model.shopify_source.stg_shopify__price_rule_57 -->
<g id="node58" class="node">
<title>58. model.shopify_source.stg_shopify__price_rule_57</title>
<polygon fill="#ffffff" stroke="#000000" points="1854,-142 1653,-142 1653,-120 1854,-120 1854,-142"/>
<text text-anchor="middle" x="1753.5" y="-129.1" font-family="Segoe UI" font-size="8.00" fill="#000000">58. model.shopify_source.stg_shopify__price_rule</text>
</g>
<!-- 25. model.shopify_source.stg_shopify__price_rule_tmp_24&#45;&gt;58. model.shopify_source.stg_shopify__price_rule_57 -->
<g id="edge96" class="edge">
<title>25. model.shopify_source.stg_shopify__price_rule_tmp_24&#45;&gt;58. model.shopify_source.stg_shopify__price_rule_57</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1537.74,-131C1572.91,-131 1611.8,-131 1646.71,-131"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1646.73,-133.1 1652.73,-131 1646.73,-128.9 1646.73,-133.1"/>
</g>
<!-- 26. model.shopify_source.stg_shopify__product_image_tmp_25 -->
<g id="node26" class="node">
<title>26. model.shopify_source.stg_shopify__product_image_tmp_25</title>
<polygon fill="#ffffff" stroke="#000000" points="1192,-972 951,-972 951,-950 1192,-950 1192,-972"/>
<text text-anchor="middle" x="1071.5" y="-959.1" font-family="Segoe UI" font-size="8.00" fill="#000000">26. model.shopify_source.stg_shopify__product_image_tmp</text>
</g>
<!-- 60. model.shopify_source.stg_shopify__product_image_59 -->
<g id="node60" class="node">
<title>60. model.shopify_source.stg_shopify__product_image_59</title>
<polygon fill="#ffffff" stroke="#000000" points="1538.5,-972 1316.5,-972 1316.5,-950 1538.5,-950 1538.5,-972"/>
<text text-anchor="middle" x="1427.5" y="-959.1" font-family="Segoe UI" font-size="8.00" fill="#000000">60. model.shopify_source.stg_shopify__product_image</text>
</g>
<!-- 26. model.shopify_source.stg_shopify__product_image_tmp_25&#45;&gt;60. model.shopify_source.stg_shopify__product_image_59 -->
<g id="edge83" class="edge">
<title>26. model.shopify_source.stg_shopify__product_image_tmp_25&#45;&gt;60. model.shopify_source.stg_shopify__product_image_59</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1192.35,-961C1230.43,-961 1272.46,-961 1310.28,-961"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1310.31,-963.1 1316.31,-961 1310.31,-958.9 1310.31,-963.1"/>
</g>
<!-- 27. model.shopify_source.stg_shopify__product_tag_tmp_26 -->
<g id="node27" class="node">
<title>27. model.shopify_source.stg_shopify__product_tag_tmp_26</title>
<polygon fill="#ffffff" stroke="#000000" points="1186,-1092 957,-1092 957,-1070 1186,-1070 1186,-1092"/>
<text text-anchor="middle" x="1071.5" y="-1079.1" font-family="Segoe UI" font-size="8.00" fill="#000000">27. model.shopify_source.stg_shopify__product_tag_tmp</text>
</g>
<!-- 61. model.shopify_source.stg_shopify__product_tag_60 -->
<g id="node61" class="node">
<title>61. model.shopify_source.stg_shopify__product_tag_60</title>
<polygon fill="#ffffff" stroke="#000000" points="1532.5,-1092 1322.5,-1092 1322.5,-1070 1532.5,-1070 1532.5,-1092"/>
<text text-anchor="middle" x="1427.5" y="-1079.1" font-family="Segoe UI" font-size="8.00" fill="#000000">61. model.shopify_source.stg_shopify__product_tag</text>
</g>
<!-- 27. model.shopify_source.stg_shopify__product_tag_tmp_26&#45;&gt;61. model.shopify_source.stg_shopify__product_tag_60 -->
<g id="edge98" class="edge">
<title>27. model.shopify_source.stg_shopify__product_tag_tmp_26&#45;&gt;61. model.shopify_source.stg_shopify__product_tag_60</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1186.46,-1081C1228.07,-1081 1275.03,-1081 1316.3,-1081"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1316.35,-1083.1 1322.35,-1081 1316.35,-1078.9 1316.35,-1083.1"/>
</g>
<!-- 28. model.shopify_source.stg_shopify__product_tmp_27 -->
<g id="node28" class="node">
<title>28. model.shopify_source.stg_shopify__product_tmp_27</title>
<polygon fill="#ffffff" stroke="#000000" points="1177.5,-932 965.5,-932 965.5,-910 1177.5,-910 1177.5,-932"/>
<text text-anchor="middle" x="1071.5" y="-919.1" font-family="Segoe UI" font-size="8.00" fill="#000000">28. model.shopify_source.stg_shopify__product_tmp</text>
</g>
<!-- 59. model.shopify_source.stg_shopify__product_58 -->
<g id="node59" class="node">
<title>59. model.shopify_source.stg_shopify__product_58</title>
<polygon fill="#ffffff" stroke="#000000" points="1524,-932 1331,-932 1331,-910 1524,-910 1524,-932"/>
<text text-anchor="middle" x="1427.5" y="-919.1" font-family="Segoe UI" font-size="8.00" fill="#000000">59. model.shopify_source.stg_shopify__product</text>
</g>
<!-- 28. model.shopify_source.stg_shopify__product_tmp_27&#45;&gt;59. model.shopify_source.stg_shopify__product_58 -->
<g id="edge93" class="edge">
<title>28. model.shopify_source.stg_shopify__product_tmp_27&#45;&gt;59. model.shopify_source.stg_shopify__product_58</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1177.75,-921C1224.18,-921 1278.52,-921 1324.56,-921"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1324.71,-923.1 1330.71,-921 1324.71,-918.9 1324.71,-923.1"/>
</g>
<!-- 29. model.shopify_source.stg_shopify__product_variant_tmp_28 -->
<g id="node29" class="node">
<title>29. model.shopify_source.stg_shopify__product_variant_tmp_28</title>
<polygon fill="#ffffff" stroke="#000000" points="861.5,-778 617.5,-778 617.5,-756 861.5,-756 861.5,-778"/>
<text text-anchor="middle" x="739.5" y="-765.1" font-family="Segoe UI" font-size="8.00" fill="#000000">29. model.shopify_source.stg_shopify__product_variant_tmp</text>
</g>
<!-- 62. model.shopify_source.stg_shopify__product_variant_61 -->
<g id="node62" class="node">
<title>62. model.shopify_source.stg_shopify__product_variant_61</title>
<polygon fill="#ffffff" stroke="#000000" points="1184,-772 959,-772 959,-750 1184,-750 1184,-772"/>
<text text-anchor="middle" x="1071.5" y="-759.1" font-family="Segoe UI" font-size="8.00" fill="#000000">62. model.shopify_source.stg_shopify__product_variant</text>
</g>
<!-- 29. model.shopify_source.stg_shopify__product_variant_tmp_28&#45;&gt;62. model.shopify_source.stg_shopify__product_variant_61 -->
<g id="edge95" class="edge">
<title>29. model.shopify_source.stg_shopify__product_variant_tmp_28&#45;&gt;62. model.shopify_source.stg_shopify__product_variant_61</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M861.51,-764.8C891.22,-764.26 922.98,-763.68 952.54,-763.14"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="952.86,-765.24 958.82,-763.03 952.78,-761.04 952.86,-765.24"/>
</g>
<!-- 30. model.shopify_source.stg_shopify__refund_tmp_29 -->
<g id="node30" class="node">
<title>30. model.shopify_source.stg_shopify__refund_tmp_29</title>
<polygon fill="#ffffff" stroke="#000000" points="546,-658 338,-658 338,-636 546,-636 546,-658"/>
<text text-anchor="middle" x="442" y="-645.1" font-family="Segoe UI" font-size="8.00" fill="#000000">30. model.shopify_source.stg_shopify__refund_tmp</text>
</g>
<!-- 63. model.shopify_source.stg_shopify__refund_62 -->
<g id="node63" class="node">
<title>63. model.shopify_source.stg_shopify__refund_62</title>
<polygon fill="#ffffff" stroke="#000000" points="833.5,-658 645.5,-658 645.5,-636 833.5,-636 833.5,-658"/>
<text text-anchor="middle" x="739.5" y="-645.1" font-family="Segoe UI" font-size="8.00" fill="#000000">63. model.shopify_source.stg_shopify__refund</text>
</g>
<!-- 30. model.shopify_source.stg_shopify__refund_tmp_29&#45;&gt;63. model.shopify_source.stg_shopify__refund_62 -->
<g id="edge102" class="edge">
<title>30. model.shopify_source.stg_shopify__refund_tmp_29&#45;&gt;63. model.shopify_source.stg_shopify__refund_62</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M546.35,-647C576.34,-647 609.02,-647 638.78,-647"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="639.08,-649.1 645.08,-647 639.08,-644.9 639.08,-649.1"/>
</g>
<!-- 31. model.shopify_source.stg_shopify__shop_tmp_30 -->
<g id="node31" class="node">
<title>31. model.shopify_source.stg_shopify__shop_tmp_30</title>
<polygon fill="#ffffff" stroke="#000000" points="1528,-558 1327,-558 1327,-536 1528,-536 1528,-558"/>
<text text-anchor="middle" x="1427.5" y="-545.1" font-family="Segoe UI" font-size="8.00" fill="#000000">31. model.shopify_source.stg_shopify__shop_tmp</text>
</g>
<!-- 64. model.shopify_source.stg_shopify__shop_63 -->
<g id="node64" class="node">
<title>64. model.shopify_source.stg_shopify__shop_63</title>
<polygon fill="#ffffff" stroke="#000000" points="1844,-558 1663,-558 1663,-536 1844,-536 1844,-558"/>
<text text-anchor="middle" x="1753.5" y="-545.1" font-family="Segoe UI" font-size="8.00" fill="#000000">64. model.shopify_source.stg_shopify__shop</text>
</g>
<!-- 31. model.shopify_source.stg_shopify__shop_tmp_30&#45;&gt;64. model.shopify_source.stg_shopify__shop_63 -->
<g id="edge109" class="edge">
<title>31. model.shopify_source.stg_shopify__shop_tmp_30&#45;&gt;64. model.shopify_source.stg_shopify__shop_63</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1528.35,-547C1569.12,-547 1616.08,-547 1656.45,-547"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1656.87,-549.1 1662.87,-547 1656.87,-544.9 1656.87,-549.1"/>
</g>
<!-- 32. model.shopify_source.stg_shopify__tax_line_tmp_31 -->
<g id="node32" class="node">
<title>32. model.shopify_source.stg_shopify__tax_line_tmp_31</title>
<polygon fill="#ffffff" stroke="#000000" points="548,-498 336,-498 336,-476 548,-476 548,-498"/>
<text text-anchor="middle" x="442" y="-485.1" font-family="Segoe UI" font-size="8.00" fill="#000000">32. model.shopify_source.stg_shopify__tax_line_tmp</text>
</g>
<!-- 65. model.shopify_source.stg_shopify__tax_line_64 -->
<g id="node65" class="node">
<title>65. model.shopify_source.stg_shopify__tax_line_64</title>
<polygon fill="#ffffff" stroke="#000000" points="836,-498 643,-498 643,-476 836,-476 836,-498"/>
<text text-anchor="middle" x="739.5" y="-485.1" font-family="Segoe UI" font-size="8.00" fill="#000000">65. model.shopify_source.stg_shopify__tax_line</text>
</g>
<!-- 32. model.shopify_source.stg_shopify__tax_line_tmp_31&#45;&gt;65. model.shopify_source.stg_shopify__tax_line_64 -->
<g id="edge110" class="edge">
<title>32. model.shopify_source.stg_shopify__tax_line_tmp_31&#45;&gt;65. model.shopify_source.stg_shopify__tax_line_64</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M548.01,-487C576.82,-487 608,-487 636.63,-487"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="636.69,-489.1 642.69,-487 636.69,-484.9 636.69,-489.1"/>
</g>
<!-- 33. model.shopify_source.stg_shopify__tender_transaction_tmp_32 -->
<g id="node33" class="node">
<title>33. model.shopify_source.stg_shopify__tender_transaction_tmp_32</title>
<polygon fill="#ffffff" stroke="#000000" points="571,-338 313,-338 313,-316 571,-316 571,-338"/>
<text text-anchor="middle" x="442" y="-325.1" font-family="Segoe UI" font-size="8.00" fill="#000000">33. model.shopify_source.stg_shopify__tender_transaction_tmp</text>
</g>
<!-- 66. model.shopify_source.stg_shopify__tender_transaction_65 -->
<g id="node66" class="node">
<title>66. model.shopify_source.stg_shopify__tender_transaction_65</title>
<polygon fill="#ffffff" stroke="#000000" points="858.5,-338 620.5,-338 620.5,-316 858.5,-316 858.5,-338"/>
<text text-anchor="middle" x="739.5" y="-325.1" font-family="Segoe UI" font-size="8.00" fill="#000000">66. model.shopify_source.stg_shopify__tender_transaction</text>
</g>
<!-- 33. model.shopify_source.stg_shopify__tender_transaction_tmp_32&#45;&gt;66. model.shopify_source.stg_shopify__tender_transaction_65 -->
<g id="edge108" class="edge">
<title>33. model.shopify_source.stg_shopify__tender_transaction_tmp_32&#45;&gt;66. model.shopify_source.stg_shopify__tender_transaction_65</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M571.32,-327C585.5,-327 599.91,-327 614.04,-327"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="614.07,-329.1 620.07,-327 614.07,-324.9 614.07,-329.1"/>
</g>
<!-- 34. model.shopify_source.stg_shopify__transaction_tmp_33 -->
<g id="node34" class="node">
<title>34. model.shopify_source.stg_shopify__transaction_tmp_33</title>
<polygon fill="#ffffff" stroke="#000000" points="555.5,-298 328.5,-298 328.5,-276 555.5,-276 555.5,-298"/>
<text text-anchor="middle" x="442" y="-285.1" font-family="Segoe UI" font-size="8.00" fill="#000000">34. model.shopify_source.stg_shopify__transaction_tmp</text>
</g>
<!-- 67. model.shopify_source.stg_shopify__transaction_66 -->
<g id="node67" class="node">
<title>67. model.shopify_source.stg_shopify__transaction_66</title>
<polygon fill="#ffffff" stroke="#000000" points="843.5,-298 635.5,-298 635.5,-276 843.5,-276 843.5,-298"/>
<text text-anchor="middle" x="739.5" y="-285.1" font-family="Segoe UI" font-size="8.00" fill="#000000">67. model.shopify_source.stg_shopify__transaction</text>
</g>
<!-- 34. model.shopify_source.stg_shopify__transaction_tmp_33&#45;&gt;67. model.shopify_source.stg_shopify__transaction_66 -->
<g id="edge81" class="edge">
<title>34. model.shopify_source.stg_shopify__transaction_tmp_33&#45;&gt;67. model.shopify_source.stg_shopify__transaction_66</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M555.56,-287C579.77,-287 605.31,-287 629.39,-287"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="629.47,-289.1 635.47,-287 629.47,-284.9 629.47,-289.1"/>
</g>
<!-- 68. model.shopify.int_shopify__daily_abandoned_checkouts_67 -->
<g id="node68" class="node">
<title>68. model.shopify.int_shopify__daily_abandoned_checkouts_67</title>
<polygon fill="#ffffff" stroke="#000000" points="1875,-182 1632,-182 1632,-160 1875,-160 1875,-182"/>
<text text-anchor="middle" x="1753.5" y="-169.1" font-family="Segoe UI" font-size="8.00" fill="#000000">68. model.shopify.int_shopify__daily_abandoned_checkouts</text>
</g>
<!-- 35. model.shopify_source.stg_shopify__abandoned_checkout_34&#45;&gt;68. model.shopify.int_shopify__daily_abandoned_checkouts_67 -->
<g id="edge51" class="edge">
<title>35. model.shopify_source.stg_shopify__abandoned_checkout_34&#45;&gt;68. model.shopify.int_shopify__daily_abandoned_checkouts_67</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1552.84,-171C1576.78,-171 1601.88,-171 1625.88,-171"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1625.96,-173.1 1631.96,-171 1625.96,-168.9 1625.96,-173.1"/>
</g>
<!-- 73. model.shopify.int_shopify__discounts__abandoned_checkouts_72 -->
<g id="node73" class="node">
<title>73. model.shopify.int_shopify__discounts__abandoned_checkouts_72</title>
<polygon fill="#ffffff" stroke="#000000" points="1887,-102 1620,-102 1620,-80 1887,-80 1887,-102"/>
<text text-anchor="middle" x="1753.5" y="-89.1" font-family="Segoe UI" font-size="8.00" fill="#000000">73. model.shopify.int_shopify__discounts__abandoned_checkouts</text>
</g>
<!-- 35. model.shopify_source.stg_shopify__abandoned_checkout_34&#45;&gt;73. model.shopify.int_shopify__discounts__abandoned_checkouts_72 -->
<g id="edge54" class="edge">
<title>35. model.shopify_source.stg_shopify__abandoned_checkout_34&#45;&gt;73. model.shopify.int_shopify__discounts__abandoned_checkouts_72</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1552.8,-163.23C1563.67,-160.12 1574.24,-156.12 1584,-151 1605.18,-139.89 1598.94,-122.34 1620,-111 1624.81,-108.41 1629.86,-106.12 1635.06,-104.11"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1635.83,-106.06 1640.75,-102.03 1634.39,-102.12 1635.83,-106.06"/>
</g>
<!-- 82. model.shopify.shopify__customers_81 -->
<g id="node82" class="node">
<title>82. model.shopify.shopify__customers_81</title>
<polygon fill="#ffffff" stroke="#000000" points="1831,-262 1676,-262 1676,-240 1831,-240 1831,-262"/>
<text text-anchor="middle" x="1753.5" y="-249.1" font-family="Segoe UI" font-size="8.00" fill="#000000">82. model.shopify.shopify__customers</text>
</g>
<!-- 35. model.shopify_source.stg_shopify__abandoned_checkout_34&#45;&gt;82. model.shopify.shopify__customers_81 -->
<g id="edge32" class="edge">
<title>35. model.shopify_source.stg_shopify__abandoned_checkout_34&#45;&gt;82. model.shopify.shopify__customers_81</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1552.8,-178.77C1563.67,-181.88 1574.24,-185.88 1584,-191 1605.18,-202.11 1598.94,-219.66 1620,-231 1635.05,-239.1 1652.38,-244.2 1669.43,-247.35"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1669.43,-249.49 1675.7,-248.43 1670.14,-245.35 1669.43,-249.49"/>
</g>
<!-- 83. model.shopify.shopify__customer_emails_82 -->
<g id="node83" class="node">
<title>83. model.shopify.shopify__customer_emails_82</title>
<polygon fill="#ffffff" stroke="#000000" points="1844,-222 1663,-222 1663,-200 1844,-200 1844,-222"/>
<text text-anchor="middle" x="1753.5" y="-209.1" font-family="Segoe UI" font-size="8.00" fill="#000000">83. model.shopify.shopify__customer_emails</text>
</g>
<!-- 35. model.shopify_source.stg_shopify__abandoned_checkout_34&#45;&gt;83. model.shopify.shopify__customer_emails_82 -->
<g id="edge22" class="edge">
<title>35. model.shopify_source.stg_shopify__abandoned_checkout_34&#45;&gt;83. model.shopify.shopify__customer_emails_82</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1517.89,-182.04C1561.18,-187.38 1613.2,-193.8 1657.24,-199.24"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1657.19,-201.35 1663.4,-200 1657.7,-197.18 1657.19,-201.35"/>
</g>
<!-- 36. model.shopify_source.stg_shopify__abandoned_checkout_discount_code_35&#45;&gt;73. model.shopify.int_shopify__discounts__abandoned_checkouts_72 -->
<g id="edge55" class="edge">
<title>36. model.shopify_source.stg_shopify__abandoned_checkout_discount_code_35&#45;&gt;73. model.shopify.int_shopify__discounts__abandoned_checkouts_72</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1517.89,-62.04C1561.18,-67.38 1613.2,-73.8 1657.24,-79.24"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1657.19,-81.35 1663.4,-80 1657.7,-77.18 1657.19,-81.35"/>
</g>
<!-- 37. model.shopify_source.stg_shopify__abandoned_checkout_shipping_line_36&#45;&gt;73. model.shopify.int_shopify__discounts__abandoned_checkouts_72 -->
<g id="edge56" class="edge">
<title>37. model.shopify_source.stg_shopify__abandoned_checkout_shipping_line_36&#45;&gt;73. model.shopify.int_shopify__discounts__abandoned_checkouts_72</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1581.01,-91C1591.95,-91 1602.95,-91 1613.81,-91"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1613.82,-93.1 1619.82,-91 1613.82,-88.9 1613.82,-93.1"/>
</g>
<!-- 76. model.shopify.int_shopify__products_with_aggregates_75 -->
<g id="node76" class="node">
<title>76. model.shopify.int_shopify__products_with_aggregates_75</title>
<polygon fill="#ffffff" stroke="#000000" points="1871,-972 1636,-972 1636,-950 1871,-950 1871,-972"/>
<text text-anchor="middle" x="1753.5" y="-959.1" font-family="Segoe UI" font-size="8.00" fill="#000000">76. model.shopify.int_shopify__products_with_aggregates</text>
</g>
<!-- 38. model.shopify_source.stg_shopify__collection_37&#45;&gt;76. model.shopify.int_shopify__products_with_aggregates_75 -->
<g id="edge69" class="edge">
<title>38. model.shopify_source.stg_shopify__collection_37&#45;&gt;76. model.shopify.int_shopify__products_with_aggregates_75</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1528.21,-1031.4C1546.88,-1028.69 1566.13,-1025.28 1584,-1021 1633.24,-1009.21 1688.12,-988.1 1721.47,-974.32"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1722.31,-976.25 1727.04,-972.01 1720.69,-972.37 1722.31,-976.25"/>
</g>
<!-- 39. model.shopify_source.stg_shopify__collection_product_38&#45;&gt;76. model.shopify.int_shopify__products_with_aggregates_75 -->
<g id="edge68" class="edge">
<title>39. model.shopify_source.stg_shopify__collection_product_38&#45;&gt;76. model.shopify.int_shopify__products_with_aggregates_75</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1517.89,-989.96C1561.18,-984.62 1613.2,-978.2 1657.24,-972.76"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1657.7,-974.82 1663.4,-972 1657.19,-970.65 1657.7,-974.82"/>
</g>
<!-- 69. model.shopify.int_shopify__customer_email_rollup_68 -->
<g id="node69" class="node">
<title>69. model.shopify.int_shopify__customer_email_rollup_68</title>
<polygon fill="#ffffff" stroke="#000000" points="1536.5,-222 1318.5,-222 1318.5,-200 1536.5,-200 1536.5,-222"/>
<text text-anchor="middle" x="1427.5" y="-209.1" font-family="Segoe UI" font-size="8.00" fill="#000000">69. model.shopify.int_shopify__customer_email_rollup</text>
</g>
<!-- 40. model.shopify_source.stg_shopify__customer_39&#45;&gt;69. model.shopify.int_shopify__customer_email_rollup_68 -->
<g id="edge52" class="edge">
<title>40. model.shopify_source.stg_shopify__customer_39&#45;&gt;69. model.shopify.int_shopify__customer_email_rollup_68</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1171.11,-236.97C1214.97,-232.51 1266.87,-227.23 1312.39,-222.6"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1312.73,-224.68 1318.49,-221.98 1312.3,-220.5 1312.73,-224.68"/>
</g>
<!-- 78. model.shopify.int_shopify__emails__order_aggregates_77 -->
<g id="node78" class="node">
<title>78. model.shopify.int_shopify__emails__order_aggregates_77</title>
<polygon fill="#ffffff" stroke="#000000" points="1544.5,-338 1310.5,-338 1310.5,-316 1544.5,-316 1544.5,-338"/>
<text text-anchor="middle" x="1427.5" y="-325.1" font-family="Segoe UI" font-size="8.00" fill="#000000">78. model.shopify.int_shopify__emails__order_aggregates</text>
</g>
<!-- 40. model.shopify_source.stg_shopify__customer_39&#45;&gt;78. model.shopify.int_shopify__emails__order_aggregates_77 -->
<g id="edge62" class="edge">
<title>40. model.shopify_source.stg_shopify__customer_39&#45;&gt;78. model.shopify.int_shopify__emails__order_aggregates_77</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1171.37,-256.27C1192.49,-259.05 1214.58,-262.58 1235,-267 1290.6,-279.03 1353.17,-300.12 1391.21,-313.82"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1390.74,-315.88 1397.09,-315.95 1392.17,-311.93 1390.74,-315.88"/>
</g>
<!-- 40. model.shopify_source.stg_shopify__customer_39&#45;&gt;82. model.shopify.shopify__customers_81 -->
<g id="edge30" class="edge">
<title>40. model.shopify_source.stg_shopify__customer_39&#45;&gt;82. model.shopify.shopify__customers_81</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1171.01,-247.58C1305.39,-248.37 1543.79,-249.77 1669.54,-250.51"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1669.8,-252.61 1675.81,-250.55 1669.82,-248.41 1669.8,-252.61"/>
</g>
<!-- 41. model.shopify_source.stg_shopify__customer_tag_40&#45;&gt;69. model.shopify.int_shopify__customer_email_rollup_68 -->
<g id="edge53" class="edge">
<title>41. model.shopify_source.stg_shopify__customer_tag_40&#45;&gt;69. model.shopify.int_shopify__customer_email_rollup_68</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1180.15,-208.22C1221.93,-208.69 1269.84,-209.23 1312.23,-209.71"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1312.42,-211.81 1318.44,-209.78 1312.47,-207.61 1312.42,-211.81"/>
</g>
<!-- 79. model.shopify.shopify__customers__order_aggregates_78 -->
<g id="node79" class="node">
<title>79. model.shopify.shopify__customers__order_aggregates_78</title>
<polygon fill="#ffffff" stroke="#000000" points="1545,-378 1310,-378 1310,-356 1545,-356 1545,-378"/>
<text text-anchor="middle" x="1427.5" y="-365.1" font-family="Segoe UI" font-size="8.00" fill="#000000">79. model.shopify.shopify__customers__order_aggregates</text>
</g>
<!-- 41. model.shopify_source.stg_shopify__customer_tag_40&#45;&gt;79. model.shopify.shopify__customers__order_aggregates_78 -->
<g id="edge46" class="edge">
<title>41. model.shopify_source.stg_shopify__customer_tag_40&#45;&gt;79. model.shopify.shopify__customers__order_aggregates_78</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1180.27,-202.85C1200.21,-206.65 1219.58,-213.98 1235,-227 1277.56,-262.91 1228.54,-310.97 1271,-347 1280.63,-355.17 1291.88,-361.04 1303.84,-365.17"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1303.42,-367.24 1309.77,-367.06 1304.69,-363.23 1303.42,-367.24"/>
</g>
<!-- 87. model.shopify.shopify__discounts_86 -->
<g id="node87" class="node">
<title>87. model.shopify.shopify__discounts_86</title>
<polygon fill="#ffffff" stroke="#000000" points="2104.5,-122 1952.5,-122 1952.5,-100 2104.5,-100 2104.5,-122"/>
<text text-anchor="middle" x="2028.5" y="-109.1" font-family="Segoe UI" font-size="8.00" fill="#000000">87. model.shopify.shopify__discounts</text>
</g>
<!-- 42. model.shopify_source.stg_shopify__discount_code_41&#45;&gt;87. model.shopify.shopify__discounts_86 -->
<g id="edge4" class="edge">
<title>42. model.shopify_source.stg_shopify__discount_code_41&#45;&gt;87. model.shopify.shopify__discounts_86</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1792.17,-42.04C1842.31,-56.73 1930.8,-82.66 1983.81,-98.2"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1983.43,-100.27 1989.78,-99.95 1984.61,-96.24 1983.43,-100.27"/>
</g>
<!-- 75. model.shopify.int_shopify__inventory_level__aggregates_74 -->
<g id="node75" class="node">
<title>75. model.shopify.int_shopify__inventory_level__aggregates_74</title>
<polygon fill="#ffffff" stroke="#000000" points="1549,-692 1306,-692 1306,-670 1549,-670 1549,-692"/>
<text text-anchor="middle" x="1427.5" y="-679.1" font-family="Segoe UI" font-size="8.00" fill="#000000">75. model.shopify.int_shopify__inventory_level__aggregates</text>
</g>
<!-- 43. model.shopify_source.stg_shopify__fulfillment_42&#45;&gt;75. model.shopify.int_shopify__inventory_level__aggregates_74 -->
<g id="edge77" class="edge">
<title>43. model.shopify_source.stg_shopify__fulfillment_42&#45;&gt;75. model.shopify.int_shopify__inventory_level__aggregates_74</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1170.17,-709.96C1217.66,-704.6 1274.77,-698.15 1323.01,-692.69"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1323.42,-694.76 1329.15,-692 1322.95,-690.59 1323.42,-694.76"/>
</g>
<!-- 81. model.shopify.shopify__orders_80 -->
<g id="node81" class="node">
<title>81. model.shopify.shopify__orders_80</title>
<polygon fill="#ffffff" stroke="#000000" points="1497,-458 1358,-458 1358,-436 1497,-436 1497,-458"/>
<text text-anchor="middle" x="1427.5" y="-445.1" font-family="Segoe UI" font-size="8.00" fill="#000000">81. model.shopify.shopify__orders</text>
</g>
<!-- 43. model.shopify_source.stg_shopify__fulfillment_42&#45;&gt;81. model.shopify.shopify__orders_80 -->
<g id="edge15" class="edge">
<title>43. model.shopify_source.stg_shopify__fulfillment_42&#45;&gt;81. model.shopify.shopify__orders_80</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1172.74,-728.11C1195.71,-724.86 1218.26,-717.01 1235,-701 1304.69,-634.33 1205.76,-558.04 1271,-487 1291.51,-464.67 1322.66,-454.09 1351.71,-449.31"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1352.25,-451.36 1357.87,-448.38 1351.62,-447.2 1352.25,-451.36"/>
</g>
<!-- 80. model.shopify.shopify__inventory_levels_79 -->
<g id="node80" class="node">
<title>80. model.shopify.shopify__inventory_levels_79</title>
<polygon fill="#ffffff" stroke="#000000" points="1842.5,-832 1664.5,-832 1664.5,-810 1842.5,-810 1842.5,-832"/>
<text text-anchor="middle" x="1753.5" y="-819.1" font-family="Segoe UI" font-size="8.00" fill="#000000">80. model.shopify.shopify__inventory_levels</text>
</g>
<!-- 44. model.shopify_source.stg_shopify__inventory_item_43&#45;&gt;80. model.shopify.shopify__inventory_levels_79 -->
<g id="edge34" class="edge">
<title>44. model.shopify_source.stg_shopify__inventory_item_43&#45;&gt;80. model.shopify.shopify__inventory_levels_79</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1538.19,-834.23C1577.07,-831.83 1620.44,-829.15 1657.95,-826.84"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1658.53,-828.9 1664.39,-826.44 1658.28,-824.71 1658.53,-828.9"/>
</g>
<!-- 45. model.shopify_source.stg_shopify__inventory_level_44&#45;&gt;80. model.shopify.shopify__inventory_levels_79 -->
<g id="edge33" class="edge">
<title>45. model.shopify_source.stg_shopify__inventory_level_44&#45;&gt;80. model.shopify.shopify__inventory_levels_79</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1539.1,-807.83C1577.74,-810.21 1620.74,-812.87 1657.96,-815.16"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1658.24,-817.29 1664.36,-815.56 1658.5,-813.09 1658.24,-817.29"/>
</g>
<!-- 46. model.shopify_source.stg_shopify__location_45&#45;&gt;80. model.shopify.shopify__inventory_levels_79 -->
<g id="edge35" class="edge">
<title>46. model.shopify_source.stg_shopify__location_45&#45;&gt;80. model.shopify.shopify__inventory_levels_79</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1524.55,-870.25C1544.27,-867.6 1564.85,-864.49 1584,-861 1625.21,-853.48 1671.47,-842.3 1705.08,-833.67"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1705.92,-835.62 1711.21,-832.09 1704.87,-831.55 1705.92,-835.62"/>
</g>
<!-- 48. model.shopify_source.stg_shopify__order_47&#45;&gt;75. model.shopify.int_shopify__inventory_level__aggregates_74 -->
<g id="edge78" class="edge">
<title>48. model.shopify_source.stg_shopify__order_47&#45;&gt;75. model.shopify.int_shopify__inventory_level__aggregates_74</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1163.1,-359.17C1189.16,-361.55 1215.72,-369.12 1235,-387 1294.81,-442.49 1227.13,-498.22 1271,-567 1301.59,-614.95 1360.07,-649.47 1395.95,-667.26"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1395.19,-669.23 1401.5,-669.97 1397.03,-665.46 1395.19,-669.23"/>
</g>
<!-- 48. model.shopify_source.stg_shopify__order_47&#45;&gt;78. model.shopify.int_shopify__emails__order_aggregates_77 -->
<g id="edge59" class="edge">
<title>48. model.shopify_source.stg_shopify__order_47&#45;&gt;78. model.shopify.int_shopify__emails__order_aggregates_77</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1163.2,-356.75C1211.92,-351.25 1272.2,-344.44 1322.77,-338.72"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1323.16,-340.79 1328.89,-338.03 1322.69,-336.62 1323.16,-340.79"/>
</g>
<!-- 48. model.shopify_source.stg_shopify__order_47&#45;&gt;79. model.shopify.shopify__customers__order_aggregates_78 -->
<g id="edge43" class="edge">
<title>48. model.shopify_source.stg_shopify__order_47&#45;&gt;79. model.shopify.shopify__customers__order_aggregates_78</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1163.2,-367C1205.94,-367 1257.57,-367 1303.74,-367"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1303.93,-369.1 1309.93,-367 1303.93,-364.9 1303.93,-369.1"/>
</g>
<!-- 48. model.shopify_source.stg_shopify__order_47&#45;&gt;81. model.shopify.shopify__orders_80 -->
<g id="edge8" class="edge">
<title>48. model.shopify_source.stg_shopify__order_47&#45;&gt;81. model.shopify.shopify__orders_80</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1163.24,-375.22C1186.75,-378.16 1211.94,-382.01 1235,-387 1290.6,-399.03 1353.17,-420.12 1391.21,-433.82"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1390.74,-435.88 1397.09,-435.95 1392.17,-431.93 1390.74,-435.88"/>
</g>
<!-- 49. model.shopify_source.stg_shopify__order_adjustment_48&#45;&gt;81. model.shopify.shopify__orders_80 -->
<g id="edge10" class="edge">
<title>49. model.shopify_source.stg_shopify__order_adjustment_48&#45;&gt;81. model.shopify.shopify__orders_80</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1188.41,-563.65C1204.9,-559.87 1220.99,-553.96 1235,-545 1260.56,-528.66 1246.55,-504.96 1271,-487 1294.29,-469.89 1324.21,-460.08 1351.58,-454.46"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1352.26,-456.47 1357.74,-453.26 1351.45,-452.35 1352.26,-456.47"/>
</g>
<!-- 50. model.shopify_source.stg_shopify__order_discount_code_49&#45;&gt;81. model.shopify.shopify__orders_80 -->
<g id="edge12" class="edge">
<title>50. model.shopify_source.stg_shopify__order_discount_code_49&#45;&gt;81. model.shopify.shopify__orders_80</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1194.53,-288.04C1209.07,-292.08 1222.99,-298.15 1235,-307 1266.38,-330.13 1242.69,-360.19 1271,-387 1296.12,-410.78 1331.68,-425.43 1362.46,-434.3"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1362.2,-436.41 1368.54,-436 1363.33,-432.36 1362.2,-436.41"/>
</g>
<!-- 84. model.shopify.int_shopify__discounts__order_aggregates_83 -->
<g id="node84" class="node">
<title>84. model.shopify.int_shopify__discounts__order_aggregates_83</title>
<polygon fill="#ffffff" stroke="#000000" points="1877,-302 1630,-302 1630,-280 1877,-280 1877,-302"/>
<text text-anchor="middle" x="1753.5" y="-289.1" font-family="Segoe UI" font-size="8.00" fill="#000000">84. model.shopify.int_shopify__discounts__order_aggregates</text>
</g>
<!-- 50. model.shopify_source.stg_shopify__order_discount_code_49&#45;&gt;84. model.shopify.int_shopify__discounts__order_aggregates_83 -->
<g id="edge65" class="edge">
<title>50. model.shopify_source.stg_shopify__order_discount_code_49&#45;&gt;84. model.shopify.int_shopify__discounts__order_aggregates_83</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1194.86,-287.72C1315.94,-288.43 1500.55,-289.52 1623.79,-290.24"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1623.97,-292.34 1629.98,-290.28 1623.99,-288.14 1623.97,-292.34"/>
</g>
<!-- 74. model.shopify.shopify__orders__order_line_aggregates_73 -->
<g id="node74" class="node">
<title>74. model.shopify.shopify__orders__order_line_aggregates_73</title>
<polygon fill="#ffffff" stroke="#000000" points="1190.5,-458 952.5,-458 952.5,-436 1190.5,-436 1190.5,-458"/>
<text text-anchor="middle" x="1071.5" y="-445.1" font-family="Segoe UI" font-size="8.00" fill="#000000">74. model.shopify.shopify__orders__order_line_aggregates</text>
</g>
<!-- 51. model.shopify_source.stg_shopify__order_line_50&#45;&gt;74. model.shopify.shopify__orders__order_line_aggregates_73 -->
<g id="edge73" class="edge">
<title>51. model.shopify_source.stg_shopify__order_line_50&#45;&gt;74. model.shopify.shopify__orders__order_line_aggregates_73</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M840.78,-602.74C852.02,-599.17 862.74,-594.09 872,-587 903.59,-562.79 878.88,-532.13 908,-505 932.56,-482.13 966.74,-468.16 997.42,-459.7"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="998.25,-461.65 1003.51,-458.07 997.17,-457.59 998.25,-461.65"/>
</g>
<!-- 51. model.shopify_source.stg_shopify__order_line_50&#45;&gt;75. model.shopify.int_shopify__inventory_level__aggregates_74 -->
<g id="edge76" class="edge">
<title>51. model.shopify_source.stg_shopify__order_line_50&#45;&gt;75. model.shopify.int_shopify__inventory_level__aggregates_74</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M840.62,-617.8C968.01,-631.54 1187.2,-655.19 1318.33,-669.33"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1318.32,-671.44 1324.51,-670 1318.77,-667.27 1318.32,-671.44"/>
</g>
<!-- 77. model.shopify.shopify__order_lines_76 -->
<g id="node77" class="node">
<title>77. model.shopify.shopify__order_lines_76</title>
<polygon fill="#ffffff" stroke="#000000" points="1506,-518 1349,-518 1349,-496 1506,-496 1506,-518"/>
<text text-anchor="middle" x="1427.5" y="-505.1" font-family="Segoe UI" font-size="8.00" fill="#000000">77. model.shopify.shopify__order_lines</text>
</g>
<!-- 51. model.shopify_source.stg_shopify__order_line_50&#45;&gt;77. model.shopify.shopify__order_lines_76 -->
<g id="edge39" class="edge">
<title>51. model.shopify_source.stg_shopify__order_line_50&#45;&gt;77. model.shopify.shopify__order_lines_76</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M840.62,-613.32C965.52,-619.38 1170.53,-622.76 1235,-585 1261.18,-569.67 1245.48,-543.41 1271,-527 1292,-513.49 1317.91,-507.1 1342.52,-504.45"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1342.98,-506.52 1348.75,-503.86 1342.58,-502.34 1342.98,-506.52"/>
</g>
<!-- 71. model.shopify.shopify__orders__order_refunds_70 -->
<g id="node71" class="node">
<title>71. model.shopify.shopify__orders__order_refunds_70</title>
<polygon fill="#ffffff" stroke="#000000" points="1173,-692 970,-692 970,-670 1173,-670 1173,-692"/>
<text text-anchor="middle" x="1071.5" y="-679.1" font-family="Segoe UI" font-size="8.00" fill="#000000">71. model.shopify.shopify__orders__order_refunds</text>
</g>
<!-- 52. model.shopify_source.stg_shopify__order_line_refund_51&#45;&gt;71. model.shopify.shopify__orders__order_refunds_70 -->
<g id="edge48" class="edge">
<title>52. model.shopify_source.stg_shopify__order_line_refund_51&#45;&gt;71. model.shopify.shopify__orders__order_refunds_70</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M855.92,-684.9C890.91,-684.27 929.19,-683.57 963.6,-682.94"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="964.02,-685.04 969.98,-682.83 963.94,-680.84 964.02,-685.04"/>
</g>
<!-- 70. model.shopify.int_shopify__order__shipping_aggregates_69 -->
<g id="node70" class="node">
<title>70. model.shopify.int_shopify__order__shipping_aggregates_69</title>
<polygon fill="#ffffff" stroke="#000000" points="860.5,-458 618.5,-458 618.5,-436 860.5,-436 860.5,-458"/>
<text text-anchor="middle" x="739.5" y="-445.1" font-family="Segoe UI" font-size="8.00" fill="#000000">70. model.shopify.int_shopify__order__shipping_aggregates</text>
</g>
<!-- 54. model.shopify_source.stg_shopify__order_shipping_line_53&#45;&gt;70. model.shopify.int_shopify__order__shipping_aggregates_69 -->
<g id="edge63" class="edge">
<title>54. model.shopify_source.stg_shopify__order_shipping_line_53&#45;&gt;70. model.shopify.int_shopify__order__shipping_aggregates_69</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M562.77,-447C579.01,-447 595.72,-447 612.08,-447"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="612.08,-449.1 618.08,-447 612.08,-444.9 612.08,-449.1"/>
</g>
<!-- 55. model.shopify_source.stg_shopify__order_shipping_tax_line_54&#45;&gt;70. model.shopify.int_shopify__order__shipping_aggregates_69 -->
<g id="edge64" class="edge">
<title>55. model.shopify_source.stg_shopify__order_shipping_tax_line_54&#45;&gt;70. model.shopify.int_shopify__order__shipping_aggregates_69</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M524.53,-418.04C563.77,-423.35 610.87,-429.72 650.88,-435.14"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="651.01,-437.28 657.24,-436 651.57,-433.11 651.01,-437.28"/>
</g>
<!-- 56. model.shopify_source.stg_shopify__order_tag_55&#45;&gt;81. model.shopify.shopify__orders_80 -->
<g id="edge13" class="edge">
<title>56. model.shopify_source.stg_shopify__order_tag_55&#45;&gt;81. model.shopify.shopify__orders_80</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1122.47,-513.99C1187.87,-499.58 1302.17,-474.4 1370.45,-459.35"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1371.09,-461.36 1376.5,-458.02 1370.19,-457.26 1371.09,-461.36"/>
</g>
<!-- 57. model.shopify_source.stg_shopify__order_url_tag_56&#45;&gt;81. model.shopify.shopify__orders_80 -->
<g id="edge14" class="edge">
<title>57. model.shopify_source.stg_shopify__order_url_tag_56&#45;&gt;81. model.shopify.shopify__orders_80</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1170.17,-418.04C1227.51,-424.52 1298.86,-432.58 1351.72,-438.55"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1351.54,-440.64 1357.74,-439.23 1352.02,-436.47 1351.54,-440.64"/>
</g>
<!-- 58. model.shopify_source.stg_shopify__price_rule_57&#45;&gt;87. model.shopify.shopify__discounts_86 -->
<g id="edge5" class="edge">
<title>58. model.shopify_source.stg_shopify__price_rule_57&#45;&gt;87. model.shopify.shopify__discounts_86</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1854.22,-123.69C1884.51,-121.48 1917.41,-119.07 1946.32,-116.95"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1946.6,-119.03 1952.43,-116.5 1946.29,-114.84 1946.6,-119.03"/>
</g>
<!-- 59. model.shopify_source.stg_shopify__product_58&#45;&gt;76. model.shopify.int_shopify__products_with_aggregates_75 -->
<g id="edge67" class="edge">
<title>59. model.shopify_source.stg_shopify__product_58&#45;&gt;76. model.shopify.int_shopify__products_with_aggregates_75</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1517.89,-932.04C1561.18,-937.38 1613.2,-943.8 1657.24,-949.24"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1657.19,-951.35 1663.4,-950 1657.7,-947.18 1657.19,-951.35"/>
</g>
<!-- 59. model.shopify_source.stg_shopify__product_58&#45;&gt;80. model.shopify.shopify__inventory_levels_79 -->
<g id="edge37" class="edge">
<title>59. model.shopify_source.stg_shopify__product_58&#45;&gt;80. model.shopify.shopify__inventory_levels_79</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1524.05,-913.53C1544.1,-910.63 1564.94,-906.6 1584,-901 1638.34,-885.05 1697.07,-853.56 1728.83,-835.2"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1729.94,-836.99 1734.07,-832.15 1727.83,-833.36 1729.94,-836.99"/>
</g>
<!-- 60. model.shopify_source.stg_shopify__product_image_59&#45;&gt;76. model.shopify.int_shopify__products_with_aggregates_75 -->
<g id="edge72" class="edge">
<title>60. model.shopify_source.stg_shopify__product_image_59&#45;&gt;76. model.shopify.int_shopify__products_with_aggregates_75</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1538.64,-961C1567.85,-961 1599.56,-961 1629.4,-961"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1629.74,-963.1 1635.74,-961 1629.74,-958.9 1629.74,-963.1"/>
</g>
<!-- 61. model.shopify_source.stg_shopify__product_tag_60&#45;&gt;76. model.shopify.int_shopify__products_with_aggregates_75 -->
<g id="edge70" class="edge">
<title>61. model.shopify_source.stg_shopify__product_tag_60&#45;&gt;76. model.shopify.int_shopify__products_with_aggregates_75</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1532.74,-1073.56C1550.14,-1070.63 1567.79,-1066.59 1584,-1061 1642.68,-1040.79 1703.3,-998.59 1733.29,-976.02"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1734.68,-977.6 1738.19,-972.3 1732.14,-974.26 1734.68,-977.6"/>
</g>
<!-- 62. model.shopify_source.stg_shopify__product_variant_61&#45;&gt;76. model.shopify.int_shopify__products_with_aggregates_75 -->
<g id="edge71" class="edge">
<title>62. model.shopify_source.stg_shopify__product_variant_61&#45;&gt;76. model.shopify.int_shopify__products_with_aggregates_75</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1184.03,-753.27C1313.87,-746.33 1518.86,-742.42 1584,-781 1610.76,-796.85 1600.26,-816.97 1620,-841 1655.05,-883.67 1705.38,-924.99 1732.82,-946.23"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1731.64,-947.97 1737.67,-949.96 1734.2,-944.64 1731.64,-947.97"/>
</g>
<!-- 62. model.shopify_source.stg_shopify__product_variant_61&#45;&gt;77. model.shopify.shopify__order_lines_76 -->
<g id="edge40" class="edge">
<title>62. model.shopify_source.stg_shopify__product_variant_61&#45;&gt;77. model.shopify.shopify__order_lines_76</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1184.1,-766.1C1203.02,-762.04 1221.03,-754.36 1235,-741 1304.69,-674.33 1201.49,-593.86 1271,-527 1289.89,-508.83 1316.56,-501.5 1342.5,-499.42"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1342.86,-501.51 1348.72,-499.02 1342.59,-497.31 1342.86,-501.51"/>
</g>
<!-- 62. model.shopify_source.stg_shopify__product_variant_61&#45;&gt;80. model.shopify.shopify__inventory_levels_79 -->
<g id="edge36" class="edge">
<title>62. model.shopify_source.stg_shopify__product_variant_61&#45;&gt;80. model.shopify.shopify__inventory_levels_79</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1184.11,-752.24C1311.13,-743.31 1510.5,-732.76 1584,-748 1638.3,-759.26 1696.6,-788.92 1728.4,-806.78"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1727.39,-808.62 1733.64,-809.75 1729.46,-804.96 1727.39,-808.62"/>
</g>
<!-- 63. model.shopify_source.stg_shopify__refund_62&#45;&gt;71. model.shopify.shopify__orders__order_refunds_70 -->
<g id="edge47" class="edge">
<title>63. model.shopify_source.stg_shopify__refund_62&#45;&gt;71. model.shopify.shopify__orders__order_refunds_70</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M833.74,-656.61C874.25,-660.78 921.93,-665.69 963.84,-670.01"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="963.8,-672.12 969.98,-670.64 964.23,-667.94 963.8,-672.12"/>
</g>
<!-- 64. model.shopify_source.stg_shopify__shop_63&#45;&gt;88. model.shopify.shopify__daily_shop_87 -->
<g id="edge23" class="edge">
<title>64. model.shopify_source.stg_shopify__shop_63&#45;&gt;88. model.shopify.shopify__daily_shop_87</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1844.16,-540.46C1858.89,-537.43 1873.68,-533.11 1887,-527 1906.19,-518.19 1904.78,-506.67 1923,-496 1940.96,-485.48 1962.34,-477.08 1981.06,-470.88"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1981.72,-472.87 1986.78,-469.03 1980.42,-468.88 1981.72,-472.87"/>
</g>
<!-- 65. model.shopify_source.stg_shopify__tax_line_64&#45;&gt;74. model.shopify.shopify__orders__order_line_aggregates_73 -->
<g id="edge74" class="edge">
<title>65. model.shopify_source.stg_shopify__tax_line_64&#45;&gt;74. model.shopify.shopify__orders__order_line_aggregates_73</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M831.55,-475.96C875.73,-470.61 928.84,-464.17 973.75,-458.73"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="974.05,-460.81 979.75,-458 973.54,-456.64 974.05,-460.81"/>
</g>
<!-- 65. model.shopify_source.stg_shopify__tax_line_64&#45;&gt;77. model.shopify.shopify__order_lines_76 -->
<g id="edge42" class="edge">
<title>65. model.shopify_source.stg_shopify__tax_line_64&#45;&gt;77. model.shopify.shopify__order_lines_76</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M836.25,-489.79C971.17,-493.73 1215.02,-500.83 1342.98,-504.56"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1342.92,-506.66 1348.98,-504.74 1343.05,-502.47 1342.92,-506.66"/>
</g>
<!-- 72. model.shopify.shopify__transactions_71 -->
<g id="node72" class="node">
<title>72. model.shopify.shopify__transactions_71</title>
<polygon fill="#ffffff" stroke="#000000" points="1153,-338 990,-338 990,-316 1153,-316 1153,-338"/>
<text text-anchor="middle" x="1071.5" y="-325.1" font-family="Segoe UI" font-size="8.00" fill="#000000">72. model.shopify.shopify__transactions</text>
</g>
<!-- 66. model.shopify_source.stg_shopify__tender_transaction_65&#45;&gt;72. model.shopify.shopify__transactions_71 -->
<g id="edge19" class="edge">
<title>66. model.shopify_source.stg_shopify__tender_transaction_65&#45;&gt;72. model.shopify.shopify__transactions_71</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M858.71,-327C899.96,-327 945.47,-327 983.69,-327"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="983.76,-329.1 989.76,-327 983.76,-324.9 983.76,-329.1"/>
</g>
<!-- 67. model.shopify_source.stg_shopify__transaction_66&#45;&gt;72. model.shopify.shopify__transactions_71 -->
<g id="edge18" class="edge">
<title>67. model.shopify_source.stg_shopify__transaction_66&#45;&gt;72. model.shopify.shopify__transactions_71</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M831.55,-298.04C879.02,-303.79 936.79,-310.79 983.63,-316.47"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="983.66,-318.59 989.87,-317.23 984.17,-314.42 983.66,-318.59"/>
</g>
<!-- 68. model.shopify.int_shopify__daily_abandoned_checkouts_67&#45;&gt;88. model.shopify.shopify__daily_shop_87 -->
<g id="edge26" class="edge">
<title>68. model.shopify.int_shopify__daily_abandoned_checkouts_67&#45;&gt;88. model.shopify.shopify__daily_shop_87</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1875.1,-181.57C1879.36,-184.28 1883.36,-187.4 1887,-191 1957.2,-260.29 1863.18,-331.57 1923,-410 1935.62,-426.54 1955.28,-437.57 1974.16,-444.84"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1973.63,-446.88 1979.99,-446.97 1975.08,-442.93 1973.63,-446.88"/>
</g>
<!-- 69. model.shopify.int_shopify__customer_email_rollup_68&#45;&gt;83. model.shopify.shopify__customer_emails_82 -->
<g id="edge20" class="edge">
<title>69. model.shopify.int_shopify__customer_email_rollup_68&#45;&gt;83. model.shopify.shopify__customer_emails_82</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1536.84,-211C1575.53,-211 1618.83,-211 1656.42,-211"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1656.88,-213.1 1662.88,-211 1656.88,-208.9 1656.88,-213.1"/>
</g>
<!-- 70. model.shopify.int_shopify__order__shipping_aggregates_69&#45;&gt;74. model.shopify.shopify__orders__order_line_aggregates_73 -->
<g id="edge75" class="edge">
<title>70. model.shopify.int_shopify__order__shipping_aggregates_69&#45;&gt;74. model.shopify.shopify__orders__order_line_aggregates_73</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M860.57,-447C888.41,-447 918.1,-447 946.12,-447"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="946.45,-449.1 952.45,-447 946.45,-444.9 946.45,-449.1"/>
</g>
<!-- 71. model.shopify.shopify__orders__order_refunds_70&#45;&gt;75. model.shopify.int_shopify__inventory_level__aggregates_74 -->
<g id="edge79" class="edge">
<title>71. model.shopify.shopify__orders__order_refunds_70&#45;&gt;75. model.shopify.int_shopify__inventory_level__aggregates_74</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1173.47,-681C1212.81,-681 1258.35,-681 1299.85,-681"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1299.95,-683.1 1305.95,-681 1299.95,-678.9 1299.95,-683.1"/>
</g>
<!-- 71. model.shopify.shopify__orders__order_refunds_70&#45;&gt;77. model.shopify.shopify__order_lines_76 -->
<g id="edge41" class="edge">
<title>71. model.shopify.shopify__orders__order_refunds_70&#45;&gt;77. model.shopify.shopify__order_lines_76</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1133.14,-669.97C1166.89,-661.04 1207.52,-645.29 1235,-618 1265.86,-587.35 1236.67,-553.7 1271,-527 1291.19,-511.3 1317.51,-504.43 1342.74,-502.02"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1342.97,-504.11 1348.78,-501.53 1342.63,-499.93 1342.97,-504.11"/>
</g>
<!-- 71. model.shopify.shopify__orders__order_refunds_70&#45;&gt;81. model.shopify.shopify__orders_80 -->
<g id="edge11" class="edge">
<title>71. model.shopify.shopify__orders__order_refunds_70&#45;&gt;81. model.shopify.shopify__orders_80</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1104.09,-669.89C1140.44,-655.59 1199.66,-627.42 1235,-585 1264.7,-549.35 1236.59,-518.13 1271,-487 1293,-467.1 1323.59,-456.83 1351.82,-451.63"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1352.25,-453.68 1357.8,-450.59 1351.53,-449.55 1352.25,-453.68"/>
</g>
<!-- 72. model.shopify.shopify__transactions_71&#45;&gt;78. model.shopify.int_shopify__emails__order_aggregates_77 -->
<g id="edge61" class="edge">
<title>72. model.shopify.shopify__transactions_71&#45;&gt;78. model.shopify.int_shopify__emails__order_aggregates_77</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1153.27,-327C1197.88,-327 1254.21,-327 1304.12,-327"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1304.17,-329.1 1310.17,-327 1304.17,-324.9 1304.17,-329.1"/>
</g>
<!-- 72. model.shopify.shopify__transactions_71&#45;&gt;79. model.shopify.shopify__customers__order_aggregates_78 -->
<g id="edge45" class="edge">
<title>72. model.shopify.shopify__transactions_71&#45;&gt;79. model.shopify.shopify__customers__order_aggregates_78</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1153.27,-336.13C1203.57,-341.81 1268.77,-349.18 1322.86,-355.29"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1322.87,-357.4 1329.07,-355.99 1323.34,-353.23 1322.87,-357.4"/>
</g>
<!-- 73. model.shopify.int_shopify__discounts__abandoned_checkouts_72&#45;&gt;87. model.shopify.shopify__discounts_86 -->
<g id="edge7" class="edge">
<title>73. model.shopify.int_shopify__discounts__abandoned_checkouts_72&#45;&gt;87. model.shopify.shopify__discounts_86</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1887,-100.71C1907.14,-102.18 1927.4,-103.67 1946.01,-105.03"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1946.12,-107.14 1952.26,-105.49 1946.43,-102.96 1946.12,-107.14"/>
</g>
<!-- 74. model.shopify.shopify__orders__order_line_aggregates_73&#45;&gt;78. model.shopify.int_shopify__emails__order_aggregates_77 -->
<g id="edge60" class="edge">
<title>74. model.shopify.shopify__orders__order_line_aggregates_73&#45;&gt;78. model.shopify.int_shopify__emails__order_aggregates_77</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1190.78,-446.96C1206.67,-442.94 1221.96,-436.61 1235,-427 1266.38,-403.87 1239.68,-370.22 1271,-347 1281.05,-339.55 1292.51,-334.13 1304.54,-330.25"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1305.35,-332.2 1310.49,-328.47 1304.14,-328.18 1305.35,-332.2"/>
</g>
<!-- 74. model.shopify.shopify__orders__order_line_aggregates_73&#45;&gt;79. model.shopify.shopify__customers__order_aggregates_78 -->
<g id="edge44" class="edge">
<title>74. model.shopify.shopify__orders__order_line_aggregates_73&#45;&gt;79. model.shopify.shopify__customers__order_aggregates_78</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1183.96,-436C1201.14,-433.52 1218.61,-430.55 1235,-427 1290.6,-414.97 1353.17,-393.88 1391.21,-380.18"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1392.17,-382.07 1397.09,-378.05 1390.74,-378.12 1392.17,-382.07"/>
</g>
<!-- 74. model.shopify.shopify__orders__order_line_aggregates_73&#45;&gt;81. model.shopify.shopify__orders_80 -->
<g id="edge9" class="edge">
<title>74. model.shopify.shopify__orders__order_line_aggregates_73&#45;&gt;81. model.shopify.shopify__orders_80</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1190.87,-447C1243.96,-447 1304.99,-447 1351.63,-447"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1351.82,-449.1 1357.82,-447 1351.82,-444.9 1351.82,-449.1"/>
</g>
<!-- 75. model.shopify.int_shopify__inventory_level__aggregates_74&#45;&gt;80. model.shopify.shopify__inventory_levels_79 -->
<g id="edge38" class="edge">
<title>75. model.shopify.int_shopify__inventory_level__aggregates_74&#45;&gt;80. model.shopify.shopify__inventory_levels_79</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1521.09,-692.02C1542.22,-696.24 1564.26,-702.04 1584,-710 1644.19,-734.28 1705.52,-781.56 1734.81,-805.83"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1733.61,-807.56 1739.56,-809.8 1736.31,-804.34 1733.61,-807.56"/>
</g>
<!-- 91. model.shopify.shopify__products_90 -->
<g id="node91" class="node">
<title>91. model.shopify.shopify__products_90</title>
<polygon fill="#ffffff" stroke="#000000" points="2102.5,-527 1954.5,-527 1954.5,-505 2102.5,-505 2102.5,-527"/>
<text text-anchor="middle" x="2028.5" y="-514.1" font-family="Segoe UI" font-size="8.00" fill="#000000">91. model.shopify.shopify__products</text>
</g>
<!-- 76. model.shopify.int_shopify__products_with_aggregates_75&#45;&gt;91. model.shopify.shopify__products_90 -->
<g id="edge16" class="edge">
<title>76. model.shopify.int_shopify__products_with_aggregates_75&#45;&gt;91. model.shopify.shopify__products_90</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1770.82,-949.83C1798.09,-930.47 1853.21,-888.19 1887,-841 1962.34,-735.8 2008.77,-583.87 2022.9,-533.18"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="2024.97,-533.59 2024.54,-527.25 2020.92,-532.47 2024.97,-533.59"/>
</g>
<!-- 85. model.shopify.int_shopify__daily_orders_84 -->
<g id="node85" class="node">
<title>85. model.shopify.int_shopify__daily_orders_84</title>
<polygon fill="#ffffff" stroke="#000000" points="1841.5,-478 1665.5,-478 1665.5,-456 1841.5,-456 1841.5,-478"/>
<text text-anchor="middle" x="1753.5" y="-465.1" font-family="Segoe UI" font-size="8.00" fill="#000000">85. model.shopify.int_shopify__daily_orders</text>
</g>
<!-- 77. model.shopify.shopify__order_lines_76&#45;&gt;85. model.shopify.int_shopify__daily_orders_84 -->
<g id="edge50" class="edge">
<title>77. model.shopify.shopify__order_lines_76&#45;&gt;85. model.shopify.int_shopify__daily_orders_84</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1506.11,-497.42C1552.07,-491.74 1610.6,-484.52 1659.08,-478.53"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1659.55,-480.59 1665.25,-477.77 1659.04,-476.42 1659.55,-480.59"/>
</g>
<!-- 86. model.shopify.int_shopify__product__order_line_aggregates_85 -->
<g id="node86" class="node">
<title>86. model.shopify.int_shopify__product__order_line_aggregates_85</title>
<polygon fill="#ffffff" stroke="#000000" points="1882,-518 1625,-518 1625,-496 1882,-496 1882,-518"/>
<text text-anchor="middle" x="1753.5" y="-505.1" font-family="Segoe UI" font-size="8.00" fill="#000000">86. model.shopify.int_shopify__product__order_line_aggregates</text>
</g>
<!-- 77. model.shopify.shopify__order_lines_76&#45;&gt;86. model.shopify.int_shopify__product__order_line_aggregates_85 -->
<g id="edge57" class="edge">
<title>77. model.shopify.shopify__order_lines_76&#45;&gt;86. model.shopify.int_shopify__product__order_line_aggregates_85</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1506.11,-507C1539.87,-507 1580.42,-507 1618.79,-507"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1618.92,-509.1 1624.92,-507 1618.92,-504.9 1618.92,-509.1"/>
</g>
<!-- 78. model.shopify.int_shopify__emails__order_aggregates_77&#45;&gt;83. model.shopify.shopify__customer_emails_82 -->
<g id="edge21" class="edge">
<title>78. model.shopify.int_shopify__emails__order_aggregates_77&#45;&gt;83. model.shopify.shopify__customer_emails_82</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1445.92,-315.89C1478.63,-295.57 1552.12,-252.54 1620,-231 1631.72,-227.28 1644.25,-224.25 1656.75,-221.77"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1657.38,-223.79 1662.88,-220.6 1656.6,-219.66 1657.38,-223.79"/>
</g>
<!-- 79. model.shopify.shopify__customers__order_aggregates_78&#45;&gt;82. model.shopify.shopify__customers_81 -->
<g id="edge31" class="edge">
<title>79. model.shopify.shopify__customers__order_aggregates_78&#45;&gt;82. model.shopify.shopify__customers_81</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1545.14,-365.1C1559.08,-361.19 1572.44,-355.4 1584,-347 1614.24,-325.04 1590,-293.29 1620,-271 1634.34,-260.34 1652.01,-254.28 1669.71,-251.01"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1670.14,-253.07 1675.71,-250.01 1669.45,-248.93 1670.14,-253.07"/>
</g>
<!-- 81. model.shopify.shopify__orders_80&#45;&gt;84. model.shopify.int_shopify__discounts__order_aggregates_83 -->
<g id="edge66" class="edge">
<title>81. model.shopify.shopify__orders_80&#45;&gt;84. model.shopify.int_shopify__discounts__order_aggregates_83</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1477.8,-435.96C1510.4,-426.84 1552.74,-411.37 1584,-387 1605.88,-369.94 1597.78,-352.61 1620,-336 1640.27,-320.85 1665.99,-310.58 1689.36,-303.72"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1690.04,-305.71 1695.24,-302.05 1688.9,-301.67 1690.04,-305.71"/>
</g>
<!-- 81. model.shopify.shopify__orders_80&#45;&gt;85. model.shopify.int_shopify__daily_orders_84 -->
<g id="edge49" class="edge">
<title>81. model.shopify.shopify__orders_80&#45;&gt;85. model.shopify.int_shopify__daily_orders_84</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1497.21,-451.24C1544.34,-454.15 1607.44,-458.05 1659.11,-461.24"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1659.24,-463.35 1665.35,-461.62 1659.5,-459.15 1659.24,-463.35"/>
</g>
<!-- 81. model.shopify.shopify__orders_80&#45;&gt;86. model.shopify.int_shopify__product__order_line_aggregates_85 -->
<g id="edge58" class="edge">
<title>81. model.shopify.shopify__orders_80&#45;&gt;86. model.shopify.int_shopify__product__order_line_aggregates_85</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1477.55,-458.04C1516.15,-466.53 1571.36,-478.26 1620,-487 1635.56,-489.8 1652.21,-492.52 1668.25,-495.01"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1668.36,-497.15 1674.61,-495.99 1669,-493 1668.36,-497.15"/>
</g>
<!-- 81. model.shopify.shopify__orders_80&#45;&gt;89. model.shopify.shopify__customer_cohorts_88 -->
<g id="edge3" class="edge">
<title>81. model.shopify.shopify__orders_80&#45;&gt;89. model.shopify.shopify__customer_cohorts_88</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1497.35,-442.41C1587.14,-436.17 1749.04,-424.04 1887,-409 1905.8,-406.95 1925.96,-404.42 1944.99,-401.88"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1945.72,-403.9 1951.39,-401.02 1945.16,-399.74 1945.72,-403.9"/>
</g>
<!-- 81. model.shopify.shopify__orders_80&#45;&gt;90. model.shopify.shopify__customer_email_cohorts_89 -->
<g id="edge29" class="edge">
<title>81. model.shopify.shopify__orders_80&#45;&gt;90. model.shopify.shopify__customer_email_cohorts_89</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1459.83,-435.91C1491.49,-424.47 1541.65,-405.71 1584,-387 1600.36,-379.77 1602.69,-373.51 1620,-369 1717.85,-343.48 1833.31,-340.52 1916.3,-342.89"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1916.66,-345 1922.72,-343.08 1916.79,-340.8 1916.66,-345"/>
</g>
<!-- 82. model.shopify.shopify__customers_81&#45;&gt;89. model.shopify.shopify__customer_cohorts_88 -->
<g id="edge2" class="edge">
<title>82. model.shopify.shopify__customers_81&#45;&gt;89. model.shopify.shopify__customer_cohorts_88</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1831.02,-248.88C1851.02,-251.76 1871.34,-258.18 1887,-271 1923.23,-300.65 1887.36,-339.64 1923,-370 1925.55,-372.17 1928.26,-374.13 1931.1,-375.91"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1930.09,-377.75 1936.34,-378.91 1932.17,-374.1 1930.09,-377.75"/>
</g>
<!-- 83. model.shopify.shopify__customer_emails_82&#45;&gt;90. model.shopify.shopify__customer_email_cohorts_89 -->
<g id="edge28" class="edge">
<title>83. model.shopify.shopify__customer_emails_82&#45;&gt;90. model.shopify.shopify__customer_email_cohorts_89</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1844.12,-217.63C1858.85,-220.65 1873.66,-224.94 1887,-231 1941.53,-255.76 1991.49,-308.01 2014.37,-334.25"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="2012.81,-335.67 2018.32,-338.84 2015.99,-332.92 2012.81,-335.67"/>
</g>
<!-- 84. model.shopify.int_shopify__discounts__order_aggregates_83&#45;&gt;87. model.shopify.shopify__discounts_86 -->
<g id="edge6" class="edge">
<title>84. model.shopify.int_shopify__discounts__order_aggregates_83&#45;&gt;87. model.shopify.shopify__discounts_86</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1866.64,-279.94C1873.71,-277.46 1880.57,-274.51 1887,-271 1950.48,-236.32 1999.01,-161.17 2018.35,-127.69"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="2020.27,-128.56 2021.41,-122.31 2016.62,-126.48 2020.27,-128.56"/>
</g>
<!-- 85. model.shopify.int_shopify__daily_orders_84&#45;&gt;88. model.shopify.shopify__daily_shop_87 -->
<g id="edge25" class="edge">
<title>85. model.shopify.int_shopify__daily_orders_84&#45;&gt;88. model.shopify.shopify__daily_shop_87</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1841.63,-464.13C1874.54,-463.04 1911.87,-461.81 1944.39,-460.74"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1944.48,-462.84 1950.41,-460.54 1944.34,-458.64 1944.48,-462.84"/>
</g>
<!-- 86. model.shopify.int_shopify__product__order_line_aggregates_85&#45;&gt;91. model.shopify.shopify__products_90 -->
<g id="edge17" class="edge">
<title>86. model.shopify.int_shopify__product__order_line_aggregates_85&#45;&gt;91. model.shopify.shopify__products_90</title>
<path fill="none" stroke="#000000" stroke-width="0.6" d="M1882.21,-511.21C1904.69,-511.95 1927.49,-512.7 1948.16,-513.38"/>
<polygon fill="#000000" stroke="#000000" stroke-width="0.6" points="1948.15,-515.49 1954.21,-513.58 1948.29,-511.29 1948.15,-515.49"/>
</g>
</g>
</svg>

        </div>
    </div>
    
        </div>
        
        <div class="collapse" id="model_summary_all_1Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">1. model.shopify.shopify__calendar</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_utils</span><span class="p">.</span><span class="n">date_spine</span><span class="p">(</span>
<span class="w">    </span><span class="n">datepart</span><span class="o">=</span><span class="ss">&quot;day&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">start_date</span><span class="o">=</span><span class="ss">&quot;cast(&#39;2019-01-01&#39; as date)&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">end_date</span><span class="o">=</span><span class="ss">&quot;current_date&quot;</span>
<span class="w">   </span><span class="p">)</span>
<span class="err">}}</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_2Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">2. model.shopify_source.stg_shopify__abandoned_checkout_discount_code_tmp</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="err">{{</span>
<span class="w">    </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">union_data</span><span class="p">(</span>
<span class="w">        </span><span class="n">table_identifier</span><span class="o">=</span><span class="s1">&#39;abandoned_checkout_discount_code&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_database&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_schema&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">default_database</span><span class="o">=</span><span class="n">target</span><span class="p">.</span><span class="k">database</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_schema</span><span class="o">=</span><span class="s1">&#39;shopify&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_variable</span><span class="o">=</span><span class="s1">&#39;abandoned_checkout_discount_code_source&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span>
<span class="w">    </span><span class="p">)</span>
<span class="err">}}</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_3Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">3. model.shopify_source.stg_shopify__abandoned_checkout_shipping_line_tmp</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="err">{{</span>
<span class="w">    </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">union_data</span><span class="p">(</span>
<span class="w">        </span><span class="n">table_identifier</span><span class="o">=</span><span class="s1">&#39;abandoned_checkout_shipping_line&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_database&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_schema&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">default_database</span><span class="o">=</span><span class="n">target</span><span class="p">.</span><span class="k">database</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_schema</span><span class="o">=</span><span class="s1">&#39;shopify&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_variable</span><span class="o">=</span><span class="s1">&#39;abandoned_checkout_shipping_line_source&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span>
<span class="w">    </span><span class="p">)</span>
<span class="err">}}</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_4Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">4. model.shopify_source.stg_shopify__abandoned_checkout_tmp</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="err">{{</span>
<span class="w">    </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">union_data</span><span class="p">(</span>
<span class="w">        </span><span class="n">table_identifier</span><span class="o">=</span><span class="s1">&#39;abandoned_checkout&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_database&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_schema&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">default_database</span><span class="o">=</span><span class="n">target</span><span class="p">.</span><span class="k">database</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_schema</span><span class="o">=</span><span class="s1">&#39;shopify&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_variable</span><span class="o">=</span><span class="s1">&#39;abandoned_checkout_source&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span>
<span class="w">    </span><span class="p">)</span>
<span class="err">}}</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_5Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">5. model.shopify_source.stg_shopify__collection_product_tmp</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="err">{{</span>
<span class="w">    </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">union_data</span><span class="p">(</span>
<span class="w">        </span><span class="n">table_identifier</span><span class="o">=</span><span class="s1">&#39;collection_product&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_database&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_schema&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">default_database</span><span class="o">=</span><span class="n">target</span><span class="p">.</span><span class="k">database</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_schema</span><span class="o">=</span><span class="s1">&#39;shopify&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_variable</span><span class="o">=</span><span class="s1">&#39;collection_product_source&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span>
<span class="w">    </span><span class="p">)</span>
<span class="err">}}</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_6Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">6. model.shopify_source.stg_shopify__collection_tmp</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="err">{{</span>
<span class="w">    </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">union_data</span><span class="p">(</span>
<span class="w">        </span><span class="n">table_identifier</span><span class="o">=</span><span class="s1">&#39;collection&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_database&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_schema&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">default_database</span><span class="o">=</span><span class="n">target</span><span class="p">.</span><span class="k">database</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_schema</span><span class="o">=</span><span class="s1">&#39;shopify&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_variable</span><span class="o">=</span><span class="s1">&#39;collection_source&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span>
<span class="w">    </span><span class="p">)</span>
<span class="err">}}</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_7Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">7. model.shopify_source.stg_shopify__customer_tag_tmp</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="err">{{</span>
<span class="w">    </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">union_data</span><span class="p">(</span>
<span class="w">        </span><span class="n">table_identifier</span><span class="o">=</span><span class="s1">&#39;customer_tag&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_database&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_schema&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">default_database</span><span class="o">=</span><span class="n">target</span><span class="p">.</span><span class="k">database</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_schema</span><span class="o">=</span><span class="s1">&#39;shopify&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_variable</span><span class="o">=</span><span class="s1">&#39;customer_tag_source&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span>
<span class="w">    </span><span class="p">)</span>
<span class="err">}}</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_8Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">8. model.shopify_source.stg_shopify__customer_tmp</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="err">{{</span>
<span class="w">    </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">union_data</span><span class="p">(</span>
<span class="w">        </span><span class="n">table_identifier</span><span class="o">=</span><span class="s1">&#39;customer&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_database&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_schema&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">default_database</span><span class="o">=</span><span class="n">target</span><span class="p">.</span><span class="k">database</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_schema</span><span class="o">=</span><span class="s1">&#39;shopify&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_variable</span><span class="o">=</span><span class="s1">&#39;customer_source&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span>
<span class="w">    </span><span class="p">)</span>
<span class="err">}}</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_9Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">9. model.shopify_source.stg_shopify__discount_code_tmp</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="c1">-- this model will be all NULL until you create a discount code in Shopify</span>

<span class="err">{{</span>
<span class="w">    </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">union_data</span><span class="p">(</span>
<span class="w">        </span><span class="n">table_identifier</span><span class="o">=</span><span class="s1">&#39;discount_code&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_database&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_schema&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">default_database</span><span class="o">=</span><span class="n">target</span><span class="p">.</span><span class="k">database</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_schema</span><span class="o">=</span><span class="s1">&#39;shopify&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_variable</span><span class="o">=</span><span class="s1">&#39;discount_code_source&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span>
<span class="w">    </span><span class="p">)</span>
<span class="err">}}</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_10Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">10. model.shopify_source.stg_shopify__fulfillment_tmp</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="err">{{</span>
<span class="w">    </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">union_data</span><span class="p">(</span>
<span class="w">        </span><span class="n">table_identifier</span><span class="o">=</span><span class="s1">&#39;fulfillment&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_database&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_schema&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">default_database</span><span class="o">=</span><span class="n">target</span><span class="p">.</span><span class="k">database</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_schema</span><span class="o">=</span><span class="s1">&#39;shopify&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_variable</span><span class="o">=</span><span class="s1">&#39;fulfillment_source&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span>
<span class="w">    </span><span class="p">)</span>
<span class="err">}}</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_11Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">11. model.shopify_source.stg_shopify__inventory_item_tmp</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="err">{{</span>
<span class="w">    </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">union_data</span><span class="p">(</span>
<span class="w">        </span><span class="n">table_identifier</span><span class="o">=</span><span class="s1">&#39;inventory_item&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_database&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_schema&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">default_database</span><span class="o">=</span><span class="n">target</span><span class="p">.</span><span class="k">database</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_schema</span><span class="o">=</span><span class="s1">&#39;shopify&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_variable</span><span class="o">=</span><span class="s1">&#39;inventory_item_source&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span>
<span class="w">    </span><span class="p">)</span>
<span class="err">}}</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_12Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">12. model.shopify_source.stg_shopify__inventory_level_tmp</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="err">{{</span>
<span class="w">    </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">union_data</span><span class="p">(</span>
<span class="w">        </span><span class="n">table_identifier</span><span class="o">=</span><span class="s1">&#39;inventory_level&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_database&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_schema&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">default_database</span><span class="o">=</span><span class="n">target</span><span class="p">.</span><span class="k">database</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_schema</span><span class="o">=</span><span class="s1">&#39;shopify&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_variable</span><span class="o">=</span><span class="s1">&#39;inventory_level_source&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span>
<span class="w">    </span><span class="p">)</span>
<span class="err">}}</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_13Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">13. model.shopify_source.stg_shopify__location_tmp</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="err">{{</span>
<span class="w">    </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">union_data</span><span class="p">(</span>
<span class="w">        </span><span class="n">table_identifier</span><span class="o">=</span><span class="s1">&#39;location&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_database&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_schema&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">default_database</span><span class="o">=</span><span class="n">target</span><span class="p">.</span><span class="k">database</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_schema</span><span class="o">=</span><span class="s1">&#39;shopify&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_variable</span><span class="o">=</span><span class="s1">&#39;location_source&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span>
<span class="w">    </span><span class="p">)</span>
<span class="err">}}</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_14Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">14. model.shopify_source.stg_shopify__metafield_tmp</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="err">{{</span>
<span class="w">    </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">union_data</span><span class="p">(</span>
<span class="w">        </span><span class="n">table_identifier</span><span class="o">=</span><span class="s1">&#39;metafield&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_database&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_schema&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">default_database</span><span class="o">=</span><span class="n">target</span><span class="p">.</span><span class="k">database</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_schema</span><span class="o">=</span><span class="s1">&#39;shopify&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_variable</span><span class="o">=</span><span class="s1">&#39;metafield_source&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span>
<span class="w">    </span><span class="p">)</span>
<span class="err">}}</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_15Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">15. model.shopify_source.stg_shopify__order_adjustment_tmp</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="c1">-- this model will be all NULL until you have made an order adjustment in Shopify</span>

<span class="err">{{</span>
<span class="w">    </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">union_data</span><span class="p">(</span>
<span class="w">        </span><span class="n">table_identifier</span><span class="o">=</span><span class="s1">&#39;order_adjustment&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_database&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_schema&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">default_database</span><span class="o">=</span><span class="n">target</span><span class="p">.</span><span class="k">database</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_schema</span><span class="o">=</span><span class="s1">&#39;shopify&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_variable</span><span class="o">=</span><span class="s1">&#39;order_adjustment_source&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span>
<span class="w">    </span><span class="p">)</span>
<span class="err">}}</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_16Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">16. model.shopify_source.stg_shopify__order_discount_code_tmp</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="err">{{</span>
<span class="w">    </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">union_data</span><span class="p">(</span>
<span class="w">        </span><span class="n">table_identifier</span><span class="o">=</span><span class="s1">&#39;order_discount_code&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_database&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_schema&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">default_database</span><span class="o">=</span><span class="n">target</span><span class="p">.</span><span class="k">database</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_schema</span><span class="o">=</span><span class="s1">&#39;shopify&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_variable</span><span class="o">=</span><span class="s1">&#39;order_discount_code_source&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span>
<span class="w">    </span><span class="p">)</span>
<span class="err">}}</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_17Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">17. model.shopify_source.stg_shopify__order_line_refund_tmp</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="c1">-- this model will be all NULL until you have made an order line refund in Shopify</span>

<span class="err">{{</span>
<span class="w">    </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">union_data</span><span class="p">(</span>
<span class="w">        </span><span class="n">table_identifier</span><span class="o">=</span><span class="s1">&#39;order_line_refund&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_database&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_schema&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">default_database</span><span class="o">=</span><span class="n">target</span><span class="p">.</span><span class="k">database</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_schema</span><span class="o">=</span><span class="s1">&#39;shopify&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_variable</span><span class="o">=</span><span class="s1">&#39;order_line_refund_source&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span>
<span class="w">    </span><span class="p">)</span>
<span class="err">}}</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_18Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">18. model.shopify_source.stg_shopify__order_line_tmp</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="err">{{</span>
<span class="w">    </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">union_data</span><span class="p">(</span>
<span class="w">        </span><span class="n">table_identifier</span><span class="o">=</span><span class="s1">&#39;order_line&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_database&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_schema&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">default_database</span><span class="o">=</span><span class="n">target</span><span class="p">.</span><span class="k">database</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_schema</span><span class="o">=</span><span class="s1">&#39;shopify&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_variable</span><span class="o">=</span><span class="s1">&#39;order_line_source&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span>
<span class="w">    </span><span class="p">)</span>
<span class="err">}}</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_19Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">19. model.shopify_source.stg_shopify__order_note_attribute_tmp</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="err">{{</span>
<span class="w">    </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">union_data</span><span class="p">(</span>
<span class="w">        </span><span class="n">table_identifier</span><span class="o">=</span><span class="s1">&#39;order_note_attribute&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_database&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_schema&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">default_database</span><span class="o">=</span><span class="n">target</span><span class="p">.</span><span class="k">database</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_schema</span><span class="o">=</span><span class="s1">&#39;shopify&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_variable</span><span class="o">=</span><span class="s1">&#39;order_note_attribute_source&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span>
<span class="w">    </span><span class="p">)</span>
<span class="err">}}</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_20Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">20. model.shopify_source.stg_shopify__order_shipping_line_tmp</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="err">{{</span>
<span class="w">    </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">union_data</span><span class="p">(</span>
<span class="w">        </span><span class="n">table_identifier</span><span class="o">=</span><span class="s1">&#39;order_shipping_line&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_database&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_schema&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">default_database</span><span class="o">=</span><span class="n">target</span><span class="p">.</span><span class="k">database</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_schema</span><span class="o">=</span><span class="s1">&#39;shopify&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_variable</span><span class="o">=</span><span class="s1">&#39;order_shipping_line_source&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span>
<span class="w">    </span><span class="p">)</span>
<span class="err">}}</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_21Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">21. model.shopify_source.stg_shopify__order_shipping_tax_line_tmp</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="err">{{</span>
<span class="w">    </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">union_data</span><span class="p">(</span>
<span class="w">        </span><span class="n">table_identifier</span><span class="o">=</span><span class="s1">&#39;order_shipping_tax_line&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_database&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_schema&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">default_database</span><span class="o">=</span><span class="n">target</span><span class="p">.</span><span class="k">database</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_schema</span><span class="o">=</span><span class="s1">&#39;shopify&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_variable</span><span class="o">=</span><span class="s1">&#39;order_shipping_tax_line_source&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span>
<span class="w">    </span><span class="p">)</span>
<span class="err">}}</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_22Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">22. model.shopify_source.stg_shopify__order_tag_tmp</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="err">{{</span>
<span class="w">    </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">union_data</span><span class="p">(</span>
<span class="w">        </span><span class="n">table_identifier</span><span class="o">=</span><span class="s1">&#39;order_tag&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_database&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_schema&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">default_database</span><span class="o">=</span><span class="n">target</span><span class="p">.</span><span class="k">database</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_schema</span><span class="o">=</span><span class="s1">&#39;shopify&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_variable</span><span class="o">=</span><span class="s1">&#39;order_tag_source&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span>
<span class="w">    </span><span class="p">)</span>
<span class="err">}}</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_23Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">23. model.shopify_source.stg_shopify__order_tmp</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="err">{{</span>
<span class="w">    </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">union_data</span><span class="p">(</span>
<span class="w">        </span><span class="n">table_identifier</span><span class="o">=</span><span class="s1">&#39;order&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_database&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_schema&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">default_database</span><span class="o">=</span><span class="n">target</span><span class="p">.</span><span class="k">database</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_schema</span><span class="o">=</span><span class="s1">&#39;shopify&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_variable</span><span class="o">=</span><span class="s1">&#39;order_source&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span>
<span class="w">    </span><span class="p">)</span>
<span class="err">}}</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_24Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">24. model.shopify_source.stg_shopify__order_url_tag_tmp</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="err">{{</span>
<span class="w">    </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">union_data</span><span class="p">(</span>
<span class="w">        </span><span class="n">table_identifier</span><span class="o">=</span><span class="s1">&#39;order_url_tag&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_database&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_schema&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">default_database</span><span class="o">=</span><span class="n">target</span><span class="p">.</span><span class="k">database</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_schema</span><span class="o">=</span><span class="s1">&#39;shopify&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_variable</span><span class="o">=</span><span class="s1">&#39;order_url_tag_source&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span>
<span class="w">    </span><span class="p">)</span>
<span class="err">}}</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_25Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">25. model.shopify_source.stg_shopify__price_rule_tmp</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="err">{{</span>
<span class="w">    </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">union_data</span><span class="p">(</span>
<span class="w">        </span><span class="n">table_identifier</span><span class="o">=</span><span class="s1">&#39;price_rule&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_database&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_schema&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">default_database</span><span class="o">=</span><span class="n">target</span><span class="p">.</span><span class="k">database</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_schema</span><span class="o">=</span><span class="s1">&#39;shopify&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_variable</span><span class="o">=</span><span class="s1">&#39;price_rule_source&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span>
<span class="w">    </span><span class="p">)</span>
<span class="err">}}</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_26Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">26. model.shopify_source.stg_shopify__product_image_tmp</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="err">{{</span>
<span class="w">    </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">union_data</span><span class="p">(</span>
<span class="w">        </span><span class="n">table_identifier</span><span class="o">=</span><span class="s1">&#39;product_image&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_database&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_schema&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">default_database</span><span class="o">=</span><span class="n">target</span><span class="p">.</span><span class="k">database</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_schema</span><span class="o">=</span><span class="s1">&#39;shopify&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_variable</span><span class="o">=</span><span class="s1">&#39;product_image_source&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span>
<span class="w">    </span><span class="p">)</span>
<span class="err">}}</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_27Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">27. model.shopify_source.stg_shopify__product_tag_tmp</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="err">{{</span>
<span class="w">    </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">union_data</span><span class="p">(</span>
<span class="w">        </span><span class="n">table_identifier</span><span class="o">=</span><span class="s1">&#39;product_tag&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_database&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_schema&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">default_database</span><span class="o">=</span><span class="n">target</span><span class="p">.</span><span class="k">database</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_schema</span><span class="o">=</span><span class="s1">&#39;shopify&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_variable</span><span class="o">=</span><span class="s1">&#39;product_tag_source&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span>
<span class="w">    </span><span class="p">)</span>
<span class="err">}}</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_28Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">28. model.shopify_source.stg_shopify__product_tmp</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="err">{{</span>
<span class="w">    </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">union_data</span><span class="p">(</span>
<span class="w">        </span><span class="n">table_identifier</span><span class="o">=</span><span class="s1">&#39;product&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_database&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_schema&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">default_database</span><span class="o">=</span><span class="n">target</span><span class="p">.</span><span class="k">database</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_schema</span><span class="o">=</span><span class="s1">&#39;shopify&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_variable</span><span class="o">=</span><span class="s1">&#39;product_source&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span>
<span class="w">    </span><span class="p">)</span>
<span class="err">}}</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_29Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">29. model.shopify_source.stg_shopify__product_variant_tmp</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="err">{{</span>
<span class="w">    </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">union_data</span><span class="p">(</span>
<span class="w">        </span><span class="n">table_identifier</span><span class="o">=</span><span class="s1">&#39;product_variant&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_database&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_schema&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">default_database</span><span class="o">=</span><span class="n">target</span><span class="p">.</span><span class="k">database</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_schema</span><span class="o">=</span><span class="s1">&#39;shopify&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_variable</span><span class="o">=</span><span class="s1">&#39;product_variant_source&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span>
<span class="w">    </span><span class="p">)</span>
<span class="err">}}</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_30Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">30. model.shopify_source.stg_shopify__refund_tmp</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="c1">-- this model will be all NULL until you create a refund in Shopify</span>

<span class="err">{{</span>
<span class="w">    </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">union_data</span><span class="p">(</span>
<span class="w">        </span><span class="n">table_identifier</span><span class="o">=</span><span class="s1">&#39;refund&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_database&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_schema&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">default_database</span><span class="o">=</span><span class="n">target</span><span class="p">.</span><span class="k">database</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_schema</span><span class="o">=</span><span class="s1">&#39;shopify&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_variable</span><span class="o">=</span><span class="s1">&#39;refund_source&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span>
<span class="w">    </span><span class="p">)</span>
<span class="err">}}</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_31Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">31. model.shopify_source.stg_shopify__shop_tmp</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="err">{{</span>
<span class="w">    </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">union_data</span><span class="p">(</span>
<span class="w">        </span><span class="n">table_identifier</span><span class="o">=</span><span class="s1">&#39;shop&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_database&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_schema&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">default_database</span><span class="o">=</span><span class="n">target</span><span class="p">.</span><span class="k">database</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_schema</span><span class="o">=</span><span class="s1">&#39;shopify&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_variable</span><span class="o">=</span><span class="s1">&#39;shop_source&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span>
<span class="w">    </span><span class="p">)</span>
<span class="err">}}</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_32Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">32. model.shopify_source.stg_shopify__tax_line_tmp</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="err">{{</span>
<span class="w">    </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">union_data</span><span class="p">(</span>
<span class="w">        </span><span class="n">table_identifier</span><span class="o">=</span><span class="s1">&#39;tax_line&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_database&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_schema&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">default_database</span><span class="o">=</span><span class="n">target</span><span class="p">.</span><span class="k">database</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_schema</span><span class="o">=</span><span class="s1">&#39;shopify&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_variable</span><span class="o">=</span><span class="s1">&#39;tax_line_source&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span>
<span class="w">    </span><span class="p">)</span>
<span class="err">}}</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_33Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">33. model.shopify_source.stg_shopify__tender_transaction_tmp</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="err">{{</span>
<span class="w">    </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">union_data</span><span class="p">(</span>
<span class="w">        </span><span class="n">table_identifier</span><span class="o">=</span><span class="s1">&#39;tender_transaction&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_database&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_schema&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">default_database</span><span class="o">=</span><span class="n">target</span><span class="p">.</span><span class="k">database</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_schema</span><span class="o">=</span><span class="s1">&#39;shopify&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_variable</span><span class="o">=</span><span class="s1">&#39;tender_transaction_source&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span>
<span class="w">    </span><span class="p">)</span>
<span class="err">}}</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_34Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">34. model.shopify_source.stg_shopify__transaction_tmp</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="err">{{</span>
<span class="w">    </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">union_data</span><span class="p">(</span>
<span class="w">        </span><span class="n">table_identifier</span><span class="o">=</span><span class="s1">&#39;transaction&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_database&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_schema&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">default_database</span><span class="o">=</span><span class="n">target</span><span class="p">.</span><span class="k">database</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_schema</span><span class="o">=</span><span class="s1">&#39;shopify&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_variable</span><span class="o">=</span><span class="s1">&#39;transaction_source&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span>
<span class="w">    </span><span class="p">)</span>
<span class="err">}}</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_35Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">35. model.shopify_source.stg_shopify__abandoned_checkout</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    A checkout is considered abandoned after the customer has added contact information, but before the customer has completed their purchase.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__abandoned_checkout_tmp&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">fields</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="err">{{</span>
<span class="w">            </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">fill_staging_columns</span><span class="p">(</span>
<span class="w">                </span><span class="n">source_columns</span><span class="o">=</span><span class="n">adapter</span><span class="p">.</span><span class="n">get_columns_in_relation</span><span class="p">(</span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__abandoned_checkout_tmp&#39;</span><span class="p">)),</span>
<span class="w">                </span><span class="n">staging_columns</span><span class="o">=</span><span class="n">get_abandoned_checkout_columns</span><span class="p">()</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">source_relation</span><span class="p">(</span>
<span class="w">            </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">base</span>
<span class="p">),</span>

<span class="k">final</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">_fivetran_deleted</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">is_deleted</span><span class="p">,</span>
<span class="w">        </span><span class="n">abandoned_checkout_url</span><span class="p">,</span>
<span class="w">        </span><span class="n">billing_address_address_1</span><span class="p">,</span>
<span class="w">        </span><span class="n">billing_address_address_2</span><span class="p">,</span>
<span class="w">        </span><span class="n">billing_address_city</span><span class="p">,</span>
<span class="w">        </span><span class="n">billing_address_company</span><span class="p">,</span>
<span class="w">        </span><span class="n">billing_address_country</span><span class="p">,</span>
<span class="w">        </span><span class="n">billing_address_country_code</span><span class="p">,</span>
<span class="w">        </span><span class="n">billing_address_first_name</span><span class="p">,</span>
<span class="w">        </span><span class="n">billing_address_last_name</span><span class="p">,</span>
<span class="w">        </span><span class="n">billing_address_latitude</span><span class="p">,</span>
<span class="w">        </span><span class="n">billing_address_longitude</span><span class="p">,</span>
<span class="w">        </span><span class="n">billing_address_name</span><span class="p">,</span>
<span class="w">        </span><span class="n">billing_address_phone</span><span class="p">,</span>
<span class="w">        </span><span class="n">billing_address_province</span><span class="p">,</span>
<span class="w">        </span><span class="n">billing_address_province_code</span><span class="p">,</span>
<span class="w">        </span><span class="n">billing_address_zip</span><span class="p">,</span>
<span class="w">        </span><span class="n">buyer_accepts_marketing</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">has_buyer_accepted_marketing</span><span class="p">,</span>
<span class="w">        </span><span class="n">cart_token</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(created_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">created_at</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(closed_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">closed_at</span><span class="p">,</span>
<span class="w">        </span><span class="n">currency</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">shop_currency</span><span class="p">,</span>
<span class="w">        </span><span class="n">customer_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">customer_locale</span><span class="p">,</span>
<span class="w">        </span><span class="n">device_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">email</span><span class="p">,</span>
<span class="w">        </span><span class="n">gateway</span><span class="p">,</span>
<span class="w">        </span><span class="n">id</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">checkout_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">landing_site_base_url</span><span class="p">,</span>
<span class="w">        </span><span class="n">location_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">name</span><span class="p">,</span>
<span class="w">        </span><span class="n">note</span><span class="p">,</span>
<span class="w">        </span><span class="n">phone</span><span class="p">,</span>
<span class="w">        </span><span class="n">presentment_currency</span><span class="p">,</span>
<span class="w">        </span><span class="n">referring_site</span><span class="p">,</span>
<span class="w">        </span><span class="n">shipping_address_address_1</span><span class="p">,</span>
<span class="w">        </span><span class="n">shipping_address_address_2</span><span class="p">,</span>
<span class="w">        </span><span class="n">shipping_address_city</span><span class="p">,</span>
<span class="w">        </span><span class="n">shipping_address_company</span><span class="p">,</span>
<span class="w">        </span><span class="n">shipping_address_country</span><span class="p">,</span>
<span class="w">        </span><span class="n">shipping_address_country_code</span><span class="p">,</span>
<span class="w">        </span><span class="n">shipping_address_first_name</span><span class="p">,</span>
<span class="w">        </span><span class="n">shipping_address_last_name</span><span class="p">,</span>
<span class="w">        </span><span class="n">shipping_address_latitude</span><span class="p">,</span>
<span class="w">        </span><span class="n">shipping_address_longitude</span><span class="p">,</span>
<span class="w">        </span><span class="n">shipping_address_name</span><span class="p">,</span>
<span class="w">        </span><span class="n">shipping_address_phone</span><span class="p">,</span>
<span class="w">        </span><span class="n">shipping_address_province</span><span class="p">,</span>
<span class="w">        </span><span class="n">shipping_address_province_code</span><span class="p">,</span>
<span class="w">        </span><span class="n">shipping_address_zip</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_name</span><span class="p">,</span>
<span class="w">        </span><span class="n">subtotal_price</span><span class="p">,</span>
<span class="w">        </span><span class="n">taxes_included</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">has_taxes_included</span><span class="p">,</span>
<span class="w">        </span><span class="n">token</span><span class="p">,</span>
<span class="w">        </span><span class="n">total_discounts</span><span class="p">,</span>
<span class="w">        </span><span class="n">total_duties</span><span class="p">,</span>
<span class="w">        </span><span class="n">total_line_items_price</span><span class="p">,</span>
<span class="w">        </span><span class="n">total_price</span><span class="p">,</span>
<span class="w">        </span><span class="n">total_tax</span><span class="p">,</span>
<span class="w">        </span><span class="n">total_weight</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(updated_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">updated_at</span><span class="p">,</span>
<span class="w">        </span><span class="n">user_id</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(_fivetran_synced as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">_fivetran_synced</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span>
<span class="w">        </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">fields</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="k">final</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>is_deleted</td>
  <td>Boolean representing whether the record was soft-deleted in Shopify.</td>
</tr>
<tr>
  <td>_fivetran_synced</td>
  <td>The time when a record was last updated by Fivetran.</td>
</tr>
<tr>
  <td>abandoned_checkout_url</td>
  <td>The recovery URL that's sent to a customer so they can recover their checkout.</td>
</tr>
<tr>
  <td>billing_address_address_1</td>
  <td>The street address of the billing address.</td>
</tr>
<tr>
  <td>billing_address_address_2</td>
  <td>An optional additional field for the street address of the billing address.</td>
</tr>
<tr>
  <td>billing_address_city</td>
  <td>The city of the billing address.</td>
</tr>
<tr>
  <td>billing_address_company</td>
  <td>The company of the person associated with the billing address.</td>
</tr>
<tr>
  <td>billing_address_country</td>
  <td>The name of the country of the billing address.</td>
</tr>
<tr>
  <td>billing_address_country_code</td>
  <td>The two-letter code (ISO 3166-1 alpha-2 format) for the country of the billing address.</td>
</tr>
<tr>
  <td>billing_address_first_name</td>
  <td>The first name of the person associated with the payment method.</td>
</tr>
<tr>
  <td>billing_address_last_name</td>
  <td>The last name of the person associated with the payment method.</td>
</tr>
<tr>
  <td>billing_address_latitude</td>
  <td>The latitude of the billing address.</td>
</tr>
<tr>
  <td>billing_address_longitude</td>
  <td>The longitude of the billing address.</td>
</tr>
<tr>
  <td>billing_address_name</td>
  <td>The full name of the person associated with the payment method.</td>
</tr>
<tr>
  <td>billing_address_phone</td>
  <td>The phone number at the billing address.</td>
</tr>
<tr>
  <td>billing_address_province</td>
  <td>The name of the state or province of the billing address.</td>
</tr>
<tr>
  <td>billing_address_province_code</td>
  <td>The two-letter abbreviation of the state or province of the billing address.</td>
</tr>
<tr>
  <td>billing_address_zip</td>
  <td>The zip or postal code of the billing address.</td>
</tr>
<tr>
  <td>has_buyer_accepted_marketing</td>
  <td>Whether the customer would like to receive email updates from the shop. This is set by the 'I want to receive occasional emails about new products, promotions and other news' checkbox during checkout.</td>
</tr>
<tr>
  <td>cart_token</td>
  <td>The ID for the cart that's attached to the checkout.</td>
</tr>
<tr>
  <td>closed_at</td>
  <td>The date and time (ISO 8601 format) when the checkout was closed. If the checkout was not closed, then this value is null.</td>
</tr>
<tr>
  <td>created_at</td>
  <td>The date and time (ISO 8601 format) when the checkout was created.</td>
</tr>
<tr>
  <td>shop_currency</td>
  <td>The three-letter code (ISO 4217 format) of the shop's default currency at the time of checkout. For the currency that the customer used at checkout, see `presentment_currency`.</td>
</tr>
<tr>
  <td>customer_id</td>
  <td>ID of the customer with the abandoned checkout.</td>
</tr>
<tr>
  <td>customer_locale</td>
  <td>The two or three-letter language code, optionally followed by a region modifier. Example values - en, en-CA.</td>
</tr>
<tr>
  <td>device_id</td>
  <td>The ID of the Shopify POS device that created the checkout.</td>
</tr>
<tr>
  <td>email</td>
  <td>The customer's email address.</td>
</tr>
<tr>
  <td>gateway</td>
  <td>The payment gateway used by the checkout.</td>
</tr>
<tr>
  <td>checkout_id</td>
  <td>The ID for the checkout.</td>
</tr>
<tr>
  <td>landing_site_base_url</td>
  <td>The URL for the page where the customer entered the shop.</td>
</tr>
<tr>
  <td>location_id</td>
  <td>The ID of the physical location where the checkout was processed.</td>
</tr>
<tr>
  <td>name</td>
  <td>Checkout order number.</td>
</tr>
<tr>
  <td>note</td>
  <td>The text of an optional note that a shop owner can attach to the order.</td>
</tr>
<tr>
  <td>phone</td>
  <td>The customer's phone number for receiving SMS notifications.</td>
</tr>
<tr>
  <td>presentment_currency</td>
  <td>The three-letter code (ISO 4217 format) of the currency that the customer used at checkout. For the shop's default currency, see `currency`.</td>
</tr>
<tr>
  <td>referring_site</td>
  <td>The website that referred the customer to the shop.</td>
</tr>
<tr>
  <td>shipping_address_address_1</td>
  <td>The street address of the shipping address.</td>
</tr>
<tr>
  <td>shipping_address_address_2</td>
  <td>An optional additional field for the street address of the shipping address.</td>
</tr>
<tr>
  <td>shipping_address_city</td>
  <td>The city of the shipping address.</td>
</tr>
<tr>
  <td>shipping_address_company</td>
  <td>The company of the person associated with the shipping address.</td>
</tr>
<tr>
  <td>shipping_address_country</td>
  <td>The name of the country of the shipping address.</td>
</tr>
<tr>
  <td>shipping_address_country_code</td>
  <td>The two-letter code (ISO 3166-1 alpha-2 format) for the country of the shipping address.</td>
</tr>
<tr>
  <td>shipping_address_first_name</td>
  <td>The first name of the person associated with the shipping address.</td>
</tr>
<tr>
  <td>shipping_address_last_name</td>
  <td>The last name of the person associated with the shipping address.</td>
</tr>
<tr>
  <td>shipping_address_latitude</td>
  <td>The latitude of the shipping address.</td>
</tr>
<tr>
  <td>shipping_address_longitude</td>
  <td>The longitude of the shipping address.</td>
</tr>
<tr>
  <td>shipping_address_name</td>
  <td>The full name of the person associated with the shipping address.</td>
</tr>
<tr>
  <td>shipping_address_phone</td>
  <td>The phone number at the shipping address.</td>
</tr>
<tr>
  <td>shipping_address_province</td>
  <td>The name of the state or province of the shipping address.</td>
</tr>
<tr>
  <td>shipping_address_province_code</td>
  <td>The two-letter abbreviation of the state or province of the shipping address.</td>
</tr>
<tr>
  <td>shipping_address_zip</td>
  <td>The zip or postal code of the shipping address.</td>
</tr>
<tr>
  <td>source_name</td>
  <td>Where the checkout originated. Valid values include `web`, `pos`, `iphone`, `android`.</td>
</tr>
<tr>
  <td>subtotal_price</td>
  <td>The price of the checkout in _presentment_ (customer) currency before shipping and taxes.</td>
</tr>
<tr>
  <td>has_taxes_included</td>
  <td>Boolean representing whether taxes are included in the price.</td>
</tr>
<tr>
  <td>token</td>
  <td>A unique ID for a checkout.</td>
</tr>
<tr>
  <td>total_discounts</td>
  <td>The total amount of discounts to be applied in presentment currency.</td>
</tr>
<tr>
  <td>total_duties</td>
  <td>The total duties of the checkout in presentment currency.</td>
</tr>
<tr>
  <td>total_line_items_price</td>
  <td>The sum of the prices of all line items in the checkout in _presentment_ (customer) currency.</td>
</tr>
<tr>
  <td>total_price</td>
  <td>The sum of line item prices, all discounts, shipping costs, and taxes for the checkout in _presentment_ (customer) currency.</td>
</tr>
<tr>
  <td>total_tax</td>
  <td>The sum of all the taxes applied to the checkout in _presentment_ (customer) currency.</td>
</tr>
<tr>
  <td>total_weight</td>
  <td>The sum of all the weights in grams of the line items in the checkout.</td>
</tr>
<tr>
  <td>updated_at</td>
  <td>The date and time (ISO 8601 format) when the checkout was last modified.</td>
</tr>
<tr>
  <td>user_id</td>
  <td>The ID of the user who created the checkout.</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The schema or database this record came from if you are making use of the `shopify_union_schemas` or `shopify_union_databases` variables, respectively. Empty string if you are not using either of these variables to union together multiple Shopify connectors.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_36Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">36. model.shopify_source.stg_shopify__abandoned_checkout_discount_code</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    Abandoned checkouts that applied a discount code.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__abandoned_checkout_discount_code_tmp&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">fields</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="err">{{</span>
<span class="w">            </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">fill_staging_columns</span><span class="p">(</span>
<span class="w">                </span><span class="n">source_columns</span><span class="o">=</span><span class="n">adapter</span><span class="p">.</span><span class="n">get_columns_in_relation</span><span class="p">(</span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__abandoned_checkout_discount_code_tmp&#39;</span><span class="p">)),</span>
<span class="w">                </span><span class="n">staging_columns</span><span class="o">=</span><span class="n">get_abandoned_checkout_discount_code_columns</span><span class="p">()</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">source_relation</span><span class="p">(</span>
<span class="w">            </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">base</span>
<span class="p">),</span>

<span class="k">final</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">checkout_id</span><span class="p">,</span>
<span class="w">        </span><span class="k">upper</span><span class="p">(</span><span class="n">code</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">code</span><span class="p">,</span>
<span class="w">        </span><span class="n">discount_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">amount</span><span class="p">,</span>
<span class="w">        </span><span class="k">type</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(created_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">created_at</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(updated_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">updated_at</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(_fivetran_synced as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">_fivetran_synced</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="n">checkout_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">null</span>
<span class="w">            </span><span class="k">then</span><span class="w"> </span><span class="n">row_number</span><span class="p">()</span><span class="w"> </span><span class="n">over</span><span class="p">(</span><span class="n">partition</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">source_relation</span><span class="w"> </span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">source_relation</span><span class="p">)</span>
<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="n">row_number</span><span class="p">()</span><span class="w"> </span><span class="n">over</span><span class="p">(</span><span class="n">partition</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">checkout_id</span><span class="p">,</span><span class="w"> </span><span class="k">upper</span><span class="p">(</span><span class="n">code</span><span class="p">),</span><span class="w"> </span><span class="n">source_relation</span><span class="w"> </span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="k">desc</span><span class="p">)</span>
<span class="w">        </span><span class="k">end</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="k">index</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">fields</span>
<span class="w">    </span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="k">final</span>
<span class="k">where</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>_fivetran_synced</td>
  <td>The time when a record was last updated by Fivetran.</td>
</tr>
<tr>
  <td>amount</td>
  <td>The amount of the discount in presentment currency.</td>
</tr>
<tr>
  <td>checkout_id</td>
  <td>ID of the checkout.</td>
</tr>
<tr>
  <td>code</td>
  <td>The discount code.</td>
</tr>
<tr>
  <td>created_at</td>
  <td>When the checkout discount application was created.</td>
</tr>
<tr>
  <td>discount_id</td>
  <td>ID of the discount. Deprecated, use `code` instead.</td>
</tr>
<tr>
  <td>type</td>
  <td>The type of discount. Valid values - percentage, shipping, fixed_amount. (default - fixed_amount)</td>
</tr>
<tr>
  <td>updated_at</td>
  <td>When the checkout's discount was last updated</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The schema or database this record came from if you are making use of the `shopify_union_schemas` or `shopify_union_databases` variables, respectively. Empty string if you are not using either of these variables to union together multiple Shopify connectors.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_37Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">37. model.shopify_source.stg_shopify__abandoned_checkout_shipping_line</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    Shipping lines associated with abandoned checkouts.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__abandoned_checkout_shipping_line_tmp&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">fields</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="err">{{</span>
<span class="w">            </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">fill_staging_columns</span><span class="p">(</span>
<span class="w">                </span><span class="n">source_columns</span><span class="o">=</span><span class="n">adapter</span><span class="p">.</span><span class="n">get_columns_in_relation</span><span class="p">(</span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__abandoned_checkout_shipping_line_tmp&#39;</span><span class="p">)),</span>
<span class="w">                </span><span class="n">staging_columns</span><span class="o">=</span><span class="n">get_abandoned_checkout_shipping_line_columns</span><span class="p">()</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">source_relation</span><span class="p">(</span>
<span class="w">            </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="err">}}</span>
<span class="w">        </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">base</span>
<span class="p">),</span>

<span class="k">final</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">id</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">abandoned_checkout_shipping_line_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">checkout_id</span><span class="p">,</span>
<span class="w">        </span><span class="k">index</span><span class="p">,</span>
<span class="w">        </span><span class="n">carrier_identifier</span><span class="p">,</span>
<span class="w">        </span><span class="n">code</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">shipping_code</span><span class="p">,</span>
<span class="w">        </span><span class="n">delivery_category</span><span class="p">,</span>
<span class="w">        </span><span class="n">delivery_expectation_range</span><span class="p">,</span>
<span class="w">        </span><span class="n">delivery_expectation_range_max</span><span class="p">,</span>
<span class="w">        </span><span class="n">delivery_expectation_range_min</span><span class="p">,</span>
<span class="w">        </span><span class="n">delivery_expectation_type</span><span class="p">,</span>
<span class="w">        </span><span class="n">discounted_price</span><span class="p">,</span>
<span class="w">        </span><span class="n">phone</span><span class="p">,</span>
<span class="w">        </span><span class="n">price</span><span class="p">,</span>
<span class="w">        </span><span class="n">requested_fulfillment_service_id</span><span class="p">,</span>
<span class="w">        </span><span class="k">source</span><span class="p">,</span>
<span class="w">        </span><span class="n">title</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(_fivetran_synced as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">_fivetran_synced</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">fields</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="k">final</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>_fivetran_synced</td>
  <td>The time when a record was last updated by Fivetran.</td>
</tr>
<tr>
  <td>carrier_identifier</td>
  <td>A reference to the carrier service that provided the rate. Present when the rate was computed by a third-party carrier service.</td>
</tr>
<tr>
  <td>checkout_id</td>
  <td>ID of the checkout that was abandoned.</td>
</tr>
<tr>
  <td>shipping_code</td>
  <td>A reference to the shipping method.</td>
</tr>
<tr>
  <td>delivery_category</td>
  <td>The general classification of the delivery method.</td>
</tr>
<tr>
  <td>delivery_expectation_range</td>
  <td>Expected delivery date range.</td>
</tr>
<tr>
  <td>delivery_expectation_range_max</td>
  <td>Latest expected delivery date.</td>
</tr>
<tr>
  <td>delivery_expectation_range_min</td>
  <td>Earliest possible expected delivery date.</td>
</tr>
<tr>
  <td>delivery_expectation_type</td>
  <td>Type of expected delivery.</td>
</tr>
<tr>
  <td>discounted_price</td>
  <td>The pre-tax shipping price with discounts applied in _presentment_ (customer) currency.</td>
</tr>
<tr>
  <td>abandoned_checkout_shipping_line_id</td>
  <td>Unique ID of the abandoned checkout shipping line.</td>
</tr>
<tr>
  <td>index</td>
  <td>Index of the line amongst shipping lines for this checkout.</td>
</tr>
<tr>
  <td>phone</td>
  <td>The phone number at the shipping address.</td>
</tr>
<tr>
  <td>price</td>
  <td>The price of the shipping method in presentment currency.</td>
</tr>
<tr>
  <td>requested_fulfillment_service_id</td>
  <td>The fulfillment service requested for the shipping method. Present if the shipping method requires processing by a third party fulfillment service.</td>
</tr>
<tr>
  <td>source</td>
  <td>The channel where the checkout originated. Example value - shopify.</td>
</tr>
<tr>
  <td>title</td>
  <td>The title of the shipping method. Example value - International Shipping.</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The schema or database this record came from if you are making use of the `shopify_union_schemas` or `shopify_union_databases` variables, respectively. Empty string if you are not using either of these variables to union together multiple Shopify connectors.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_38Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">38. model.shopify_source.stg_shopify__collection</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    A collection is a grouping of products that merchants can create to make their stores easier to browse. Merchants can create collections by selecting products individually or by defining rules that automatically determine whether products are included (aka a "smart collection").
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__collection_tmp&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">fields</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="err">{{</span>
<span class="w">            </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">fill_staging_columns</span><span class="p">(</span>
<span class="w">                </span><span class="n">source_columns</span><span class="o">=</span><span class="n">adapter</span><span class="p">.</span><span class="n">get_columns_in_relation</span><span class="p">(</span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__collection_tmp&#39;</span><span class="p">)),</span>
<span class="w">                </span><span class="n">staging_columns</span><span class="o">=</span><span class="n">get_collection_columns</span><span class="p">()</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">source_relation</span><span class="p">(</span>
<span class="w">            </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">base</span>
<span class="p">),</span>

<span class="k">final</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">id</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">collection_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">_fivetran_deleted</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">is_deleted</span><span class="p">,</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span>
<span class="w">            </span><span class="k">when</span><span class="w"> </span><span class="n">disjunctive</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">null</span>
<span class="w">            </span><span class="k">when</span><span class="w"> </span><span class="n">disjunctive</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="s1">&#39;disjunctive&#39;</span>
<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;conjunctive&#39;</span><span class="w"> </span><span class="k">end</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">rule_logic</span><span class="p">,</span>
<span class="w">        </span><span class="n">handle</span><span class="p">,</span>
<span class="w">        </span><span class="n">published_scope</span><span class="p">,</span>
<span class="w">        </span><span class="n">rules</span><span class="p">,</span>
<span class="w">        </span><span class="n">sort_order</span><span class="p">,</span>
<span class="w">        </span><span class="n">title</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(published_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">published_at</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(updated_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">updated_at</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(_fivetran_synced as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">_fivetran_synced</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">fields</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="k">final</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>is_deleted</td>
  <td>Boolean representing whether the record was soft-deleted in Shopify.</td>
</tr>
<tr>
  <td>_fivetran_synced</td>
  <td>The time when a record was last updated by Fivetran.</td>
</tr>
<tr>
  <td>rule_logic</td>
  <td>Whether the `rules` are disjunctive (logical `OR`) or conjunctive (logical `AND`)</td>
</tr>
<tr>
  <td>handle</td>
  <td>A unique, human-readable string for the collection automatically generated from its title. This is used in themes by the Liquid templating language to refer to the collection.</td>
</tr>
<tr>
  <td>collection_id</td>
  <td>The ID for the collection.</td>
</tr>
<tr>
  <td>published_at</td>
  <td>The time and date (ISO 8601 format) when the collection was made visible. Returns null for a hidden collection.</td>
</tr>
<tr>
  <td>published_scope</td>
  <td>Whether the collection is published to the Point of Sale channel. Valid values `web` (the collection is published to the Online Store channel but not published to the Point of Sale channel) and `global` (the collection is published to both the Online Store channel and the Point of Sale channel).\n</td>
</tr>
<tr>
  <td>rules</td>
  <td>An array of rules that define what products go into the smart collection. Each rule (`column` -- `relation` --&gt; `condition`) has these properties: - `column`: the property of a product being used to populate the smart collection. Ex: 'tag', 'type', 'vendor', 'variant_price', etc. - `relation`: The comparative relationship between the column choice, and the condition ('equals', 'contains', 'greater_than', etc.) - condition: Select products for a smart collection using a condition. Values are either strings or numbers, depending on the relation value. See the [Shopify docs](https://shopify.dev/api/admin-rest/2022-10/resources/smartcollection#resource-object) for more.\n</td>
</tr>
<tr>
  <td>sort_order</td>
  <td>The order of the products in the collection. Valid values incline - `alpha-asc`: The products are sorted alphabetically from A to Z. - `alpha-des`: The products are sorted alphabetically from Z to A. - `best-selling`: The products are sorted by number of sales. - `created`: The products are sorted by the date they were created, from oldest to newest. - `created-desc`: The products are sorted by the date they were created, from newest to oldest. - `manual`: The products are manually sorted by the shop owner. - `price-asc`: The products are sorted by price from lowest to highest. - `price-desc`: The products are sorted by price from highest to lowest.\n</td>
</tr>
<tr>
  <td>title</td>
  <td>The name of the collection</td>
</tr>
<tr>
  <td>updated_at</td>
  <td>The date and time (ISO 8601 format) when the collection was last modified.</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The schema or database this record came from if you are making use of the `shopify_union_schemas` or `shopify_union_databases` variables, respectively. Empty string if you are not using either of these variables to union together multiple Shopify connectors.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_39Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">39. model.shopify_source.stg_shopify__collection_product</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    Table relating products to the collections they belong to. Use this instead of the deprecated `COLLECT` table.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__collection_product_tmp&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">fields</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="err">{{</span>
<span class="w">            </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">fill_staging_columns</span><span class="p">(</span>
<span class="w">                </span><span class="n">source_columns</span><span class="o">=</span><span class="n">adapter</span><span class="p">.</span><span class="n">get_columns_in_relation</span><span class="p">(</span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__collection_product_tmp&#39;</span><span class="p">)),</span>
<span class="w">                </span><span class="n">staging_columns</span><span class="o">=</span><span class="n">get_collection_product_columns</span><span class="p">()</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">source_relation</span><span class="p">(</span>
<span class="w">            </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">base</span>
<span class="p">),</span>

<span class="k">final</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">collection_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_id</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(_fivetran_synced as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">_fivetran_synced</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span>
<span class="w">        </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">fields</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="k">final</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>_fivetran_synced</td>
  <td>The time when a record was last updated by Fivetran.</td>
</tr>
<tr>
  <td>collection_id</td>
  <td>ID referencing the `collection` the product belongs to.</td>
</tr>
<tr>
  <td>product_id</td>
  <td>ID referencing the `product`.</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The schema or database this record came from if you are making use of the `shopify_union_schemas` or `shopify_union_databases` variables, respectively. Empty string if you are not using either of these variables to union together multiple Shopify connectors.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_40Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">40. model.shopify_source.stg_shopify__customer</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    Each record represents a customer in Shopify.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__customer_tmp&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="p">),</span>

<span class="n">fields</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">    </span>
<span class="w">        </span><span class="err">{{</span>
<span class="w">            </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">fill_staging_columns</span><span class="p">(</span>
<span class="w">                </span><span class="n">source_columns</span><span class="o">=</span><span class="n">adapter</span><span class="p">.</span><span class="n">get_columns_in_relation</span><span class="p">(</span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__customer_tmp&#39;</span><span class="p">)),</span>
<span class="w">                </span><span class="n">staging_columns</span><span class="o">=</span><span class="n">get_customer_columns</span><span class="p">()</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">source_relation</span><span class="p">(</span>
<span class="w">            </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">base</span>

<span class="p">),</span>

<span class="k">final</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">id</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">customer_id</span><span class="p">,</span>
<span class="w">        </span><span class="k">lower</span><span class="p">(</span><span class="n">email</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">email</span><span class="p">,</span>
<span class="w">        </span><span class="n">first_name</span><span class="p">,</span>
<span class="w">        </span><span class="n">last_name</span><span class="p">,</span>
<span class="w">        </span><span class="n">orders_count</span><span class="p">,</span>
<span class="w">        </span><span class="n">default_address_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">phone</span><span class="p">,</span>
<span class="w">        </span><span class="k">lower</span><span class="p">(</span><span class="k">state</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">account_state</span><span class="p">,</span>
<span class="w">        </span><span class="n">tax_exempt</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">is_tax_exempt</span><span class="p">,</span>
<span class="w">        </span><span class="n">total_spent</span><span class="p">,</span>
<span class="w">        </span><span class="n">verified_email</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">is_verified_email</span><span class="p">,</span>
<span class="w">        </span><span class="n">note</span><span class="p">,</span>
<span class="w">        </span><span class="n">currency</span><span class="p">,</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span>
<span class="w">            </span><span class="k">when</span><span class="w"> </span><span class="n">email_marketing_consent_state</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="k">then</span>
<span class="w">                </span><span class="k">case</span><span class="w"> </span>
<span class="w">                    </span><span class="k">when</span><span class="w"> </span><span class="n">accepts_marketing</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">null</span>
<span class="w">                    </span><span class="k">when</span><span class="w"> </span><span class="n">accepts_marketing</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="s1">&#39;subscribed (legacy)&#39;</span><span class="w"> </span>
<span class="w">                    </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;not_subscribed (legacy)&#39;</span><span class="w"> </span><span class="k">end</span>
<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="k">lower</span><span class="p">(</span><span class="n">email_marketing_consent_state</span><span class="p">)</span><span class="w"> </span><span class="k">end</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">marketing_consent_state</span><span class="p">,</span>
<span class="w">        </span><span class="k">lower</span><span class="p">(</span><span class="k">coalesce</span><span class="p">(</span><span class="n">email_marketing_consent_opt_in_level</span><span class="p">,</span><span class="w"> </span><span class="n">marketing_opt_in_level</span><span class="p">))</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">marketing_opt_in_level</span><span class="p">,</span>

<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(coalesce(accepts_marketing_updated_at, email_marketing_consent_consent_updated_at) as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">marketing_consent_updated_at</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(created_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">created_timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(updated_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">updated_timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(_fivetran_synced as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">_fivetran_synced</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span>
<span class="w">        </span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">fill_pass_through_columns</span><span class="p">(</span><span class="s1">&#39;customer_pass_through_columns&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">fields</span>
<span class="w">    </span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="k">from</span><span class="w"> </span><span class="k">final</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>_fivetran_synced</td>
  <td>The time when a record was last updated by Fivetran.</td>
</tr>
<tr>
  <td>marketing_consent_state</td>
  <td>Field indicating if the customer has consented to receive marketing material via email. Coalescing of the new `email_marketing_consent_state` field and the deprecated `accepts_marketing` field. Records with the old field will be marked with '(legacy)'.\n</td>
</tr>
<tr>
  <td>marketing_opt_in_level</td>
  <td>The marketing subscription opt-in level, as described in the M3AAWG Sender Best Common Practices, that the customer gave when they consented to receive marketing material by email.</td>
</tr>
<tr>
  <td>marketing_consent_updated_at</td>
  <td>The date and time when the customer consented to receive marketing material by email. If no date is provided, then the date and time when the consent information was sent is used.</td>
</tr>
<tr>
  <td>created_timestamp</td>
  <td>The date and time when the customer was created.</td>
</tr>
<tr>
  <td>default_address_id</td>
  <td>The default address for the customer.</td>
</tr>
<tr>
  <td>email</td>
  <td>The unique email address of the customer. Attempting to assign the same email address to multiple customers returns an error.</td>
</tr>
<tr>
  <td>first_name</td>
  <td>The customer's first name.</td>
</tr>
<tr>
  <td>customer_id</td>
  <td>A unique identifier for the customer.</td>
</tr>
<tr>
  <td>last_name</td>
  <td>The customer's last name.</td>
</tr>
<tr>
  <td>orders_count</td>
  <td>The number of orders associated with this customer.</td>
</tr>
<tr>
  <td>phone</td>
  <td>The unique phone number (E.164 format) for this customer. Attempting to assign the same phone number to multiple customers returns an error.</td>
</tr>
<tr>
  <td>account_state</td>
  <td>The state of the customer's account with a shop.</td>
</tr>
<tr>
  <td>is_tax_exempt</td>
  <td>Whether the customer is exempt from paying taxes on their order. If true, then taxes won't be applied to an order at checkout. If false, then taxes will be applied at checkout.</td>
</tr>
<tr>
  <td>total_spent</td>
  <td>The total amount of money that the customer has spent across their order history.</td>
</tr>
<tr>
  <td>updated_timestamp</td>
  <td>The date and time when the customer information was last updated.</td>
</tr>
<tr>
  <td>is_verified_email</td>
  <td>Whether the customer has verified their email address.</td>
</tr>
<tr>
  <td>currency</td>
  <td>The three-letter code (ISO 4217 format) for the currency that the customer used when they paid for their last order. Defaults to the shop currency. Returns the shop currency for test orders.</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The schema or database this record came from if you are making use of the `shopify_union_schemas` or `shopify_union_databases` variables, respectively. Empty string if you are not using either of these variables to union together multiple Shopify connectors.</td>
</tr>
<tr>
  <td>note</td>
  <td>A note about the customer.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_41Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">41. model.shopify_source.stg_shopify__customer_tag</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    Tags that the shop owner has attached to the customer. A customer can have up to 250 tags.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__customer_tag_tmp&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">fields</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="err">{{</span>
<span class="w">            </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">fill_staging_columns</span><span class="p">(</span>
<span class="w">                </span><span class="n">source_columns</span><span class="o">=</span><span class="n">adapter</span><span class="p">.</span><span class="n">get_columns_in_relation</span><span class="p">(</span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__customer_tag_tmp&#39;</span><span class="p">)),</span>
<span class="w">                </span><span class="n">staging_columns</span><span class="o">=</span><span class="n">get_customer_tag_columns</span><span class="p">()</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">source_relation</span><span class="p">(</span>
<span class="w">            </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">base</span>
<span class="p">),</span>

<span class="k">final</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">customer_id</span><span class="p">,</span>
<span class="w">        </span><span class="k">index</span><span class="p">,</span>
<span class="w">        </span><span class="n">value</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(_fivetran_synced as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">_fivetran_synced</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">fields</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="k">final</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>_fivetran_synced</td>
  <td>The time when a record was last updated by Fivetran.</td>
</tr>
<tr>
  <td>index</td>
  <td>Index (starting from 1) representing when the tag was placed on the customer.</td>
</tr>
<tr>
  <td>customer_id</td>
  <td>ID of the customer being tagged.</td>
</tr>
<tr>
  <td>value</td>
  <td>Value of the tag.</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The schema or database this record came from if you are making use of the `shopify_union_schemas` or `shopify_union_databases` variables, respectively. Empty string if you are not using either of these variables to union together multiple Shopify connectors.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_42Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">42. model.shopify_source.stg_shopify__discount_code</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    Table storing discount codes that enable specific discounts to be redeemed. Merchants can distribute discount codes to their customers using a variety of means, such as an email or URL,  and customers can apply these codes at checkout. Each discount code belongs to a price rule, which holds the logic for the discount.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="c1">-- this model will be all NULL until you create a discount code in Shopify</span>

<span class="k">with</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__discount_code_tmp&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">fields</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="err">{{</span>
<span class="w">            </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">fill_staging_columns</span><span class="p">(</span>
<span class="w">                </span><span class="n">source_columns</span><span class="o">=</span><span class="n">adapter</span><span class="p">.</span><span class="n">get_columns_in_relation</span><span class="p">(</span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__discount_code_tmp&#39;</span><span class="p">)),</span>
<span class="w">                </span><span class="n">staging_columns</span><span class="o">=</span><span class="n">get_discount_code_columns</span><span class="p">()</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">source_relation</span><span class="p">(</span>
<span class="w">            </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">base</span>
<span class="p">),</span>

<span class="k">final</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">id</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">discount_code_id</span><span class="p">,</span>
<span class="w">        </span><span class="k">upper</span><span class="p">(</span><span class="n">code</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">code</span><span class="p">,</span>
<span class="w">        </span><span class="n">price_rule_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">usage_count</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(created_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">created_at</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(updated_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">updated_at</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(_fivetran_synced as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">_fivetran_synced</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span>
<span class="w">        </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">fields</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="k">final</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>_fivetran_synced</td>
  <td>The time when a record was last updated by Fivetran.</td>
</tr>
<tr>
  <td>code</td>
  <td>The case-insensitive discount code that customers use at checkout. Shopify recommends this map onto the associated `price_rule.title`.</td>
</tr>
<tr>
  <td>created_at</td>
  <td>The date and time (ISO 8601 format) when the discount code was created.</td>
</tr>
<tr>
  <td>discount_code_id</td>
  <td>The ID for the discount code.</td>
</tr>
<tr>
  <td>price_rule_id</td>
  <td>The ID for the price rule that this discount code belongs to.</td>
</tr>
<tr>
  <td>updated_at</td>
  <td>The date and time (ISO 8601 format) when the discount code was updated.</td>
</tr>
<tr>
  <td>usage_count</td>
  <td>The number of times that the discount code has been redeemed.</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The schema or database this record came from if you are making use of the `shopify_union_schemas` or `shopify_union_databases` variables, respectively. Empty string if you are not using either of these variables to union together multiple Shopify connectors.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_43Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">43. model.shopify_source.stg_shopify__fulfillment</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    A fulfillment order represents a group of one or more items in an order that will be fulfilled from the same location.  A fulfillment represents work that is completed as part of a fulfillment order and can include one or more items.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__fulfillment_tmp&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">fields</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="err">{{</span>
<span class="w">            </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">fill_staging_columns</span><span class="p">(</span>
<span class="w">                </span><span class="n">source_columns</span><span class="o">=</span><span class="n">adapter</span><span class="p">.</span><span class="n">get_columns_in_relation</span><span class="p">(</span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__fulfillment_tmp&#39;</span><span class="p">)),</span>
<span class="w">                </span><span class="n">staging_columns</span><span class="o">=</span><span class="n">get_fulfillment_columns</span><span class="p">()</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">source_relation</span><span class="p">(</span>
<span class="w">            </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">base</span>
<span class="p">),</span>

<span class="k">final</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">id</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">fulfillment_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">location_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">name</span><span class="p">,</span>
<span class="w">        </span><span class="n">service</span><span class="p">,</span>
<span class="w">        </span><span class="n">shipment_status</span><span class="p">,</span>
<span class="w">        </span><span class="k">lower</span><span class="p">(</span><span class="n">status</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">status</span><span class="p">,</span>
<span class="w">        </span><span class="n">tracking_company</span><span class="p">,</span>
<span class="w">        </span><span class="n">tracking_number</span><span class="p">,</span>
<span class="w">        </span><span class="n">tracking_numbers</span><span class="p">,</span>
<span class="w">        </span><span class="n">tracking_urls</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(created_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">created_at</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(updated_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">updated_at</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(_fivetran_synced as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">_fivetran_synced</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">fields</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="k">final</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>_fivetran_synced</td>
  <td>The time when a record was last updated by Fivetran.</td>
</tr>
<tr>
  <td>created_at</td>
  <td>The date and time when the fulfillment was created. The API returns this value in ISO 8601 format.</td>
</tr>
<tr>
  <td>fulfillment_id</td>
  <td>The ID for the fulfillment.</td>
</tr>
<tr>
  <td>location_id</td>
  <td>The unique identifier of the location that the fulfillment was processed at.</td>
</tr>
<tr>
  <td>name</td>
  <td>The uniquely identifying fulfillment name, consisting of two parts separated by a .. The first part represents the order name and the second part represents the fulfillment number.  The fulfillment number automatically increments depending on how many fulfillments are in an order (e.g. #1001.1, #1001.2).\n</td>
</tr>
<tr>
  <td>order_id</td>
  <td>The unique numeric identifier for the order.</td>
</tr>
<tr>
  <td>service</td>
  <td>The fulfillment service associated with the fulfillment.</td>
</tr>
<tr>
  <td>shipment_status</td>
  <td>The current shipment status of the fulfillment. Valid values include: - label_printed: A label for the shipment was purchased and printed. - label_purchased: A label for the shipment was purchased, but not printed. - attempted_delivery: Delivery of the shipment was attempted, but unable to be completed. - ready_for_pickup: The shipment is ready for pickup at a shipping depot. - confirmed: The carrier is aware of the shipment, but hasn't received it yet. - in_transit: The shipment is being transported between shipping facilities on the way to its destination. - out_for_delivery: The shipment is being delivered to its final destination. - delivered: The shipment was successfully delivered. - failure: Something went wrong when pulling tracking information for the shipment, such as the tracking number was invalid or the shipment was canceled.\n</td>
</tr>
<tr>
  <td>status</td>
  <td>The status of the fulfillment. Valid values include: - pending: Shopify has created the fulfillment and is waiting for the third-party fulfillment service to transition it to 'open' or 'success'. - open: The fulfillment has been acknowledged by the service and is in processing. - success: The fulfillment was successful. - cancelled: The fulfillment was cancelled. - error: There was an error with the fulfillment request. - failure: The fulfillment request failed.\n</td>
</tr>
<tr>
  <td>tracking_company</td>
  <td>The name of the tracking company.</td>
</tr>
<tr>
  <td>tracking_number</td>
  <td>Primary tracking number for the order.</td>
</tr>
<tr>
  <td>tracking_numbers</td>
  <td>A list of tracking numbers, provided by the shipping company.</td>
</tr>
<tr>
  <td>tracking_urls</td>
  <td>The URLs of tracking pages for the fulfillment.</td>
</tr>
<tr>
  <td>updated_at</td>
  <td>The date and time (ISO 8601 format) when the fulfillment was last modified.</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The schema or database this record came from if you are making use of the `shopify_union_schemas` or `shopify_union_databases` variables, respectively. Empty string if you are not using either of these variables to union together multiple Shopify connectors.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_44Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">44. model.shopify_source.stg_shopify__inventory_item</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    An inventory item represents a physical good. It holds essential information about the physical good, including its SKU and whether its inventory is tracked. There is a 1:1 relationship between a product variant and an inventory item.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__inventory_item_tmp&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">fields</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="err">{{</span>
<span class="w">            </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">fill_staging_columns</span><span class="p">(</span>
<span class="w">                </span><span class="n">source_columns</span><span class="o">=</span><span class="n">adapter</span><span class="p">.</span><span class="n">get_columns_in_relation</span><span class="p">(</span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__inventory_item_tmp&#39;</span><span class="p">)),</span>
<span class="w">                </span><span class="n">staging_columns</span><span class="o">=</span><span class="n">get_inventory_item_columns</span><span class="p">()</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">source_relation</span><span class="p">(</span>
<span class="w">            </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">base</span>
<span class="p">),</span>

<span class="k">final</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">id</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">inventory_item_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">sku</span><span class="p">,</span>
<span class="w">        </span><span class="n">_fivetran_deleted</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">is_deleted</span><span class="p">,</span><span class="w"> </span><span class="c1">-- won&#39;t filter out for now</span>
<span class="w">        </span><span class="n">cost</span><span class="p">,</span>
<span class="w">        </span><span class="n">country_code_of_origin</span><span class="p">,</span>
<span class="w">        </span><span class="n">province_code_of_origin</span><span class="p">,</span>
<span class="w">        </span><span class="n">requires_shipping</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">is_shipping_required</span><span class="p">,</span>
<span class="w">        </span><span class="n">tracked</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">is_inventory_quantity_tracked</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(created_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">created_at</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(updated_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">updated_at</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(_fivetran_synced as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">_fivetran_synced</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">fields</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="k">final</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>is_deleted</td>
  <td>Boolean representing whether the record was soft-deleted in Shopify.</td>
</tr>
<tr>
  <td>_fivetran_synced</td>
  <td>The time when a record was last updated by Fivetran.</td>
</tr>
<tr>
  <td>cost</td>
  <td>The unit cost of the inventory item. The shop's default currency is used.</td>
</tr>
<tr>
  <td>country_code_of_origin</td>
  <td>The country code (ISO 3166-1 alpha-2) of where the item came from.</td>
</tr>
<tr>
  <td>created_at</td>
  <td>The date and time (ISO 8601 format) when the inventory item was created.</td>
</tr>
<tr>
  <td>inventory_item_id</td>
  <td>The ID of the inventory item.</td>
</tr>
<tr>
  <td>province_code_of_origin</td>
  <td>The province code (ISO 3166-2 alpha-2) of where the item came from. The province code is only used if the shipping provider for the inventory item is Canada Post.</td>
</tr>
<tr>
  <td>is_shipping_required</td>
  <td>Boolean representing whether a customer needs to provide a shipping address when placing an order containing the inventory item.</td>
</tr>
<tr>
  <td>sku</td>
  <td>The unique SKU (stock keeping unit) of the inventory item.</td>
</tr>
<tr>
  <td>is_inventory_quantity_tracked</td>
  <td>Boolean representing whether inventory levels are tracked for the item. If true, then the inventory quantity changes are tracked by Shopify.</td>
</tr>
<tr>
  <td>updated_at</td>
  <td>The date and time (ISO 8601 format) when the inventory item was last modified.</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The schema or database this record came from if you are making use of the `shopify_union_schemas` or `shopify_union_databases` variables, respectively. Empty string if you are not using either of these variables to union together multiple Shopify connectors.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_45Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">45. model.shopify_source.stg_shopify__inventory_level</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    An inventory level represents the quantities of an inventory item for a location.
Each inventory level belongs to one inventory item and has one location. For every location where an inventory item can be stocked, there's an inventory level that represents  the inventory item's quantities relating to that location.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__inventory_level_tmp&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">fields</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="err">{{</span>
<span class="w">            </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">fill_staging_columns</span><span class="p">(</span>
<span class="w">                </span><span class="n">source_columns</span><span class="o">=</span><span class="n">adapter</span><span class="p">.</span><span class="n">get_columns_in_relation</span><span class="p">(</span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__inventory_level_tmp&#39;</span><span class="p">)),</span>
<span class="w">                </span><span class="n">staging_columns</span><span class="o">=</span><span class="n">get_inventory_level_columns</span><span class="p">()</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">source_relation</span><span class="p">(</span>
<span class="w">            </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">base</span>
<span class="p">),</span>

<span class="k">final</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">inventory_item_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">location_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">available</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">available_quantity</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(updated_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">updated_at</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(_fivetran_synced as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">_fivetran_synced</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span>
<span class="w">        </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">fields</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="k">final</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>_fivetran_synced</td>
  <td>The time when a record was last updated by Fivetran.</td>
</tr>
<tr>
  <td>available_quantity</td>
  <td>The available quantity of an inventory item at the inventory level's associated location. Returns null if the inventory item is not tracked.</td>
</tr>
<tr>
  <td>inventory_item_id</td>
  <td>The ID of the inventory item associated with the inventory level.</td>
</tr>
<tr>
  <td>location_id</td>
  <td>The ID of the location that the inventory level belongs to.</td>
</tr>
<tr>
  <td>updated_at</td>
  <td>The date and time (ISO 8601 format) when the inventory level was last modified.</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The schema or database this record came from if you are making use of the `shopify_union_schemas` or `shopify_union_databases` variables, respectively. Empty string if you are not using either of these variables to union together multiple Shopify connectors.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_46Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">46. model.shopify_source.stg_shopify__location</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    A location represents a geographical location where your stores, pop-up stores, headquarters, and warehouses exist.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__location_tmp&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">fields</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="err">{{</span>
<span class="w">            </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">fill_staging_columns</span><span class="p">(</span>
<span class="w">                </span><span class="n">source_columns</span><span class="o">=</span><span class="n">adapter</span><span class="p">.</span><span class="n">get_columns_in_relation</span><span class="p">(</span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__location_tmp&#39;</span><span class="p">)),</span>
<span class="w">                </span><span class="n">staging_columns</span><span class="o">=</span><span class="n">get_location_columns</span><span class="p">()</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">source_relation</span><span class="p">(</span>
<span class="w">            </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">base</span>
<span class="p">),</span>

<span class="k">final</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">id</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">location_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">name</span><span class="p">,</span>
<span class="w">        </span><span class="n">_fivetran_deleted</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">is_deleted</span><span class="p">,</span>
<span class="w">        </span><span class="n">active</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">is_active</span><span class="p">,</span>
<span class="w">        </span><span class="n">address_1</span><span class="p">,</span>
<span class="w">        </span><span class="n">address_2</span><span class="p">,</span>
<span class="w">        </span><span class="n">city</span><span class="p">,</span>
<span class="w">        </span><span class="n">country</span><span class="p">,</span>
<span class="w">        </span><span class="n">country_code</span><span class="p">,</span>
<span class="w">        </span><span class="n">country_name</span><span class="p">,</span>
<span class="w">        </span><span class="n">legacy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">is_legacy</span><span class="p">,</span>
<span class="w">        </span><span class="n">localized_country_name</span><span class="p">,</span>
<span class="w">        </span><span class="n">localized_province_name</span><span class="p">,</span>
<span class="w">        </span><span class="n">phone</span><span class="p">,</span>
<span class="w">        </span><span class="n">province</span><span class="p">,</span>
<span class="w">        </span><span class="n">province_code</span><span class="p">,</span>
<span class="w">        </span><span class="n">zip</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(created_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">created_at</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(updated_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">updated_at</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(_fivetran_synced as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">_fivetran_synced</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">fields</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="k">final</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>is_deleted</td>
  <td>Boolean representing whether the record was soft-deleted in Shopify.</td>
</tr>
<tr>
  <td>_fivetran_synced</td>
  <td>The time when a record was last updated by Fivetran.</td>
</tr>
<tr>
  <td>is_active</td>
  <td>Boolean representing whether the location is active. If true, then the location can be used to sell products, stock inventory, and fulfill orders.\n</td>
</tr>
<tr>
  <td>address_1</td>
  <td>The location's street address.</td>
</tr>
<tr>
  <td>address_2</td>
  <td>The optional second line of the location's street address.</td>
</tr>
<tr>
  <td>city</td>
  <td>The city the location is in.</td>
</tr>
<tr>
  <td>country</td>
  <td>The country the location is in (two-letter code).</td>
</tr>
<tr>
  <td>country_code</td>
  <td>The two-letter code (ISO 3166-1 alpha-2 format) corresponding to country the location is in.</td>
</tr>
<tr>
  <td>country_name</td>
  <td>Full name of the location's country.</td>
</tr>
<tr>
  <td>created_at</td>
  <td>The date and time (ISO 8601 format) when the location was created.</td>
</tr>
<tr>
  <td>location_id</td>
  <td>The ID of the location.</td>
</tr>
<tr>
  <td>is_legacy</td>
  <td>Boolean representing whether this is a fulfillment service location. If true, then the location is a fulfillment service location.  If false, then the location was created by the merchant and isn't tied to a fulfillment service.\n</td>
</tr>
<tr>
  <td>localized_country_name</td>
  <td>The localized name of the location's country.</td>
</tr>
<tr>
  <td>localized_province_name</td>
  <td>The localized name of the location's region. Typically a province, state, or district.</td>
</tr>
<tr>
  <td>name</td>
  <td>The name of the location.</td>
</tr>
<tr>
  <td>phone</td>
  <td>The phone number of the location. This value can contain special characters, such as - or +.</td>
</tr>
<tr>
  <td>province</td>
  <td>The province, state, or district of the location.</td>
</tr>
<tr>
  <td>province_code</td>
  <td>The province, state, or district code (ISO 3166-2 alpha-2 format) of the location.</td>
</tr>
<tr>
  <td>updated_at</td>
  <td>The date and time (ISO 8601 format) when the location was last updated.</td>
</tr>
<tr>
  <td>zip</td>
  <td>The zip or postal code.</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The schema or database this record came from if you are making use of the `shopify_union_schemas` or `shopify_union_databases` variables, respectively. Empty string if you are not using either of these variables to union together multiple Shopify connectors.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_47Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">47. model.shopify_source.stg_shopify__metafield</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    Metafields are a flexible way to attach additional information to a Shopify resource (e.g. Product, Collection, etc.). Some examples of data stored using metafields include specifications, size charts,  downloadable documents, release dates, images, or part numbers. Metafields are identified by an owner resource, a namespace, and a key and they store a value along with type information for that context.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__metafield_tmp&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">fields</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="err">{{</span>
<span class="w">            </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">fill_staging_columns</span><span class="p">(</span>
<span class="w">                </span><span class="n">source_columns</span><span class="o">=</span><span class="n">adapter</span><span class="p">.</span><span class="n">get_columns_in_relation</span><span class="p">(</span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__metafield_tmp&#39;</span><span class="p">)),</span>
<span class="w">                </span><span class="n">staging_columns</span><span class="o">=</span><span class="n">get_metafield_columns</span><span class="p">()</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">source_relation</span><span class="p">(</span>
<span class="w">            </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">base</span>
<span class="p">),</span>

<span class="k">final</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">id</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">metafield_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">description</span><span class="p">,</span>
<span class="w">        </span><span class="n">namespace</span><span class="p">,</span>
<span class="w">        </span><span class="k">key</span><span class="p">,</span>
<span class="w">        </span><span class="n">value</span><span class="p">,</span>
<span class="w">        </span><span class="k">lower</span><span class="p">(</span><span class="k">coalesce</span><span class="p">(</span><span class="k">type</span><span class="p">,</span><span class="w"> </span><span class="n">value_type</span><span class="p">))</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">value_type</span><span class="p">,</span>
<span class="w">        </span><span class="n">owner_id</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">owner_resource_id</span><span class="p">,</span>
<span class="w">        </span><span class="k">lower</span><span class="p">(</span><span class="n">owner_resource</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">owner_resource</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(created_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">created_at</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(updated_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">updated_at</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(_fivetran_synced as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">_fivetran_synced</span><span class="p">,</span>
<span class="w">        </span><span class="k">lower</span><span class="p">(</span><span class="err">{{</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">concat</span><span class="p">([</span><span class="ss">&quot;namespace&quot;</span><span class="p">,</span><span class="ss">&quot;&#39;_&#39;&quot;</span><span class="p">,</span><span class="ss">&quot;key&quot;</span><span class="p">])</span><span class="w"> </span><span class="err">}}</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">metafield_reference</span><span class="p">,</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">updated_at</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">null</span>
<span class="w">            </span><span class="k">then</span><span class="w"> </span><span class="n">row_number</span><span class="p">()</span><span class="w"> </span><span class="n">over</span><span class="p">(</span><span class="n">partition</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">source_relation</span><span class="w"> </span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">source_relation</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="n">row_number</span><span class="p">()</span><span class="w"> </span><span class="n">over</span><span class="p">(</span><span class="n">partition</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">source_relation</span><span class="w"> </span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">updated_at</span><span class="w"> </span><span class="k">desc</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="k">end</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">is_most_recent_record</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span>
<span class="w">        </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">fields</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="k">final</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>_fivetran_synced</td>
  <td>The time when a record was last updated by Fivetran.</td>
</tr>
<tr>
  <td>created_at</td>
  <td>The date and time (ISO 8601 format) when the metafield was created.</td>
</tr>
<tr>
  <td>description</td>
  <td>A description of the information that the metafield contains.</td>
</tr>
<tr>
  <td>metafield_id</td>
  <td>The unique ID of the metafield.</td>
</tr>
<tr>
  <td>key</td>
  <td>The key of the metafield. Keys can be up to 64 characters long and can contain alphanumeric characters, hyphens, underscores, and periods.</td>
</tr>
<tr>
  <td>namespace</td>
  <td>A container for a group of metafields. Grouping metafields within a namespace prevents your metafields from conflicting with other metafields with the same key name. Must have between 3-255 characters.</td>
</tr>
<tr>
  <td>owner_resource_id</td>
  <td>The unique ID of the resource that the metafield is attached to.</td>
</tr>
<tr>
  <td>owner_resource</td>
  <td>The type of resource (table) that the metafield is attached to.</td>
</tr>
<tr>
  <td>value_type</td>
  <td>The type of data that the metafield stores in the `value` field. Refer to the [list](https://shopify.dev/apps/metafields/types) of supported types. Coalescing of type and value_type</td>
</tr>
<tr>
  <td>updated_at</td>
  <td>The date and time (ISO 8601 format) when the metafield was last updated.</td>
</tr>
<tr>
  <td>value</td>
  <td>The data to store in the metafield. The value is always stored as a string, regardless of the metafield's type.</td>
</tr>
<tr>
  <td>metafield_reference</td>
  <td>Combination of the namespace and key columns. This field is key for metafield mapping in downstream models.</td>
</tr>
<tr>
  <td>is_most_recent_record</td>
  <td>Boolean indicating the most up to date record identified by the most recent updated_at field.</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The schema or database this record came from if you are making use of the `shopify_union_schemas` or `shopify_union_databases` variables, respectively. Empty string if you are not using either of these variables to union together multiple Shopify connectors.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_48Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">48. model.shopify_source.stg_shopify__order</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    Each record represents an order in Shopify.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__order_tmp&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="p">),</span>

<span class="n">fields</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">    </span>
<span class="w">        </span><span class="err">{{</span>
<span class="w">            </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">fill_staging_columns</span><span class="p">(</span>
<span class="w">                </span><span class="n">source_columns</span><span class="o">=</span><span class="n">adapter</span><span class="p">.</span><span class="n">get_columns_in_relation</span><span class="p">(</span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__order_tmp&#39;</span><span class="p">)),</span>
<span class="w">                </span><span class="n">staging_columns</span><span class="o">=</span><span class="n">get_order_columns</span><span class="p">()</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">source_relation</span><span class="p">(</span>
<span class="w">            </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">base</span>

<span class="p">),</span>

<span class="k">final</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">id</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">order_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">user_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">total_discounts</span><span class="p">,</span>
<span class="w">        </span><span class="n">total_discounts_set</span><span class="p">,</span>
<span class="w">        </span><span class="n">total_line_items_price</span><span class="p">,</span>
<span class="w">        </span><span class="n">total_line_items_price_set</span><span class="p">,</span>
<span class="w">        </span><span class="n">total_price</span><span class="p">,</span>
<span class="w">        </span><span class="n">total_price_set</span><span class="p">,</span>
<span class="w">        </span><span class="n">total_tax_set</span><span class="p">,</span>
<span class="w">        </span><span class="n">total_tax</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_name</span><span class="p">,</span>
<span class="w">        </span><span class="n">subtotal_price</span><span class="p">,</span>
<span class="w">        </span><span class="n">taxes_included</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">has_taxes_included</span><span class="p">,</span>
<span class="w">        </span><span class="n">total_weight</span><span class="p">,</span>
<span class="w">        </span><span class="n">total_tip_received</span><span class="p">,</span>
<span class="w">        </span><span class="n">landing_site_base_url</span><span class="p">,</span>
<span class="w">        </span><span class="n">location_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">name</span><span class="p">,</span>
<span class="w">        </span><span class="n">note</span><span class="p">,</span>
<span class="w">        </span><span class="nb">number</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_number</span><span class="p">,</span>
<span class="w">        </span><span class="n">cancel_reason</span><span class="p">,</span>
<span class="w">        </span><span class="n">cart_token</span><span class="p">,</span>
<span class="w">        </span><span class="n">checkout_token</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(created_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">created_timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(cancelled_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">cancelled_timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(closed_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">closed_timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(processed_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">processed_timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(updated_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">updated_timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="n">currency</span><span class="p">,</span>
<span class="w">        </span><span class="n">customer_id</span><span class="p">,</span>
<span class="w">        </span><span class="k">lower</span><span class="p">(</span><span class="n">email</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">email</span><span class="p">,</span>
<span class="w">        </span><span class="n">financial_status</span><span class="p">,</span>
<span class="w">        </span><span class="n">fulfillment_status</span><span class="p">,</span>
<span class="w">        </span><span class="n">referring_site</span><span class="p">,</span>
<span class="w">        </span><span class="n">billing_address_address_1</span><span class="p">,</span>
<span class="w">        </span><span class="n">billing_address_address_2</span><span class="p">,</span>
<span class="w">        </span><span class="n">billing_address_city</span><span class="p">,</span>
<span class="w">        </span><span class="n">billing_address_company</span><span class="p">,</span>
<span class="w">        </span><span class="n">billing_address_country</span><span class="p">,</span>
<span class="w">        </span><span class="n">billing_address_country_code</span><span class="p">,</span>
<span class="w">        </span><span class="n">billing_address_first_name</span><span class="p">,</span>
<span class="w">        </span><span class="n">billing_address_last_name</span><span class="p">,</span>
<span class="w">        </span><span class="n">billing_address_latitude</span><span class="p">,</span>
<span class="w">        </span><span class="n">billing_address_longitude</span><span class="p">,</span>
<span class="w">        </span><span class="n">billing_address_name</span><span class="p">,</span>
<span class="w">        </span><span class="n">billing_address_phone</span><span class="p">,</span>
<span class="w">        </span><span class="n">billing_address_province</span><span class="p">,</span>
<span class="w">        </span><span class="n">billing_address_province_code</span><span class="p">,</span>
<span class="w">        </span><span class="n">billing_address_zip</span><span class="p">,</span>
<span class="w">        </span><span class="n">browser_ip</span><span class="p">,</span>
<span class="w">        </span><span class="n">total_shipping_price_set</span><span class="p">,</span>
<span class="w">        </span><span class="n">shipping_address_address_1</span><span class="p">,</span>
<span class="w">        </span><span class="n">shipping_address_address_2</span><span class="p">,</span>
<span class="w">        </span><span class="n">shipping_address_city</span><span class="p">,</span>
<span class="w">        </span><span class="n">shipping_address_company</span><span class="p">,</span>
<span class="w">        </span><span class="n">shipping_address_country</span><span class="p">,</span>
<span class="w">        </span><span class="n">shipping_address_country_code</span><span class="p">,</span>
<span class="w">        </span><span class="n">shipping_address_first_name</span><span class="p">,</span>
<span class="w">        </span><span class="n">shipping_address_last_name</span><span class="p">,</span>
<span class="w">        </span><span class="n">shipping_address_latitude</span><span class="p">,</span>
<span class="w">        </span><span class="n">shipping_address_longitude</span><span class="p">,</span>
<span class="w">        </span><span class="n">shipping_address_name</span><span class="p">,</span>
<span class="w">        </span><span class="n">shipping_address_phone</span><span class="p">,</span>
<span class="w">        </span><span class="n">shipping_address_province</span><span class="p">,</span>
<span class="w">        </span><span class="n">shipping_address_province_code</span><span class="p">,</span>
<span class="w">        </span><span class="n">shipping_address_zip</span><span class="p">,</span>
<span class="w">        </span><span class="n">token</span><span class="p">,</span>
<span class="w">        </span><span class="n">app_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">checkout_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">client_details_user_agent</span><span class="p">,</span>
<span class="w">        </span><span class="n">customer_locale</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_status_url</span><span class="p">,</span>
<span class="w">        </span><span class="n">presentment_currency</span><span class="p">,</span>
<span class="w">        </span><span class="n">test</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">is_test_order</span><span class="p">,</span>
<span class="w">        </span><span class="n">_fivetran_deleted</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">is_deleted</span><span class="p">,</span>
<span class="w">        </span><span class="n">buyer_accepts_marketing</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">has_buyer_accepted_marketing</span><span class="p">,</span>
<span class="w">        </span><span class="n">confirmed</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">is_confirmed</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(_fivetran_synced as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">_fivetran_synced</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span>

<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">fill_pass_through_columns</span><span class="p">(</span><span class="s1">&#39;order_pass_through_columns&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">fields</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="k">from</span><span class="w"> </span><span class="k">final</span>
<span class="k">where</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">coalesce</span><span class="p">(</span><span class="n">is_test_order</span><span class="p">,</span><span class="w"> </span><span class="k">false</span><span class="p">)</span>
<span class="k">and</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">coalesce</span><span class="p">(</span><span class="n">is_deleted</span><span class="p">,</span><span class="w"> </span><span class="k">false</span><span class="p">)</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>_fivetran_synced</td>
  <td>The time when a record was last updated by Fivetran.</td>
</tr>
<tr>
  <td>app_id</td>
  <td>The ID of the app that created the order.</td>
</tr>
<tr>
  <td>checkout_id</td>
  <td>ID of the order's checkout.</td>
</tr>
<tr>
  <td>order_status_url</td>
  <td>The URL pointing to the order status web page, if applicable.</td>
</tr>
<tr>
  <td>billing_address_address_1</td>
  <td>The street address of the billing address.</td>
</tr>
<tr>
  <td>billing_address_address_2</td>
  <td>An optional additional field for the street address of the billing address.</td>
</tr>
<tr>
  <td>billing_address_city</td>
  <td>The city, town, or village of the billing address.</td>
</tr>
<tr>
  <td>billing_address_company</td>
  <td>The company of the person associated with the billing address.</td>
</tr>
<tr>
  <td>billing_address_country</td>
  <td>The name of the country of the billing address.</td>
</tr>
<tr>
  <td>billing_address_country_code</td>
  <td>The two-letter code (ISO 3166-1 format) for the country of the billing address.</td>
</tr>
<tr>
  <td>billing_address_first_name</td>
  <td>The first name of the person associated with the payment method.</td>
</tr>
<tr>
  <td>billing_address_last_name</td>
  <td>The last name of the person associated with the payment method.</td>
</tr>
<tr>
  <td>billing_address_latitude</td>
  <td>The latitude of the billing address.</td>
</tr>
<tr>
  <td>billing_address_longitude</td>
  <td>The longitude of the billing address.</td>
</tr>
<tr>
  <td>billing_address_name</td>
  <td>The full name of the person associated with the payment method.</td>
</tr>
<tr>
  <td>billing_address_phone</td>
  <td>The phone number at the billing address.</td>
</tr>
<tr>
  <td>billing_address_province</td>
  <td>The name of the region (province, state, prefecture, ) of the billing address.</td>
</tr>
<tr>
  <td>billing_address_province_code</td>
  <td>The two-letter abbreviation of the region of the billing address.</td>
</tr>
<tr>
  <td>billing_address_zip</td>
  <td>The postal code (zip, postcode, Eircode, ) of the billing address.</td>
</tr>
<tr>
  <td>browser_ip</td>
  <td>The IP address of the browser used by the customer when they placed the order.</td>
</tr>
<tr>
  <td>has_buyer_accepted_marketing</td>
  <td>Whether the customer consented to receive email updates from the shop.</td>
</tr>
<tr>
  <td>cancel_reason</td>
  <td>The reason why the order was canceled.</td>
</tr>
<tr>
  <td>cancelled_timestamp</td>
  <td>The date and time when the order was canceled.</td>
</tr>
<tr>
  <td>cart_token</td>
  <td>The ID of the cart that's associated with the order.</td>
</tr>
<tr>
  <td>closed_timestamp</td>
  <td>The date and time when the order was closed (archived).</td>
</tr>
<tr>
  <td>created_timestamp</td>
  <td>The autogenerated date and time when the order was created in Shopify.</td>
</tr>
<tr>
  <td>currency</td>
  <td>The three-letter code for the shop currency.</td>
</tr>
<tr>
  <td>customer_id</td>
  <td>The ID of the order's customer.</td>
</tr>
<tr>
  <td>email</td>
  <td>The customer's email address.</td>
</tr>
<tr>
  <td>financial_status</td>
  <td>The status of payments associated with the order. Can only be set when the order is created</td>
</tr>
<tr>
  <td>fulfillment_status</td>
  <td>The order's status in terms of fulfilled line items.</td>
</tr>
<tr>
  <td>order_id</td>
  <td>The ID of the order, used for API purposes. This is different from the order_number property, which is the ID used by the shop owner and customer.</td>
</tr>
<tr>
  <td>landing_site_base_url</td>
  <td>The URL for the page where the buyer landed when they entered the shop.</td>
</tr>
<tr>
  <td>location_id</td>
  <td>The ID of the physical location where the order was processed.</td>
</tr>
<tr>
  <td>name</td>
  <td>The order name, generated by combining the order_number property with the order prefix and suffix that are set in the merchant's general settings.</td>
</tr>
<tr>
  <td>note</td>
  <td>An optional note that a shop owner can attach to the order.</td>
</tr>
<tr>
  <td>number</td>
  <td>The order's position in the shop's count of orders. Numbers are sequential and start at 1.</td>
</tr>
<tr>
  <td>order_number</td>
  <td>The order 's position in the shop's count of orders starting at 1001. Order numbers are sequential and start at 1001.</td>
</tr>
<tr>
  <td>processed_timestamp</td>
  <td>The date and time when an order was processed. This value is the date that appears on your orders and that's used in the analytic reports.</td>
</tr>
<tr>
  <td>referring_site</td>
  <td>The website where the customer clicked a link to the shop.</td>
</tr>
<tr>
  <td>shipping_address_address_1</td>
  <td>The street address of the shipping address.</td>
</tr>
<tr>
  <td>shipping_address_address_2</td>
  <td>An optional additional field for the street address of the shipping address.</td>
</tr>
<tr>
  <td>shipping_address_city</td>
  <td>The city, town, or village of the shipping address.</td>
</tr>
<tr>
  <td>shipping_address_company</td>
  <td>The company of the person associated with the shipping address.</td>
</tr>
<tr>
  <td>shipping_address_country</td>
  <td>The name of the country of the shipping address.</td>
</tr>
<tr>
  <td>shipping_address_country_code</td>
  <td>The two-letter code (ISO 3166-1 format) for the country of the shipping address.</td>
</tr>
<tr>
  <td>shipping_address_first_name</td>
  <td>The first name of the person associated with the shipping address.</td>
</tr>
<tr>
  <td>shipping_address_last_name</td>
  <td>The last name of the person associated with the shipping address.</td>
</tr>
<tr>
  <td>shipping_address_latitude</td>
  <td>The latitude of the shipping address.</td>
</tr>
<tr>
  <td>shipping_address_longitude</td>
  <td>The longitude of the shipping address.</td>
</tr>
<tr>
  <td>shipping_address_name</td>
  <td>The full name of the person associated with the payment method.</td>
</tr>
<tr>
  <td>shipping_address_phone</td>
  <td>The phone number at the shipping address.</td>
</tr>
<tr>
  <td>shipping_address_province</td>
  <td>The name of the region (province, state, prefecture, ) of the shipping address.</td>
</tr>
<tr>
  <td>shipping_address_province_code</td>
  <td>The two-letter abbreviation of the region of the shipping address.</td>
</tr>
<tr>
  <td>shipping_address_zip</td>
  <td>The postal code (zip, postcode, Eircode, ) of the shipping address.</td>
</tr>
<tr>
  <td>source_name</td>
  <td>Where the order originated. Can be set only during order creation, and is not writeable afterwards.</td>
</tr>
<tr>
  <td>subtotal_price</td>
  <td>The price of the order in the shop currency after discounts but before shipping, taxes, and tips.</td>
</tr>
<tr>
  <td>has_taxes_included</td>
  <td>Whether taxes are included in the order subtotal.</td>
</tr>
<tr>
  <td>is_test_order</td>
  <td>Whether this is a test order.</td>
</tr>
<tr>
  <td>token</td>
  <td>A unique token for the order.</td>
</tr>
<tr>
  <td>total_discounts</td>
  <td>The total discounts applied to the price of the order in the shop currency.</td>
</tr>
<tr>
  <td>total_line_items_price</td>
  <td>The sum of all line item prices in the shop currency.</td>
</tr>
<tr>
  <td>total_price</td>
  <td>The sum of all line item prices, discounts, shipping, taxes, and tips in the shop currency. Must be positive.</td>
</tr>
<tr>
  <td>total_tax</td>
  <td>The sum of all the taxes applied to the order in th shop currency. Must be positive).</td>
</tr>
<tr>
  <td>total_weight</td>
  <td>The sum of all line item weights in grams.</td>
</tr>
<tr>
  <td>updated_timestamp</td>
  <td>The date and time (ISO 8601 format) when the order was last modified.</td>
</tr>
<tr>
  <td>user_id</td>
  <td>The ID of the user logged into Shopify POS who processed the order, if applicable.</td>
</tr>
<tr>
  <td>total_shipping_price_set</td>
  <td>The total shipping price of the order, excluding discounts and returns, in shop and presentment currencies. If taxes_included is set to true, then total_shipping_price_set includes taxes.</td>
</tr>
<tr>
  <td>checkout_token</td>
  <td>A unique value when referencing the checkout that's associated with the order.</td>
</tr>
<tr>
  <td>customer_locale</td>
  <td>A two-letter or three-letter language code, optionally followed by a region modifier.</td>
</tr>
<tr>
  <td>is_deleted</td>
  <td>Boolean representing whether the record was soft-deleted in Shopify.</td>
</tr>
<tr>
  <td>total_tip_received</td>
  <td>The sum of all the tips in the order in the shop currency.</td>
</tr>
<tr>
  <td>client_details_user_agent</td>
  <td>Details of the browsing client, including software and operating versions.</td>
</tr>
<tr>
  <td>total_tax_set</td>
  <td>The total tax applied to the order in shop and presentment currencies.</td>
</tr>
<tr>
  <td>total_discounts_set</td>
  <td>The total discounts applied to the price of the order in shop and presentment currencies.</td>
</tr>
<tr>
  <td>presentment_currency</td>
  <td>The presentment currency that was used to display prices to the customer.</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The ID of the order placed on the originating platform. This value doesn't correspond to the Shopify ID that's generated from a completed draft.</td>
</tr>
<tr>
  <td>total_line_items_price_set</td>
  <td>The total of all line item prices in shop and presentment currencies.</td>
</tr>
<tr>
  <td>total_price_set</td>
  <td>The total price of the order in shop and presentment currencies.</td>
</tr>
<tr>
  <td>is_confirmed</td>
  <td>Whether the order is confirmed.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_49Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">49. model.shopify_source.stg_shopify__order_adjustment</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    Each record represents and adjustment to and order within Shopify.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="c1">-- this model will be all NULL until you have made an order adjustment in Shopify</span>

<span class="k">with</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__order_adjustment_tmp&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="p">),</span>

<span class="n">fields</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="err">{{</span>
<span class="w">            </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">fill_staging_columns</span><span class="p">(</span>
<span class="w">                </span><span class="n">source_columns</span><span class="o">=</span><span class="n">adapter</span><span class="p">.</span><span class="n">get_columns_in_relation</span><span class="p">(</span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__order_adjustment_tmp&#39;</span><span class="p">)),</span>
<span class="w">                </span><span class="n">staging_columns</span><span class="o">=</span><span class="n">get_order_adjustment_columns</span><span class="p">()</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">source_relation</span><span class="p">(</span>
<span class="w">            </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="err">}}</span>
<span class="w">        </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">base</span>
<span class="p">),</span>

<span class="k">final</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="n">id</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">order_adjustment_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">refund_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">amount</span><span class="p">,</span>
<span class="w">        </span><span class="n">amount_set</span><span class="p">,</span>
<span class="w">        </span><span class="n">tax_amount</span><span class="p">,</span>
<span class="w">        </span><span class="n">tax_amount_set</span><span class="p">,</span>
<span class="w">        </span><span class="n">kind</span><span class="p">,</span>
<span class="w">        </span><span class="n">reason</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(_fivetran_synced as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">_fivetran_synced</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">fields</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="k">from</span><span class="w"> </span><span class="k">final</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>order_adjustment_id</td>
  <td>The unique numeric identifier for the order adjustment.</td>
</tr>
<tr>
  <td>order_id</td>
  <td>Reference to the order which the adjustment is associated.</td>
</tr>
<tr>
  <td>refund_id</td>
  <td>Reference to the refund which the adjustment is associated.</td>
</tr>
<tr>
  <td>amount</td>
  <td>Amount of the adjustment.</td>
</tr>
<tr>
  <td>tax_amount</td>
  <td>Tax amount applied to the order adjustment in the shop currency.</td>
</tr>
<tr>
  <td>kind</td>
  <td>The kind of order adjustment (eg. refund, restock, etc.).</td>
</tr>
<tr>
  <td>reason</td>
  <td>The reason for the order adjustment.</td>
</tr>
<tr>
  <td>amount_set</td>
  <td>Amount set towards the order adjustment in presentment and shop currencies.</td>
</tr>
<tr>
  <td>tax_amount_set</td>
  <td>Tax amount set towards the order adjustment in the shop and presentment currencies.</td>
</tr>
<tr>
  <td>_fivetran_synced</td>
  <td>The time when a record was last updated by Fivetran.</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The schema or database this record came from if you are making use of the `shopify_union_schemas` or `shopify_union_databases` variables, respectively. Empty string if you are not using either of these variables to union together multiple Shopify connectors.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_50Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">50. model.shopify_source.stg_shopify__order_discount_code</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    Discount codes placed on orders.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__order_discount_code_tmp&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">fields</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="err">{{</span>
<span class="w">            </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">fill_staging_columns</span><span class="p">(</span>
<span class="w">                </span><span class="n">source_columns</span><span class="o">=</span><span class="n">adapter</span><span class="p">.</span><span class="n">get_columns_in_relation</span><span class="p">(</span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__order_discount_code_tmp&#39;</span><span class="p">)),</span>
<span class="w">                </span><span class="n">staging_columns</span><span class="o">=</span><span class="n">get_order_discount_code_columns</span><span class="p">()</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">source_relation</span><span class="p">(</span>
<span class="w">            </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">base</span>
<span class="p">),</span>

<span class="k">final</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">order_id</span><span class="p">,</span>
<span class="w">        </span><span class="k">index</span><span class="p">,</span>
<span class="w">        </span><span class="k">upper</span><span class="p">(</span><span class="n">code</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">code</span><span class="p">,</span>
<span class="w">        </span><span class="k">type</span><span class="p">,</span>
<span class="w">        </span><span class="n">amount</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(_fivetran_synced as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">_fivetran_synced</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">fields</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="k">final</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>_fivetran_synced</td>
  <td>The time when a record was last updated by Fivetran.</td>
</tr>
<tr>
  <td>amount</td>
  <td>The amount that's deducted from the order total.</td>
</tr>
<tr>
  <td>code</td>
  <td>This property returns the discount code that was entered at checkout. Otherwise this property returns the title of the discount that was applied.</td>
</tr>
<tr>
  <td>order_id</td>
  <td>Associated order ID.</td>
</tr>
<tr>
  <td>type</td>
  <td>The type of discount - `fixed_amount`, `percentage`, or `shipping`.</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The schema or database this record came from if you are making use of the `shopify_union_schemas` or `shopify_union_databases` variables, respectively. Empty string if you are not using either of these variables to union together multiple Shopify connectors.</td>
</tr>
<tr>
  <td>index</td>
  <td>Pairs with `order_id` to provide unique identifier for order discount code.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_51Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">51. model.shopify_source.stg_shopify__order_line</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    Each record represents a line item from an order in Shopify.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__order_line_tmp&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="p">),</span>

<span class="n">fields</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">    </span>
<span class="w">        </span><span class="err">{{</span>
<span class="w">            </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">fill_staging_columns</span><span class="p">(</span>
<span class="w">                </span><span class="n">source_columns</span><span class="o">=</span><span class="n">adapter</span><span class="p">.</span><span class="n">get_columns_in_relation</span><span class="p">(</span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__order_line_tmp&#39;</span><span class="p">)),</span>
<span class="w">                </span><span class="n">staging_columns</span><span class="o">=</span><span class="n">get_order_line_columns</span><span class="p">()</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">source_relation</span><span class="p">(</span>
<span class="w">            </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">base</span>

<span class="p">),</span>

<span class="k">final</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">id</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">order_line_id</span><span class="p">,</span>
<span class="w">        </span><span class="k">index</span><span class="p">,</span>
<span class="w">        </span><span class="n">name</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">fulfillable_quantity</span><span class="p">,</span>
<span class="w">        </span><span class="n">fulfillment_status</span><span class="p">,</span>
<span class="w">        </span><span class="n">gift_card</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">is_gift_card</span><span class="p">,</span>
<span class="w">        </span><span class="n">grams</span><span class="p">,</span>
<span class="w">        </span><span class="n">pre_tax_price</span><span class="p">,</span>
<span class="w">        </span><span class="n">pre_tax_price_set</span><span class="p">,</span>
<span class="w">        </span><span class="n">price</span><span class="p">,</span>
<span class="w">        </span><span class="n">price_set</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">quantity</span><span class="p">,</span>
<span class="w">        </span><span class="n">requires_shipping</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">is_shipping_required</span><span class="p">,</span>
<span class="w">        </span><span class="n">sku</span><span class="p">,</span>
<span class="w">        </span><span class="n">taxable</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">is_taxable</span><span class="p">,</span>
<span class="w">        </span><span class="n">tax_code</span><span class="p">,</span>
<span class="w">        </span><span class="n">title</span><span class="p">,</span>
<span class="w">        </span><span class="n">total_discount</span><span class="p">,</span>
<span class="w">        </span><span class="n">total_discount_set</span><span class="p">,</span>
<span class="w">        </span><span class="n">variant_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">variant_title</span><span class="p">,</span>
<span class="w">        </span><span class="n">variant_inventory_management</span><span class="p">,</span>
<span class="w">        </span><span class="n">vendor</span><span class="p">,</span>
<span class="w">        </span><span class="n">properties</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(_fivetran_synced as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">_fivetran_synced</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span>

<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">fill_pass_through_columns</span><span class="p">(</span><span class="s1">&#39;order_line_pass_through_columns&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">fields</span>

<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="k">from</span><span class="w"> </span><span class="k">final</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>_fivetran_synced</td>
  <td>The time when a record was last updated by Fivetran.</td>
</tr>
<tr>
  <td>fulfillable_quantity</td>
  <td>The amount available to fulfill, calculated as follows: quantity - max(refunded_quantity, fulfilled_quantity) - pending_fulfilled_quantity - open_fulfilled_quantity</td>
</tr>
<tr>
  <td>fulfillment_status</td>
  <td>How far along an order is in terms line items fulfilled.</td>
</tr>
<tr>
  <td>is_gift_card</td>
  <td>Whether the item is a gift card. If true, then the item is not taxed or considered for shipping charges.</td>
</tr>
<tr>
  <td>grams</td>
  <td>The weight of the item in grams.</td>
</tr>
<tr>
  <td>order_line_id</td>
  <td>The ID of the line item.</td>
</tr>
<tr>
  <td>name</td>
  <td>The name of the product variant.</td>
</tr>
<tr>
  <td>order_id</td>
  <td>The ID of the related order.</td>
</tr>
<tr>
  <td>price</td>
  <td>The price of the item before discounts have been applied in the shop currency.</td>
</tr>
<tr>
  <td>product_id</td>
  <td>The ID of the product that the line item belongs to. Can be null if the original product associated with the order is deleted at a later date.</td>
</tr>
<tr>
  <td>quantity</td>
  <td>The number of items that were purchased.</td>
</tr>
<tr>
  <td>is_shipping_required</td>
  <td>Whether the item requires shipping.</td>
</tr>
<tr>
  <td>sku</td>
  <td>The item's SKU (stock keeping unit).</td>
</tr>
<tr>
  <td>is_taxable</td>
  <td>Whether the item was taxable.</td>
</tr>
<tr>
  <td>title</td>
  <td>The title of the product.</td>
</tr>
<tr>
  <td>total_discount</td>
  <td>The total amount of the discount allocated to the line item in the shop currency.</td>
</tr>
<tr>
  <td>variant_id</td>
  <td>The ID of the product variant.</td>
</tr>
<tr>
  <td>vendor</td>
  <td>The name of the item's supplier.</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The schema or database this record came from if you are making use of the `shopify_union_schemas` or `shopify_union_databases` variables, respectively. Empty string if you are not using either of these variables to union together multiple Shopify connectors.</td>
</tr>
<tr>
  <td>index</td>
  <td>Index of the order line.</td>
</tr>
<tr>
  <td>pre_tax_price</td>
  <td>The pre tax price of the line item in shop currency.</td>
</tr>
<tr>
  <td>pre_tax_price_set</td>
  <td>The pre tax price of the line item in shop currency and presentment currency.</td>
</tr>
<tr>
  <td>price_set</td>
  <td>The price of the line item in shop and presentment currencies.</td>
</tr>
<tr>
  <td>tax_code</td>
  <td>Tax code applied to the line item. As multiple taxes can apply to a line item, we recommend referring to `stg_shopify__tax_line`.</td>
</tr>
<tr>
  <td>total_discount_set</td>
  <td>The total amount allocated to the line item in the presentment currency.</td>
</tr>
<tr>
  <td>variant_title</td>
  <td>The title of the product variant.</td>
</tr>
<tr>
  <td>variant_inventory_management</td>
  <td>The fulfillment service that tracks the number of items in stock for the product variant.</td>
</tr>
<tr>
  <td>properties</td>
  <td>Line item properties.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_52Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">52. model.shopify_source.stg_shopify__order_line_refund</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    Each record represents a line item from an order in Shopify.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="c1">-- this model will be all NULL until you have made an order line refund in Shopify</span>

<span class="k">with</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__order_line_refund_tmp&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="p">),</span>

<span class="n">fields</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">    </span>
<span class="w">        </span><span class="err">{{</span>
<span class="w">            </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">fill_staging_columns</span><span class="p">(</span>
<span class="w">                </span><span class="n">source_columns</span><span class="o">=</span><span class="n">adapter</span><span class="p">.</span><span class="n">get_columns_in_relation</span><span class="p">(</span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__order_line_refund_tmp&#39;</span><span class="p">)),</span>
<span class="w">                </span><span class="n">staging_columns</span><span class="o">=</span><span class="n">get_order_line_refund_columns</span><span class="p">()</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">source_relation</span><span class="p">(</span>
<span class="w">            </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">base</span>

<span class="p">),</span>

<span class="k">final</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="n">id</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">order_line_refund_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">location_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_line_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">subtotal</span><span class="p">,</span>
<span class="w">        </span><span class="n">subtotal_set</span><span class="p">,</span>
<span class="w">        </span><span class="n">total_tax</span><span class="p">,</span>
<span class="w">        </span><span class="n">total_tax_set</span><span class="p">,</span>
<span class="w">        </span><span class="n">quantity</span><span class="p">,</span>
<span class="w">        </span><span class="n">refund_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">restock_type</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(_fivetran_synced as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">_fivetran_synced</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span>

<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">fill_pass_through_columns</span><span class="p">(</span><span class="s1">&#39;order_line_refund_pass_through_columns&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">fields</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="k">final</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>_fivetran_synced</td>
  <td>The time when a record was last updated by Fivetran.</td>
</tr>
<tr>
  <td>order_line_refund_id</td>
  <td>The unique identifier of the line item in the refund.</td>
</tr>
<tr>
  <td>location_id</td>
  <td>TThe unique identifier of the location where the items will be restockedBD</td>
</tr>
<tr>
  <td>order_line_id</td>
  <td>The ID of the related line item in the order.</td>
</tr>
<tr>
  <td>quantity</td>
  <td>The quantity of the associated line item that was returned.</td>
</tr>
<tr>
  <td>refund_id</td>
  <td>The ID of the related refund.</td>
</tr>
<tr>
  <td>restock_type</td>
  <td>How this refund line item affects inventory levels.</td>
</tr>
<tr>
  <td>subtotal</td>
  <td>Subtotal amount of the order line refund in shop currency.</td>
</tr>
<tr>
  <td>total_tax</td>
  <td>The total tax applied to the refund in the shop currency.</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The schema or database this record came from if you are making use of the `shopify_union_schemas` or `shopify_union_databases` variables, respectively. Empty string if you are not using either of these variables to union together multiple Shopify connectors.</td>
</tr>
<tr>
  <td>subtotal_set</td>
  <td>The subtotal of the refund line item in shop and presentment currencies.</td>
</tr>
<tr>
  <td>total_tax_set</td>
  <td>The total tax of the line item in shop and presentment currencies.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_53Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">53. model.shopify_source.stg_shopify__order_note_attribute</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    Table storing custom attributes placed on orders.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__order_note_attribute_tmp&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">fields</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="err">{{</span>
<span class="w">            </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">fill_staging_columns</span><span class="p">(</span>
<span class="w">                </span><span class="n">source_columns</span><span class="o">=</span><span class="n">adapter</span><span class="p">.</span><span class="n">get_columns_in_relation</span><span class="p">(</span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__order_note_attribute_tmp&#39;</span><span class="p">)),</span>
<span class="w">                </span><span class="n">staging_columns</span><span class="o">=</span><span class="n">get_order_note_attribute_columns</span><span class="p">()</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">source_relation</span><span class="p">(</span>
<span class="w">            </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">base</span>
<span class="p">),</span>

<span class="k">final</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">order_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">name</span><span class="p">,</span>
<span class="w">        </span><span class="n">value</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(_fivetran_synced as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">_fivetran_synced</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span>
<span class="w">        </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">fields</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="k">final</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>_fivetran_synced</td>
  <td>The time when a record was last updated by Fivetran.</td>
</tr>
<tr>
  <td>name</td>
  <td>Name of the attribute.</td>
</tr>
<tr>
  <td>order_id</td>
  <td>ID referencing the order the note attribute belongs to.</td>
</tr>
<tr>
  <td>value</td>
  <td>Value of the attribute.</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The schema or database this record came from if you are making use of the `shopify_union_schemas` or `shopify_union_databases` variables, respectively. Empty string if you are not using either of these variables to union together multiple Shopify connectors.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_54Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">54. model.shopify_source.stg_shopify__order_shipping_line</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    Represents the shipping details that the customer chose for their order.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__order_shipping_line_tmp&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">fields</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="err">{{</span>
<span class="w">            </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">fill_staging_columns</span><span class="p">(</span>
<span class="w">                </span><span class="n">source_columns</span><span class="o">=</span><span class="n">adapter</span><span class="p">.</span><span class="n">get_columns_in_relation</span><span class="p">(</span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__order_shipping_line_tmp&#39;</span><span class="p">)),</span>
<span class="w">                </span><span class="n">staging_columns</span><span class="o">=</span><span class="n">get_order_shipping_line_columns</span><span class="p">()</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">source_relation</span><span class="p">(</span>
<span class="w">            </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">base</span>
<span class="p">),</span>

<span class="k">final</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">id</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">order_shipping_line_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">carrier_identifier</span><span class="p">,</span>
<span class="w">        </span><span class="n">code</span><span class="p">,</span>
<span class="w">        </span><span class="n">delivery_category</span><span class="p">,</span>
<span class="w">        </span><span class="n">discounted_price</span><span class="p">,</span>
<span class="w">        </span><span class="n">discounted_price_set</span><span class="p">,</span>
<span class="w">        </span><span class="n">phone</span><span class="p">,</span>
<span class="w">        </span><span class="n">price</span><span class="p">,</span>
<span class="w">        </span><span class="n">price_set</span><span class="p">,</span>
<span class="w">        </span><span class="n">requested_fulfillment_service_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">is_third_party_required</span><span class="p">,</span>
<span class="w">        </span><span class="k">source</span><span class="p">,</span>
<span class="w">        </span><span class="n">title</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(_fivetran_synced as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">_fivetran_synced</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span>
<span class="w">        </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">fields</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="k">final</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>_fivetran_synced</td>
  <td>The time when a record was last updated by Fivetran.</td>
</tr>
<tr>
  <td>carrier_identifier</td>
  <td>A reference to the carrier service that provided the rate. Present when the rate was computed by a third-party carrier service.</td>
</tr>
<tr>
  <td>code</td>
  <td>A reference to the shipping method.</td>
</tr>
<tr>
  <td>delivery_category</td>
  <td>The general classification of the delivery method.</td>
</tr>
<tr>
  <td>discounted_price</td>
  <td>The pre-tax shipping price with discounts applied in shop currency.</td>
</tr>
<tr>
  <td>discounted_price_set</td>
  <td>The pre-tax shipping price with discounts applied (JSON) in presentment and shop currencies.</td>
</tr>
<tr>
  <td>order_shipping_line_id</td>
  <td>A globally-unique identifier.</td>
</tr>
<tr>
  <td>order_id</td>
  <td>ID of the associated order.</td>
</tr>
<tr>
  <td>phone</td>
  <td>The phone number at the shipping address.</td>
</tr>
<tr>
  <td>price</td>
  <td>Returns the price of the shipping line in shop currency.</td>
</tr>
<tr>
  <td>price_set</td>
  <td>Returns the price of the shipping line (JSON) in shop and presentment currencies.</td>
</tr>
<tr>
  <td>is_third_party_required</td>
  <td>The fulfillment service requested for the shipping method. Present if the shipping method requires processing by a third party fulfillment service.</td>
</tr>
<tr>
  <td>source</td>
  <td>Returns the rate source for the shipping line.</td>
</tr>
<tr>
  <td>title</td>
  <td>Returns the title of the shipping line.</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The schema or database this record came from if you are making use of the `shopify_union_schemas` or `shopify_union_databases` variables, respectively. Empty string if you are not using either of these variables to union together multiple Shopify connectors.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_55Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">55. model.shopify_source.stg_shopify__order_shipping_tax_line</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    Represents taxes associated with order shipping lines.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__order_shipping_tax_line_tmp&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">fields</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="err">{{</span>
<span class="w">            </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">fill_staging_columns</span><span class="p">(</span>
<span class="w">                </span><span class="n">source_columns</span><span class="o">=</span><span class="n">adapter</span><span class="p">.</span><span class="n">get_columns_in_relation</span><span class="p">(</span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__order_shipping_tax_line_tmp&#39;</span><span class="p">)),</span>
<span class="w">                </span><span class="n">staging_columns</span><span class="o">=</span><span class="n">get_order_shipping_tax_line_columns</span><span class="p">()</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">source_relation</span><span class="p">(</span>
<span class="w">            </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">base</span>
<span class="p">),</span>

<span class="k">final</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">order_shipping_line_id</span><span class="p">,</span>
<span class="w">        </span><span class="k">index</span><span class="p">,</span>
<span class="w">        </span><span class="n">price</span><span class="p">,</span>
<span class="w">        </span><span class="n">price_set</span><span class="p">,</span>
<span class="w">        </span><span class="n">rate</span><span class="p">,</span>
<span class="w">        </span><span class="n">title</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(_fivetran_synced as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">_fivetran_synced</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">fields</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="k">final</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>_fivetran_synced</td>
  <td>The time when a record was last updated by Fivetran.</td>
</tr>
<tr>
  <td>index</td>
  <td>Index (from 1) representing the order of shipping lines per order.</td>
</tr>
<tr>
  <td>order_shipping_line_id</td>
  <td>ID of the order shipping line this record is associated with.</td>
</tr>
<tr>
  <td>price</td>
  <td>The amount of tax, in shop currency, after discounts and before returns.</td>
</tr>
<tr>
  <td>price_set</td>
  <td>The amount of tax, in shop and presentment currencies, after discounts and before returns (JSON).</td>
</tr>
<tr>
  <td>rate</td>
  <td>The proportion of the line item price that the tax represents as a decimal.</td>
</tr>
<tr>
  <td>title</td>
  <td>The name of the tax.</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The schema or database this record came from if you are making use of the `shopify_union_schemas` or `shopify_union_databases` variables, respectively. Empty string if you are not using either of these variables to union together multiple Shopify connectors.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_56Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">56. model.shopify_source.stg_shopify__order_tag</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    Tags that the shop owner has attached to the order.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__order_tag_tmp&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">fields</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="err">{{</span>
<span class="w">            </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">fill_staging_columns</span><span class="p">(</span>
<span class="w">                </span><span class="n">source_columns</span><span class="o">=</span><span class="n">adapter</span><span class="p">.</span><span class="n">get_columns_in_relation</span><span class="p">(</span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__order_tag_tmp&#39;</span><span class="p">)),</span>
<span class="w">                </span><span class="n">staging_columns</span><span class="o">=</span><span class="n">get_order_tag_columns</span><span class="p">()</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">source_relation</span><span class="p">(</span>
<span class="w">            </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">base</span>
<span class="p">),</span>

<span class="k">final</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">order_id</span><span class="p">,</span>
<span class="w">        </span><span class="k">index</span><span class="p">,</span>
<span class="w">        </span><span class="n">value</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(_fivetran_synced as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">_fivetran_synced</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">fields</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="k">final</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>_fivetran_synced</td>
  <td>The time when a record was last updated by Fivetran.</td>
</tr>
<tr>
  <td>index</td>
  <td>Index (starting from 1) representing when the tag was placed on the order.</td>
</tr>
<tr>
  <td>order_id</td>
  <td>ID of the order being tagged.</td>
</tr>
<tr>
  <td>value</td>
  <td>Value of the tag.</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The schema or database this record came from if you are making use of the `shopify_union_schemas` or `shopify_union_databases` variables, respectively. Empty string if you are not using either of these variables to union together multiple Shopify connectors.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_57Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">57. model.shopify_source.stg_shopify__order_url_tag</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    Key-value tags that the shop owner has attached to the order url.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__order_url_tag_tmp&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">fields</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="err">{{</span>
<span class="w">            </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">fill_staging_columns</span><span class="p">(</span>
<span class="w">                </span><span class="n">source_columns</span><span class="o">=</span><span class="n">adapter</span><span class="p">.</span><span class="n">get_columns_in_relation</span><span class="p">(</span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__order_url_tag_tmp&#39;</span><span class="p">)),</span>
<span class="w">                </span><span class="n">staging_columns</span><span class="o">=</span><span class="n">get_order_url_tag_columns</span><span class="p">()</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">source_relation</span><span class="p">(</span>
<span class="w">            </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">base</span>
<span class="p">),</span>

<span class="k">final</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">order_id</span><span class="p">,</span>
<span class="w">        </span><span class="k">key</span><span class="p">,</span>
<span class="w">        </span><span class="n">value</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(_fivetran_synced as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">_fivetran_synced</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span>
<span class="w">        </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">fields</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="k">final</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>_fivetran_synced</td>
  <td>The time when a record was last updated by Fivetran.</td>
</tr>
<tr>
  <td>key</td>
  <td>Key of the tag pair.</td>
</tr>
<tr>
  <td>order_id</td>
  <td>ID of the order url being tagged.</td>
</tr>
<tr>
  <td>value</td>
  <td>Value of the tag.</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The schema or database this record came from if you are making use of the `shopify_union_schemas` or `shopify_union_databases` variables, respectively. Empty string if you are not using either of these variables to union together multiple Shopify connectors.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_58Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">58. model.shopify_source.stg_shopify__price_rule</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    Table storing price rules. You can use price rules to create discounts dependent on conditions. Merchants can distribute the discount codes to their customers.  Using price rules, you can create discounts that specify a discount as a percentage, a fixed amount, or free shipping. You use entitlements and prerequisites to dynamically build these discounts.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__price_rule_tmp&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">fields</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="err">{{</span>
<span class="w">            </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">fill_staging_columns</span><span class="p">(</span>
<span class="w">                </span><span class="n">source_columns</span><span class="o">=</span><span class="n">adapter</span><span class="p">.</span><span class="n">get_columns_in_relation</span><span class="p">(</span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__price_rule_tmp&#39;</span><span class="p">)),</span>
<span class="w">                </span><span class="n">staging_columns</span><span class="o">=</span><span class="n">get_price_rule_columns</span><span class="p">()</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">source_relation</span><span class="p">(</span>
<span class="w">            </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">base</span>
<span class="p">),</span>

<span class="k">final</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="n">id</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">price_rule_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">allocation_limit</span><span class="p">,</span>
<span class="w">        </span><span class="n">allocation_method</span><span class="p">,</span>
<span class="w">        </span><span class="n">customer_selection</span><span class="p">,</span>
<span class="w">        </span><span class="n">once_per_customer</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">is_once_per_customer</span><span class="p">,</span>
<span class="w">        </span><span class="n">prerequisite_quantity_range</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">prereq_min_quantity</span><span class="p">,</span>
<span class="w">        </span><span class="n">prerequisite_shipping_price_range</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">prereq_max_shipping_price</span><span class="p">,</span>
<span class="w">        </span><span class="n">prerequisite_subtotal_range</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">prereq_min_subtotal</span><span class="p">,</span>
<span class="w">        </span><span class="n">prerequisite_to_entitlement_purchase_prerequisite_amount</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">prereq_min_purchase_quantity_for_entitlement</span><span class="p">,</span>
<span class="w">        </span><span class="n">quantity_ratio_entitled_quantity</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">prereq_buy_x_get_this</span><span class="p">,</span>
<span class="w">        </span><span class="n">quantity_ratio_prerequisite_quantity</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">prereq_buy_this_get_y</span><span class="p">,</span>
<span class="w">        </span><span class="n">target_selection</span><span class="p">,</span>
<span class="w">        </span><span class="n">target_type</span><span class="p">,</span>
<span class="w">        </span><span class="n">title</span><span class="p">,</span>
<span class="w">        </span><span class="n">usage_limit</span><span class="p">,</span>
<span class="w">        </span><span class="n">value</span><span class="p">,</span>
<span class="w">        </span><span class="n">value_type</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(starts_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">starts_at</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(ends_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">ends_at</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(created_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">created_at</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(updated_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">updated_at</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(_fivetran_synced as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">_fivetran_synced</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">fields</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="k">final</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>_fivetran_synced</td>
  <td>The time when a record was last updated by Fivetran.</td>
</tr>
<tr>
  <td>allocation_limit</td>
  <td>The number of times the discount can be allocated on the cart - if eligible. For example a Buy 1 hat Get 1 hat for free discount can be applied 3 times on a cart having more than 6 hats,  where maximum of 3 hats get discounted - if the allocation_limit is 3. Empty (null) allocation_limit means unlimited number of allocations.\n</td>
</tr>
<tr>
  <td>allocation_method</td>
  <td>The allocation method of the price rule. Valid values include `each` (the discount is applied to each of the entitled items. For example, for a price rule that takes $15 off, each entitled line item in a checkout will be discounted by $15) and `across` (the calculated discount amount will be applied across the entitled items. For example, for a price rule that takes $15 off, the discount will be applied across all the entitled items).\n</td>
</tr>
<tr>
  <td>created_at</td>
  <td>The date and time (ISO 8601 format) when the price rule was created.</td>
</tr>
<tr>
  <td>customer_selection</td>
  <td>The customer selection for the price rule. Valid values include `all` (the price rule is valid for all customers) and `prerequisite`  (the customer must either belong to one of the customer segments specified by customer_segment_prerequisite_ids, or be one of the customers specified by prerequisite_customer_ids).\n</td>
</tr>
<tr>
  <td>ends_at</td>
  <td>The date and time (ISO 8601 format) when the price rule ends. Must be after starts_at.</td>
</tr>
<tr>
  <td>price_rule_id</td>
  <td>The ID for the price rule.</td>
</tr>
<tr>
  <td>is_once_per_customer</td>
  <td>Boolean representing whether the generated discount code will be valid only for a single use per customer. This is tracked using customer ID.</td>
</tr>
<tr>
  <td>prereq_min_quantity</td>
  <td>If `customer_selection` is `prerequisite`, the minimum number of items for the price rule to be applicable. The quantity of an entitled cart item must be greater than or equal to this value.</td>
</tr>
<tr>
  <td>prereq_max_shipping_price</td>
  <td>If `customer_selection` is `prerequisite`, the maximum shipping price for the price rule to be applicable. The shipping price must be less than or equal to this value</td>
</tr>
<tr>
  <td>prereq_min_subtotal</td>
  <td>If `customer_selection` is `prerequisite`, the minimum subtotal for the price rule to be applicable. The subtotal of the entitled cart items must be greater than or equal to this value for the discount to apply.</td>
</tr>
<tr>
  <td>prereq_min_purchase_quantity_for_entitlement</td>
  <td>If `customer_selection` is `prerequisite`, the prerequisite purchase for a Buy X Get Y discount. The minimum purchase amount required to be entitled to the discount.</td>
</tr>
<tr>
  <td>prereq_buy_x_get_this</td>
  <td>If `customer_selection` is `prerequisite`, in a Buy/Get ratio for a Buy X Get Y discount, this is the offered 'get' quantity.</td>
</tr>
<tr>
  <td>prereq_buy_this_get_y</td>
  <td>If `customer_selection` is `prerequisite`, in a Buy/Get ratio for a Buy X Get Y discount, this defines the necessary 'buy' quantity.</td>
</tr>
<tr>
  <td>starts_at</td>
  <td>The date and time (ISO 8601 format) when the price rule starts.</td>
</tr>
<tr>
  <td>target_selection</td>
  <td>The target selection method of the price rule. Valid values include `all` (the price rule applies the discount to all line items in the checkout) and  `entitled` (the price rule applies the discount to selected entitlements only).\n</td>
</tr>
<tr>
  <td>target_type</td>
  <td>The target type that the price rule applies to. Valid values include `line_item` (the price rule applies to the cart's line items) and `shipping_line` (the price rule applies to the cart's shipping lines).</td>
</tr>
<tr>
  <td>title</td>
  <td>The title of the price rule. This is used by the Shopify admin search to retrieve discounts. It is also displayed on the Discounts page of the Shopify admin for bulk discounts.  Shopify recommends that this map onto the associated `discount_code.code`.\n</td>
</tr>
<tr>
  <td>updated_at</td>
  <td>The date and time (ISO 8601 format) when the price rule was updated.</td>
</tr>
<tr>
  <td>usage_limit</td>
  <td>The maximum number of times the price rule can be used, per discount code.</td>
</tr>
<tr>
  <td>value</td>
  <td>The value of the price rule. If if the value of `target_type` is `shipping_line`, then only -100 is accepted. The value must be negative.</td>
</tr>
<tr>
  <td>value_type</td>
  <td>The value type of the price rule. Valid values include `fixed_amount` (applies a discount of value as a unit of the store's currency. For example, if value is -30 and the store's currency is USD, then $30 USD is deducted when the discount is applied) and `percentage` (applies a percentage discount of value. For example, if value is -30, then 30% will be deducted when the discount is applied).\nIf `target_type` is `shipping_line`, then only `percentage` is accepted.\n</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The schema or database this record came from if you are making use of the `shopify_union_schemas` or `shopify_union_databases` variables, respectively. Empty string if you are not using either of these variables to union together multiple Shopify connectors.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_59Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">59. model.shopify_source.stg_shopify__product</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    Each record represents a product in Shopify.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__product_tmp&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="p">),</span>

<span class="n">fields</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">    </span>
<span class="w">        </span><span class="err">{{</span>
<span class="w">            </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">fill_staging_columns</span><span class="p">(</span>
<span class="w">                </span><span class="n">source_columns</span><span class="o">=</span><span class="n">adapter</span><span class="p">.</span><span class="n">get_columns_in_relation</span><span class="p">(</span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__product_tmp&#39;</span><span class="p">)),</span>
<span class="w">                </span><span class="n">staging_columns</span><span class="o">=</span><span class="n">get_product_columns</span><span class="p">()</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">source_relation</span><span class="p">(</span>
<span class="w">            </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">base</span>

<span class="p">),</span>

<span class="k">final</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="n">id</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">product_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">handle</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_type</span><span class="p">,</span>
<span class="w">        </span><span class="n">published_scope</span><span class="p">,</span>
<span class="w">        </span><span class="n">title</span><span class="p">,</span>
<span class="w">        </span><span class="n">vendor</span><span class="p">,</span>
<span class="w">        </span><span class="n">status</span><span class="p">,</span>
<span class="w">        </span><span class="n">_fivetran_deleted</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">is_deleted</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(created_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">created_timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(updated_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">updated_timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(published_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">published_timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(_fivetran_synced as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">_fivetran_synced</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span>

<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">fill_pass_through_columns</span><span class="p">(</span><span class="s1">&#39;product_pass_through_columns&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="k">from</span><span class="w"> </span><span class="n">fields</span>

<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="k">from</span><span class="w"> </span><span class="k">final</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>is_deleted</td>
  <td>Whether the record has been deleted in the source system.</td>
</tr>
<tr>
  <td>_fivetran_synced</td>
  <td>The time when a record was last updated by Fivetran.</td>
</tr>
<tr>
  <td>created_timestamp</td>
  <td>The date and time when the product was created.</td>
</tr>
<tr>
  <td>handle</td>
  <td>A unique human-friendly string for the product. Automatically generated from the product's title.</td>
</tr>
<tr>
  <td>product_id</td>
  <td>An unsigned 64-bit integer that's used as a unique identifier for the product. Each id is unique across the Shopify system. No two products will have the same id, even if they're from different shops.</td>
</tr>
<tr>
  <td>product_type</td>
  <td>A categorization for the product used for filtering and searching products.</td>
</tr>
<tr>
  <td>published_timestamp</td>
  <td>The date and time (ISO 8601 format) when the product was published. Can be set to null to unpublish the product from the Online Store channel.</td>
</tr>
<tr>
  <td>published_scope</td>
  <td>Whether the product is published to the Point of Sale channel.</td>
</tr>
<tr>
  <td>title</td>
  <td>The name of the product.</td>
</tr>
<tr>
  <td>updated_timestamp</td>
  <td>The date and time when the product was last modified.</td>
</tr>
<tr>
  <td>vendor</td>
  <td>The name of the product's vendor.</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The schema or database this record came from if you are making use of the `shopify_union_schemas` or `shopify_union_databases` variables, respectively. Empty string if you are not using either of these variables to union together multiple Shopify connectors.</td>
</tr>
<tr>
  <td>status</td>
  <td>The status of the product. Valid values: - active: The product is ready to sell and is available to customers on the online store, sales channels, and apps. By default, existing products are set to active. - archived: The product is no longer being sold and isn't available to customers on sales channels and apps. - draft: The product isn't ready to sell and is unavailable to customers on sales channels and apps. By default, duplicated and unarchived products are set to draft.\n</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_60Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">60. model.shopify_source.stg_shopify__product_image</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    Table storing hosted images of products.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__product_image_tmp&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">fields</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="err">{{</span>
<span class="w">            </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">fill_staging_columns</span><span class="p">(</span>
<span class="w">                </span><span class="n">source_columns</span><span class="o">=</span><span class="n">adapter</span><span class="p">.</span><span class="n">get_columns_in_relation</span><span class="p">(</span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__product_image_tmp&#39;</span><span class="p">)),</span>
<span class="w">                </span><span class="n">staging_columns</span><span class="o">=</span><span class="n">get_product_image_columns</span><span class="p">()</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">source_relation</span><span class="p">(</span>
<span class="w">            </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">base</span>
<span class="p">),</span>

<span class="k">final</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">id</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">product_image_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">height</span><span class="p">,</span>
<span class="w">        </span><span class="k">position</span><span class="p">,</span>
<span class="w">        </span><span class="n">src</span><span class="p">,</span>
<span class="w">        </span><span class="n">variant_ids</span><span class="p">,</span>
<span class="w">        </span><span class="n">width</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(created_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">created_at</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(updated_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">updated_at</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(_fivetran_synced as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">_fivetran_synced</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">fields</span>
<span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">coalesce</span><span class="p">(</span><span class="n">_fivetran_deleted</span><span class="p">,</span><span class="w"> </span><span class="k">false</span><span class="p">)</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="k">final</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>_fivetran_synced</td>
  <td>The time when a record was last updated by Fivetran.</td>
</tr>
<tr>
  <td>created_at</td>
  <td>The date and time when the product image was created. The API returns this value in ISO 8601 format.</td>
</tr>
<tr>
  <td>height</td>
  <td>Height dimension of the image which is determined on upload.</td>
</tr>
<tr>
  <td>product_image_id</td>
  <td>Unique numeric identifier of the product image.</td>
</tr>
<tr>
  <td>position</td>
  <td>The order of the product image in the list. The first product image is at position 1 and is the "main" image for the product.</td>
</tr>
<tr>
  <td>product_id</td>
  <td>The id of the product associated with the image.</td>
</tr>
<tr>
  <td>src</td>
  <td>Specifies the location of the product image. This parameter supports URL filters that you can use to retrieve modified copies of the image.</td>
</tr>
<tr>
  <td>updated_at</td>
  <td>The date and time when the product image was last modified. The API returns this value in ISO 8601 format.</td>
</tr>
<tr>
  <td>variant_ids</td>
  <td>An array of variant ids associated with the image.</td>
</tr>
<tr>
  <td>width</td>
  <td>Width dimension of the image which is determined on upload.</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The schema or database this record came from if you are making use of the `shopify_union_schemas` or `shopify_union_databases` variables, respectively. Empty string if you are not using either of these variables to union together multiple Shopify connectors.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_61Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">61. model.shopify_source.stg_shopify__product_tag</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    Tags that the shop owner has attached to the product.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__product_tag_tmp&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">fields</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="err">{{</span>
<span class="w">            </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">fill_staging_columns</span><span class="p">(</span>
<span class="w">                </span><span class="n">source_columns</span><span class="o">=</span><span class="n">adapter</span><span class="p">.</span><span class="n">get_columns_in_relation</span><span class="p">(</span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__product_tag_tmp&#39;</span><span class="p">)),</span>
<span class="w">                </span><span class="n">staging_columns</span><span class="o">=</span><span class="n">get_product_tag_columns</span><span class="p">()</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">source_relation</span><span class="p">(</span>
<span class="w">            </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">base</span>
<span class="p">),</span>

<span class="k">final</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">product_id</span><span class="p">,</span>
<span class="w">        </span><span class="k">index</span><span class="p">,</span>
<span class="w">        </span><span class="n">value</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(_fivetran_synced as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">_fivetran_synced</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">fields</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="k">final</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>_fivetran_synced</td>
  <td>The time when a record was last updated by Fivetran.</td>
</tr>
<tr>
  <td>index</td>
  <td>Index (starting from 1) representing when the tag was placed on the product.</td>
</tr>
<tr>
  <td>product_id</td>
  <td>ID of the product being tagged.</td>
</tr>
<tr>
  <td>value</td>
  <td>Value of the tag.</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The schema or database this record came from if you are making use of the `shopify_union_schemas` or `shopify_union_databases` variables, respectively. Empty string if you are not using either of these variables to union together multiple Shopify connectors.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_62Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">62. model.shopify_source.stg_shopify__product_variant</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    Each record represents a product variant in Shopify
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__product_variant_tmp&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="p">),</span>

<span class="n">fields</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">    </span>
<span class="w">        </span><span class="err">{{</span>
<span class="w">            </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">fill_staging_columns</span><span class="p">(</span>
<span class="w">                </span><span class="n">source_columns</span><span class="o">=</span><span class="n">adapter</span><span class="p">.</span><span class="n">get_columns_in_relation</span><span class="p">(</span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__product_variant_tmp&#39;</span><span class="p">)),</span>
<span class="w">                </span><span class="n">staging_columns</span><span class="o">=</span><span class="n">get_product_variant_columns</span><span class="p">()</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">source_relation</span><span class="p">(</span>
<span class="w">            </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">base</span>

<span class="p">),</span>

<span class="k">final</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="n">id</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">variant_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">inventory_item_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">image_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">title</span><span class="p">,</span>
<span class="w">        </span><span class="n">price</span><span class="p">,</span>
<span class="w">        </span><span class="n">sku</span><span class="p">,</span>
<span class="w">        </span><span class="k">position</span><span class="p">,</span>
<span class="w">        </span><span class="n">inventory_policy</span><span class="p">,</span>
<span class="w">        </span><span class="n">compare_at_price</span><span class="p">,</span>
<span class="w">        </span><span class="n">fulfillment_service</span><span class="p">,</span>
<span class="w">        </span><span class="n">inventory_management</span><span class="p">,</span>
<span class="w">        </span><span class="n">taxable</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">is_taxable</span><span class="p">,</span>
<span class="w">        </span><span class="n">barcode</span><span class="p">,</span>
<span class="w">        </span><span class="n">grams</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">inventory_quantity</span><span class="p">,</span><span class="w"> </span><span class="n">old_inventory_quantity</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">inventory_quantity</span><span class="p">,</span>
<span class="w">        </span><span class="n">weight</span><span class="p">,</span>
<span class="w">        </span><span class="n">weight_unit</span><span class="p">,</span>
<span class="w">        </span><span class="n">option_1</span><span class="p">,</span>
<span class="w">        </span><span class="n">option_2</span><span class="p">,</span>
<span class="w">        </span><span class="n">option_3</span><span class="p">,</span>
<span class="w">        </span><span class="n">tax_code</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(created_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">created_timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(updated_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">updated_timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(_fivetran_synced as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">_fivetran_synced</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span>

<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">fill_pass_through_columns</span><span class="p">(</span><span class="s1">&#39;product_variant_pass_through_columns&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">fields</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="k">from</span><span class="w"> </span><span class="k">final</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>barcode</td>
  <td>The barcode, UPC, or ISBN number for the product.</td>
</tr>
<tr>
  <td>compare_at_price</td>
  <td>The original price of the item before an adjustment or a sale in shop currency</td>
</tr>
<tr>
  <td>created_timestamp</td>
  <td>The date and time (ISO 8601 format) when the product variant was created.</td>
</tr>
<tr>
  <td>fulfillment_service</td>
  <td>The fulfillment service associated with the product variant.</td>
</tr>
<tr>
  <td>grams</td>
  <td>The weight of the product variant in grams.</td>
</tr>
<tr>
  <td>variant_id</td>
  <td>The unique numeric identifier for the product variant.</td>
</tr>
<tr>
  <td>image_id</td>
  <td>The unique numeric identifier for a product's image. The image must be associated to the same product as the variant.</td>
</tr>
<tr>
  <td>inventory_item_id</td>
  <td>The unique identifier for the inventory item, which is used in the Inventory API to query for inventory information.</td>
</tr>
<tr>
  <td>inventory_management</td>
  <td>The fulfillment service that tracks the number of items in stock for the product variant.</td>
</tr>
<tr>
  <td>inventory_policy</td>
  <td>Whether customers are allowed to place an order for the product variant when it's out of stock.</td>
</tr>
<tr>
  <td>inventory_quantity</td>
  <td>An aggregate of inventory across all locations. To adjust inventory at a specific location, use the InventoryLevel resource.</td>
</tr>
<tr>
  <td>option_1</td>
  <td>The custom properties that a shop owner uses to define product variants. You can define three options for a product variant: option1, option2, option3.</td>
</tr>
<tr>
  <td>option_2</td>
  <td>The custom properties that a shop owner uses to define product variants. You can define three options for a product variant: option1, option2, option3.</td>
</tr>
<tr>
  <td>option_3</td>
  <td>The custom properties that a shop owner uses to define product variants. You can define three options for a product variant: option1, option2, option3.</td>
</tr>
<tr>
  <td>position</td>
  <td>The order of the product variant in the list of product variants. The first position in the list is 1. The position of variants is indicated by the order in which they are listed.</td>
</tr>
<tr>
  <td>price</td>
  <td>The price of the product variant.</td>
</tr>
<tr>
  <td>product_id</td>
  <td>The unique numeric identifier for the product.</td>
</tr>
<tr>
  <td>sku</td>
  <td>A unique identifier for the product variant in the shop. Required in order to connect to a FulfillmentService.</td>
</tr>
<tr>
  <td>is_taxable</td>
  <td>Whether a tax is charged when the product variant is sold.</td>
</tr>
<tr>
  <td>tax_code</td>
  <td>This parameter applies only to the stores that have the Avalara AvaTax app installed. Specifies the Avalara tax code for the product variant.</td>
</tr>
<tr>
  <td>title</td>
  <td>The title of the product variant. The title field is a concatenation of the option1, option2, and option3 fields. You can only update title indirectly using the option fields.</td>
</tr>
<tr>
  <td>updated_timestamp</td>
  <td>The date and time when the product variant was last modified. Gets returned in ISO 8601 format.</td>
</tr>
<tr>
  <td>weight</td>
  <td>The weight of the product variant in the unit system specified with weight_unit.</td>
</tr>
<tr>
  <td>weight_unit</td>
  <td>The unit of measurement that applies to the product variant's weight. If you don't specify a value for weight_unit, then the shop's default unit of measurement is applied. Valid values: g, kg, oz, and lb.</td>
</tr>
<tr>
  <td>_fivetran_synced</td>
  <td>The time when a record was last updated by Fivetran.</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The schema or database this record came from if you are making use of the `shopify_union_schemas` or `shopify_union_databases` variables, respectively. Empty string if you are not using either of these variables to union together multiple Shopify connectors.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_63Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">63. model.shopify_source.stg_shopify__refund</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    Each record represents a refund within Shopify.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="c1">-- this model will be all NULL until you have made a refund in Shopify</span>

<span class="k">with</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__refund_tmp&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="p">),</span>

<span class="n">fields</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="err">{{</span>
<span class="w">            </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">fill_staging_columns</span><span class="p">(</span>
<span class="w">                </span><span class="n">source_columns</span><span class="o">=</span><span class="n">adapter</span><span class="p">.</span><span class="n">get_columns_in_relation</span><span class="p">(</span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__refund_tmp&#39;</span><span class="p">)),</span>
<span class="w">                </span><span class="n">staging_columns</span><span class="o">=</span><span class="n">get_refund_columns</span><span class="p">()</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">source_relation</span><span class="p">(</span>
<span class="w">            </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="err">}}</span>
<span class="w">        </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">base</span>
<span class="p">),</span>

<span class="k">final</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="n">id</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">refund_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">note</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">restock</span><span class="p">,</span>
<span class="w">        </span><span class="n">total_duties_set</span><span class="p">,</span>
<span class="w">        </span><span class="n">user_id</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(created_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">created_at</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(processed_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">processed_at</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(_fivetran_synced as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">_fivetran_synced</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">fields</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="k">from</span><span class="w"> </span><span class="k">final</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>refund_id</td>
  <td>The unique numeric identifier for the refund.</td>
</tr>
<tr>
  <td>created_at</td>
  <td>Timestamp of the date when the refund was created.</td>
</tr>
<tr>
  <td>processed_at</td>
  <td>Timestamp of the date when the refund was processed.</td>
</tr>
<tr>
  <td>note</td>
  <td>User generated note attached to the refund.</td>
</tr>
<tr>
  <td>restock</td>
  <td>Boolean indicating if the refund is a result of a restock.</td>
</tr>
<tr>
  <td>user_id</td>
  <td>Reference to the user id which generated the refund.</td>
</tr>
<tr>
  <td>_fivetran_synced</td>
  <td>The time when a record was last updated by Fivetran.</td>
</tr>
<tr>
  <td>total_duties_set</td>
  <td>Record representing total duties set for the refund.</td>
</tr>
<tr>
  <td>order_id</td>
  <td>Reference to the order which the refund is associated.</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The schema or database this record came from if you are making use of the `shopify_union_schemas` or `shopify_union_databases` variables, respectively. Empty string if you are not using either of these variables to union together multiple Shopify connectors.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_64Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">64. model.shopify_source.stg_shopify__shop</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    The Shop resource is a collection of general business and store management settings and information about the store.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__shop_tmp&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">fields</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="err">{{</span>
<span class="w">            </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">fill_staging_columns</span><span class="p">(</span>
<span class="w">                </span><span class="n">source_columns</span><span class="o">=</span><span class="n">adapter</span><span class="p">.</span><span class="n">get_columns_in_relation</span><span class="p">(</span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__shop_tmp&#39;</span><span class="p">)),</span>
<span class="w">                </span><span class="n">staging_columns</span><span class="o">=</span><span class="n">get_shop_columns</span><span class="p">()</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">source_relation</span><span class="p">(</span>
<span class="w">            </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">base</span>
<span class="p">),</span>

<span class="k">final</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">id</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">shop_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">name</span><span class="p">,</span>
<span class="w">        </span><span class="n">_fivetran_deleted</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">is_deleted</span><span class="p">,</span>
<span class="w">        </span><span class="n">address_1</span><span class="p">,</span>
<span class="w">        </span><span class="n">address_2</span><span class="p">,</span>
<span class="w">        </span><span class="n">city</span><span class="p">,</span>
<span class="w">        </span><span class="n">province</span><span class="p">,</span>
<span class="w">        </span><span class="n">province_code</span><span class="p">,</span>
<span class="w">        </span><span class="n">country</span><span class="p">,</span>
<span class="w">        </span><span class="n">country_code</span><span class="p">,</span>
<span class="w">        </span><span class="n">country_name</span><span class="p">,</span>
<span class="w">        </span><span class="n">zip</span><span class="p">,</span>
<span class="w">        </span><span class="n">latitude</span><span class="p">,</span>
<span class="w">        </span><span class="n">longitude</span><span class="p">,</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="n">county_taxes</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">false</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">county_taxes</span><span class="w"> </span><span class="k">end</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">has_county_taxes</span><span class="p">,</span>
<span class="w">        </span><span class="n">currency</span><span class="p">,</span>
<span class="w">        </span><span class="n">enabled_presentment_currencies</span><span class="p">,</span>
<span class="w">        </span><span class="n">customer_email</span><span class="p">,</span>
<span class="w">        </span><span class="n">email</span><span class="p">,</span>
<span class="w">        </span><span class="k">domain</span><span class="p">,</span>
<span class="w">        </span><span class="n">phone</span><span class="p">,</span>
<span class="w">        </span><span class="n">timezone</span><span class="p">,</span>
<span class="w">        </span><span class="n">iana_timezone</span><span class="p">,</span>
<span class="w">        </span><span class="n">primary_locale</span><span class="p">,</span>
<span class="w">        </span><span class="n">weight_unit</span><span class="p">,</span>
<span class="w">        </span><span class="n">myshopify_domain</span><span class="p">,</span>
<span class="w">        </span><span class="n">cookie_consent_level</span><span class="p">,</span>
<span class="w">        </span><span class="n">shop_owner</span><span class="p">,</span>
<span class="w">        </span><span class="k">source</span><span class="p">,</span>
<span class="w">        </span><span class="n">tax_shipping</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">has_shipping_taxes</span><span class="p">,</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="n">taxes_included</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">false</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">taxes_included</span><span class="w"> </span><span class="k">end</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">has_taxes_included_in_price</span><span class="p">,</span>
<span class="w">        </span><span class="n">has_discounts</span><span class="p">,</span>
<span class="w">        </span><span class="n">has_gift_cards</span><span class="p">,</span>
<span class="w">        </span><span class="n">has_storefront</span><span class="p">,</span>
<span class="w">        </span><span class="n">checkout_api_supported</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">has_checkout_api_supported</span><span class="p">,</span>
<span class="w">        </span><span class="n">eligible_for_card_reader_giveaway</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">is_eligible_for_card_reader_giveaway</span><span class="p">,</span>
<span class="w">        </span><span class="n">eligible_for_payments</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">is_eligible_for_payments</span><span class="p">,</span>
<span class="w">        </span><span class="n">google_apps_domain</span><span class="p">,</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="n">google_apps_login_enabled</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">false</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">google_apps_login_enabled</span><span class="w"> </span><span class="k">end</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">is_google_apps_login_enabled</span><span class="p">,</span>
<span class="w">        </span><span class="n">money_format</span><span class="p">,</span>
<span class="w">        </span><span class="n">money_in_emails_format</span><span class="p">,</span>
<span class="w">        </span><span class="n">money_with_currency_format</span><span class="p">,</span>
<span class="w">        </span><span class="n">money_with_currency_in_emails_format</span><span class="p">,</span>
<span class="w">        </span><span class="n">plan_display_name</span><span class="p">,</span>
<span class="w">        </span><span class="n">plan_name</span><span class="p">,</span>
<span class="w">        </span><span class="n">password_enabled</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">is_password_enabled</span><span class="p">,</span>
<span class="w">        </span><span class="n">pre_launch_enabled</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">is_pre_launch_enabled</span><span class="p">,</span>
<span class="w">        </span><span class="n">requires_extra_payments_agreement</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">is_extra_payments_agreement_required</span><span class="p">,</span>
<span class="w">        </span><span class="n">setup_required</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">is_setup_required</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(created_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">created_at</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(updated_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">updated_at</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(_fivetran_synced as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">_fivetran_synced</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">fields</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="k">final</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>is_deleted</td>
  <td>Boolean representing whether the record was soft-deleted in Shopify.</td>
</tr>
<tr>
  <td>_fivetran_synced</td>
  <td>The time when a record was last updated by Fivetran.</td>
</tr>
<tr>
  <td>address_1</td>
  <td>The shop's street address.</td>
</tr>
<tr>
  <td>address_2</td>
  <td>The optional second line of the shop's street address.</td>
</tr>
<tr>
  <td>has_checkout_api_supported</td>
  <td>Boolean representing whether the shop is capable of accepting payments directly through the Checkout API.</td>
</tr>
<tr>
  <td>city</td>
  <td>The shop's city.</td>
</tr>
<tr>
  <td>cookie_consent_level</td>
  <td>The cookie consent level defined on the shop's online store.</td>
</tr>
<tr>
  <td>country</td>
  <td>The shop's country. In most cases, this value matches the country_code.</td>
</tr>
<tr>
  <td>country_code</td>
  <td>The two-letter country code corresponding to the shop's country.</td>
</tr>
<tr>
  <td>country_name</td>
  <td>The shop's normalized country name.</td>
</tr>
<tr>
  <td>has_county_taxes</td>
  <td>Boolean representing whether the shop is applying taxes on a per-county basis. Only applicable to shops based in the US. Either `true` or `null` (not false, according to Shopify API docs).</td>
</tr>
<tr>
  <td>created_at</td>
  <td>The date and time (ISO 8601) when the shop was created.</td>
</tr>
<tr>
  <td>currency</td>
  <td>The three-letter code (ISO 4217 format) for the shop's default currency.</td>
</tr>
<tr>
  <td>customer_email</td>
  <td>The contact email used for communication between the shop owner and the customer.</td>
</tr>
<tr>
  <td>domain</td>
  <td>The shop's domain.</td>
</tr>
<tr>
  <td>is_eligible_for_card_reader_giveaway</td>
  <td>Boolean representing whether the shop is eligible to receive a free credit card reader from Shopify.</td>
</tr>
<tr>
  <td>is_eligible_for_payments</td>
  <td>Boolean representing whether the shop is eligible to use Shopify Payments.</td>
</tr>
<tr>
  <td>email</td>
  <td>The contact email used for communication between Shopify and the shop owner.</td>
</tr>
<tr>
  <td>enabled_presentment_currencies</td>
  <td>An array of of enabled currencies (ISO 4217 format) that the shop accepts. Merchants can enable currencies from their Shopify Payments settings in the Shopify Admin.</td>
</tr>
<tr>
  <td>google_apps_domain</td>
  <td>The GSuite URL for the store, if applicable.</td>
</tr>
<tr>
  <td>is_google_apps_login_enabled</td>
  <td>Boolean representing whether the GSuite login is enabled. Shops with this feature will be able to log in through the GSuite login page. Valid values are `true` and `null`.</td>
</tr>
<tr>
  <td>has_discounts</td>
  <td>Boolean representing whether any active discounts exist for the shop.</td>
</tr>
<tr>
  <td>has_gift_cards</td>
  <td>Boolean representing whether any active gift cards exist for the shop.</td>
</tr>
<tr>
  <td>has_storefront</td>
  <td>Boolean representing whether this shop has an online store.</td>
</tr>
<tr>
  <td>iana_timezone</td>
  <td>The name of the timezone assigned by the [IANA](https://www.iana.org/time-zones).</td>
</tr>
<tr>
  <td>shop_id</td>
  <td>The ID for the shop. A 64-bit unsigned integer.</td>
</tr>
<tr>
  <td>latitude</td>
  <td>The latitude of the shop's location.</td>
</tr>
<tr>
  <td>longitude</td>
  <td>The longitude of the shop's location.</td>
</tr>
<tr>
  <td>money_format</td>
  <td>A string representing the way currency is formatted when the currency isn't specified.</td>
</tr>
<tr>
  <td>money_in_emails_format</td>
  <td>A string representing the way currency is formatted in email notifications when the currency isn't specified.</td>
</tr>
<tr>
  <td>money_with_currency_format</td>
  <td>A string representing the way currency is formatted when the currency is specified.</td>
</tr>
<tr>
  <td>money_with_currency_in_emails_format</td>
  <td>A string representing the way currency is formatted in email notifications when the currency is specified.</td>
</tr>
<tr>
  <td>myshopify_domain</td>
  <td>The shop's .myshopify.com domain.</td>
</tr>
<tr>
  <td>name</td>
  <td>The name of the shop.</td>
</tr>
<tr>
  <td>is_password_enabled</td>
  <td>Boolean representing whether the password protection page is enabled on the shop's online store.</td>
</tr>
<tr>
  <td>phone</td>
  <td>The contact phone number for the shop.</td>
</tr>
<tr>
  <td>plan_display_name</td>
  <td>The display name of the Shopify plan the shop is on.</td>
</tr>
<tr>
  <td>plan_name</td>
  <td>The name of the Shopify plan the shop is on.</td>
</tr>
<tr>
  <td>is_pre_launch_enabled</td>
  <td>Boolean representing whether the pre-launch page is enabled on the shop's online store.</td>
</tr>
<tr>
  <td>primary_locale</td>
  <td>The shop's primary locale, as configured in the language settings of the shop's theme.</td>
</tr>
<tr>
  <td>province</td>
  <td>The shop's normalized province or state name.</td>
</tr>
<tr>
  <td>province_code</td>
  <td>The two- or three-letter code for the shop's province or state.</td>
</tr>
<tr>
  <td>is_extra_payments_agreement_required</td>
  <td>Boolean representing whether the shop requires an extra Shopify Payments agreement.</td>
</tr>
<tr>
  <td>is_setup_required</td>
  <td>Boolean representing whether the shop has any outstanding setup steps.</td>
</tr>
<tr>
  <td>shop_owner</td>
  <td>The username of the shop owner.</td>
</tr>
<tr>
  <td>source</td>
  <td>The handle of the partner account that referred the merchant to Shopify, if applicable.</td>
</tr>
<tr>
  <td>has_shipping_taxes</td>
  <td>Boolean representing whether taxes are charged for shipping. Valid values are true or false.</td>
</tr>
<tr>
  <td>has_taxes_included_in_price</td>
  <td>Boolean representing whether applicable taxes are included in product prices. Valid values are true or null.</td>
</tr>
<tr>
  <td>timezone</td>
  <td>The name of the timezone the shop is in.</td>
</tr>
<tr>
  <td>updated_at</td>
  <td>The date and time (ISO 8601) when the shop was last updated.</td>
</tr>
<tr>
  <td>weight_unit</td>
  <td>The default unit of weight measurement for the shop.</td>
</tr>
<tr>
  <td>zip</td>
  <td>The shop's zip or postal code.</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The schema or database this record came from if you are making use of the `shopify_union_schemas` or `shopify_union_databases` variables, respectively. Empty string if you are not using either of these variables to union together multiple Shopify connectors.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_65Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">65. model.shopify_source.stg_shopify__tax_line</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    Represents a single tax applied to the associated line item.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__tax_line_tmp&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">fields</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="err">{{</span>
<span class="w">            </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">fill_staging_columns</span><span class="p">(</span>
<span class="w">                </span><span class="n">source_columns</span><span class="o">=</span><span class="n">adapter</span><span class="p">.</span><span class="n">get_columns_in_relation</span><span class="p">(</span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__tax_line_tmp&#39;</span><span class="p">)),</span>
<span class="w">                </span><span class="n">staging_columns</span><span class="o">=</span><span class="n">get_tax_line_columns</span><span class="p">()</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="err">}}</span>
<span class="w">    </span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">source_relation</span><span class="p">(</span>
<span class="w">            </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">base</span>
<span class="p">),</span>

<span class="k">final</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="k">index</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_line_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">price</span><span class="p">,</span>
<span class="w">        </span><span class="n">price_set</span><span class="p">,</span>
<span class="w">        </span><span class="n">rate</span><span class="p">,</span>
<span class="w">        </span><span class="n">title</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(_fivetran_synced as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">_fivetran_synced</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">fields</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="k">final</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>_fivetran_synced</td>
  <td>The time when a record was last updated by Fivetran.</td>
</tr>
<tr>
  <td>index</td>
  <td>The index of the tax line.</td>
</tr>
<tr>
  <td>order_line_id</td>
  <td>The order line that this tax line is associated with.</td>
</tr>
<tr>
  <td>price</td>
  <td>The amount of tax, in shop currency, after discounts and before returns.</td>
</tr>
<tr>
  <td>price_set</td>
  <td>The amount of tax, in shop and presentment currencies, after discounts and before returns.</td>
</tr>
<tr>
  <td>rate</td>
  <td>The proportion of the line item price that the tax represents as a decimal.</td>
</tr>
<tr>
  <td>title</td>
  <td>The name of the tax.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_66Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">66. model.shopify_source.stg_shopify__tender_transaction</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    Each tender transaction represents money passing between the merchant and a customer. A tender transaction with a positive amount  represents a transaction where the customer paid money to the merchant. A negative amount represents a transaction where the  merchant refunded money back to the customer. Tender transactions represent transactions that modify the shop's balance.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__tender_transaction_tmp&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">fields</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="err">{{</span>
<span class="w">            </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">fill_staging_columns</span><span class="p">(</span>
<span class="w">                </span><span class="n">source_columns</span><span class="o">=</span><span class="n">adapter</span><span class="p">.</span><span class="n">get_columns_in_relation</span><span class="p">(</span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__tender_transaction_tmp&#39;</span><span class="p">)),</span>
<span class="w">                </span><span class="n">staging_columns</span><span class="o">=</span><span class="n">get_tender_transaction_columns</span><span class="p">()</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">source_relation</span><span class="p">(</span>
<span class="w">            </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">base</span>
<span class="p">),</span>

<span class="k">final</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">id</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">transaction_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">amount</span><span class="p">,</span>
<span class="w">        </span><span class="n">currency</span><span class="p">,</span>
<span class="w">        </span><span class="n">payment_method</span><span class="p">,</span>
<span class="w">        </span><span class="n">remote_reference</span><span class="p">,</span>
<span class="w">        </span><span class="n">user_id</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(processed_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">processed_at</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(_fivetran_synced as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">_fivetran_synced</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">fields</span>
<span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">coalesce</span><span class="p">(</span><span class="n">test</span><span class="p">,</span><span class="w"> </span><span class="k">false</span><span class="p">)</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="k">final</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>_fivetran_synced</td>
  <td>The time when a record was last updated by Fivetran.</td>
</tr>
<tr>
  <td>amount</td>
  <td>The amount of the tender transaction in the shop's currency.</td>
</tr>
<tr>
  <td>currency</td>
  <td>The three-letter code (ISO 4217 format) for the currency used for the tender transaction.</td>
</tr>
<tr>
  <td>transaction_id</td>
  <td>The ID of the transaction.</td>
</tr>
<tr>
  <td>order_id</td>
  <td>The ID of the order that the tender transaction belongs to.</td>
</tr>
<tr>
  <td>payment_method</td>
  <td>Information about the payment method used for this transaction. Valid values include: - credit_card - cash - android_pay - apple_pay - google_pay - samsung_pay - shopify_pay - amazon - klarna - paypal - unknown - other\n</td>
</tr>
<tr>
  <td>processed_at</td>
  <td>The date and time (ISO 8601 format) when the tender transaction was processed.</td>
</tr>
<tr>
  <td>remote_reference</td>
  <td>The remote (gateway) reference associated with the tender.</td>
</tr>
<tr>
  <td>user_id</td>
  <td>The ID of the user logged into the Shopify POS device that processed the tender transaction, if applicable.</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The schema or database this record came from if you are making use of the `shopify_union_schemas` or `shopify_union_databases` variables, respectively. Empty string if you are not using either of these variables to union together multiple Shopify connectors.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_67Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">67. model.shopify_source.stg_shopify__transaction</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    Each record represents a transaction in Shopify.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__transaction_tmp&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="p">),</span>

<span class="n">fields</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>

<span class="w">        </span><span class="err">{{</span>
<span class="w">            </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">fill_staging_columns</span><span class="p">(</span>
<span class="w">                </span><span class="n">source_columns</span><span class="o">=</span><span class="n">adapter</span><span class="p">.</span><span class="n">get_columns_in_relation</span><span class="p">(</span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__transaction_tmp&#39;</span><span class="p">)),</span>
<span class="w">                </span><span class="n">staging_columns</span><span class="o">=</span><span class="n">get_transaction_columns</span><span class="p">()</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">source_relation</span><span class="p">(</span>
<span class="w">            </span><span class="n">union_schema_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_schemas&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="n">union_database_variable</span><span class="o">=</span><span class="s1">&#39;shopify_union_databases&#39;</span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="err">}}</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">base</span>

<span class="p">),</span>

<span class="k">final</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">id</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">transaction_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">refund_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">amount</span><span class="p">,</span>
<span class="w">        </span><span class="n">device_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">gateway</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_name</span><span class="p">,</span>
<span class="w">        </span><span class="n">message</span><span class="p">,</span>
<span class="w">        </span><span class="n">currency</span><span class="p">,</span>
<span class="w">        </span><span class="n">location_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">parent_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">payment_avs_result_code</span><span class="p">,</span>
<span class="w">        </span><span class="n">payment_credit_card_bin</span><span class="p">,</span>
<span class="w">        </span><span class="n">payment_cvv_result_code</span><span class="p">,</span>
<span class="w">        </span><span class="n">payment_credit_card_number</span><span class="p">,</span>
<span class="w">        </span><span class="n">payment_credit_card_company</span><span class="p">,</span>
<span class="w">        </span><span class="n">kind</span><span class="p">,</span>
<span class="w">        </span><span class="n">receipt</span><span class="p">,</span>
<span class="w">        </span><span class="n">currency_exchange_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">currency_exchange_adjustment</span><span class="p">,</span>
<span class="w">        </span><span class="n">currency_exchange_original_amount</span><span class="p">,</span>
<span class="w">        </span><span class="n">currency_exchange_final_amount</span><span class="p">,</span>
<span class="w">        </span><span class="n">currency_exchange_currency</span><span class="p">,</span>
<span class="w">        </span><span class="n">error_code</span><span class="p">,</span>
<span class="w">        </span><span class="n">status</span><span class="p">,</span>
<span class="w">        </span><span class="n">user_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">authorization_code</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(created_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">created_timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(processed_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">processed_timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(authorization_expires_at as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">authorization_expires_at</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_date</span><span class="p">.</span><span class="n">convert_timezone</span><span class="p">(</span><span class="k">column</span><span class="o">=</span><span class="s1">&#39;cast(_fivetran_synced as &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">target_tz</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_timezone&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;UTC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">source_tz</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">_fivetran_synced</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span>

<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">fill_pass_through_columns</span><span class="p">(</span><span class="s1">&#39;transaction_pass_through_columns&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">fields</span>
<span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">coalesce</span><span class="p">(</span><span class="n">test</span><span class="p">,</span><span class="w"> </span><span class="k">false</span><span class="p">)</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="k">from</span><span class="w"> </span><span class="k">final</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>transaction_id</td>
  <td>The ID for the transaction.</td>
</tr>
<tr>
  <td>order_id</td>
  <td>The ID for the order that the transaction is associated with.</td>
</tr>
<tr>
  <td>refund_id</td>
  <td>The ID associated with a refund in the refund table.</td>
</tr>
<tr>
  <td>amount</td>
  <td>The amount of money included in the transaction.</td>
</tr>
<tr>
  <td>authorization_code</td>
  <td>The authorization code associated with the transaction.</td>
</tr>
<tr>
  <td>created_timestamp</td>
  <td>The date and time when the transaction was created.</td>
</tr>
<tr>
  <td>processed_timestamp</td>
  <td>The date and time when a transaction was processed.</td>
</tr>
<tr>
  <td>device_id</td>
  <td>The ID for the device.</td>
</tr>
<tr>
  <td>gateway</td>
  <td>The name of the gateway the transaction was issued through.</td>
</tr>
<tr>
  <td>source_name</td>
  <td>The origin of the transaction.</td>
</tr>
<tr>
  <td>message</td>
  <td>A string generated by the payment provider with additional information about why the transaction succeeded or failed.</td>
</tr>
<tr>
  <td>currency</td>
  <td>The three-letter code (ISO 4217 format) for the currency used for the payment.</td>
</tr>
<tr>
  <td>location_id</td>
  <td>The ID of the physical location where the transaction was processed.</td>
</tr>
<tr>
  <td>parent_id</td>
  <td>The ID of an associated transaction.</td>
</tr>
<tr>
  <td>payment_avs_result_code</td>
  <td>The response code from the address verification system.</td>
</tr>
<tr>
  <td>payment_credit_card_bin</td>
  <td>The issuer identification number (IIN), formerly known as bank identification number (BIN) of the customer's credit card.</td>
</tr>
<tr>
  <td>payment_cvv_result_code</td>
  <td>The response code from the credit card company indicating whether the customer entered the card security code, or card verification value, correctly.</td>
</tr>
<tr>
  <td>payment_credit_card_number</td>
  <td>The customer's credit card number, with most of the leading digits redacted.</td>
</tr>
<tr>
  <td>payment_credit_card_company</td>
  <td>The name of the company that issued the customer's credit card.</td>
</tr>
<tr>
  <td>kind</td>
  <td>The transaction's type.</td>
</tr>
<tr>
  <td>receipt</td>
  <td>A transaction receipt attached to the transaction by the gateway.</td>
</tr>
<tr>
  <td>currency_exchange_id</td>
  <td>The ID of the adjustment.</td>
</tr>
<tr>
  <td>currency_exchange_adjustment</td>
  <td>The difference between the amounts on the associated transaction and the parent transaction.</td>
</tr>
<tr>
  <td>currency_exchange_original_amount</td>
  <td>The amount of the parent transaction in the shop currency.</td>
</tr>
<tr>
  <td>currency_exchange_final_amount</td>
  <td>The amount of the associated transaction in the shop currency.</td>
</tr>
<tr>
  <td>currency_exchange_currency</td>
  <td>The shop currency.</td>
</tr>
<tr>
  <td>error_code</td>
  <td>A standardized error code, independent of the payment provider.</td>
</tr>
<tr>
  <td>status</td>
  <td>The status of the transaction.</td>
</tr>
<tr>
  <td>test</td>
  <td>Whether the transaction is a test transaction.</td>
</tr>
<tr>
  <td>user_id</td>
  <td>The ID for the user who was logged into the Shopify POS device when the order was processed, if applicable.</td>
</tr>
<tr>
  <td>_fivetran_synced</td>
  <td>The time when a record was last updated by Fivetran.</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The schema or database this record came from if you are making use of the `shopify_union_schemas` or `shopify_union_databases` variables, respectively. Empty string if you are not using either of these variables to union together multiple Shopify connectors.</td>
</tr>
<tr>
  <td>authorization_expires_at</td>
  <td>The date and time (ISO 8601 format) when the Shopify Payments authorization expires.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_68Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">68. model.shopify.int_shopify__daily_abandoned_checkouts</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">abandoned_checkout</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_abandoned_checkout&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="w">    </span><span class="c1">-- &quot;deleted&quot; abandoned checkouts do not appear to have any data tying them to customers,</span>
<span class="w">    </span><span class="c1">-- discounts, or products (and should therefore not get joined in) but let&#39;s filter them out here</span>
<span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">coalesce</span><span class="p">(</span><span class="n">is_deleted</span><span class="p">,</span><span class="w"> </span><span class="k">false</span><span class="p">)</span>
<span class="p">),</span>

<span class="n">abandoned_checkout_aggregates</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="k">cast</span><span class="p">(</span><span class="err">{{</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">date_trunc</span><span class="p">(</span><span class="s1">&#39;day&#39;</span><span class="p">,</span><span class="s1">&#39;created_at&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nb">date</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">date_day</span><span class="p">,</span>
<span class="w">        </span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">checkout_id</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_abandoned_checkouts</span><span class="p">,</span>
<span class="w">        </span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">customer_id</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_customers_abandoned_checkout</span><span class="p">,</span>
<span class="w">        </span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">email</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_customer_emails_abandoned_checkout</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">abandoned_checkout</span>
<span class="w">    </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="k">from</span><span class="w"> </span><span class="n">abandoned_checkout_aggregates</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_69Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">69. model.shopify.int_shopify__customer_email_rollup</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">customers</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="o">*</span><span class="p">,</span>
<span class="w">        </span><span class="n">row_number</span><span class="p">()</span><span class="w"> </span><span class="n">over</span><span class="p">(</span>
<span class="w">            </span><span class="n">partition</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">shopify</span><span class="p">.</span><span class="n">shopify_partition_by_cols</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;source_relation&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="w">            </span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">created_timestamp</span><span class="w"> </span><span class="k">desc</span><span class="p">)</span><span class="w"> </span>
<span class="w">            </span><span class="k">as</span><span class="w"> </span><span class="n">customer_index</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_customer&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="n">email</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="c1">-- nonsensical to include any null emails here</span>

<span class="p">),</span><span class="w"> </span><span class="n">customer_tags</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_customer_tag&#39;</span><span class="w"> </span><span class="p">)</span><span class="err">}}</span>

<span class="p">),</span><span class="w"> </span><span class="n">rollup_customers</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="c1">-- fields to group by</span>
<span class="w">        </span><span class="k">lower</span><span class="p">(</span><span class="n">customers</span><span class="p">.</span><span class="n">email</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">email</span><span class="p">,</span>
<span class="w">        </span><span class="n">customers</span><span class="p">.</span><span class="n">source_relation</span><span class="p">,</span>

<span class="w">        </span><span class="c1">-- fields to string agg together</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">string_agg</span><span class="p">(</span><span class="ss">&quot;distinct cast(customers.customer_id as &quot;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_string</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="ss">&quot;)&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;&#39;, &#39;&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">customer_ids</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">string_agg</span><span class="p">(</span><span class="ss">&quot;distinct cast(customers.phone as &quot;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_string</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="ss">&quot;)&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;&#39;, &#39;&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">phone_numbers</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">string_agg</span><span class="p">(</span><span class="ss">&quot;distinct cast(customer_tags.value as &quot;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_string</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="ss">&quot;)&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;&#39;, &#39;&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">customer_tags</span><span class="p">,</span>

<span class="w">        </span><span class="c1">-- fields to take aggregates of</span>
<span class="w">        </span><span class="k">min</span><span class="p">(</span><span class="n">customers</span><span class="p">.</span><span class="n">created_timestamp</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">first_account_created_at</span><span class="p">,</span>
<span class="w">        </span><span class="k">max</span><span class="p">(</span><span class="n">customers</span><span class="p">.</span><span class="n">created_timestamp</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">last_account_created_at</span><span class="p">,</span>
<span class="w">        </span><span class="k">max</span><span class="p">(</span><span class="n">customers</span><span class="p">.</span><span class="n">updated_timestamp</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">last_updated_at</span><span class="p">,</span>
<span class="w">        </span><span class="k">max</span><span class="p">(</span><span class="n">customers</span><span class="p">.</span><span class="n">marketing_consent_updated_at</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">marketing_consent_updated_at</span><span class="p">,</span>
<span class="w">        </span><span class="k">max</span><span class="p">(</span><span class="n">customers</span><span class="p">.</span><span class="n">_fivetran_synced</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">last_fivetran_synced</span><span class="p">,</span>

<span class="w">        </span><span class="c1">-- take true if ever given for boolean fields</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">max_bool</span><span class="p">(</span><span class="ss">&quot;case when customers.customer_index = 1 then customers.is_tax_exempt else null end&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">is_tax_exempt</span><span class="p">,</span><span class="w"> </span><span class="c1">-- since this changes every year</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">max_bool</span><span class="p">(</span><span class="ss">&quot;customers.is_verified_email&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">is_verified_email</span>

<span class="w">        </span><span class="c1">-- for all other fields, just take the latest value</span>
<span class="w">        </span><span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="n">cols</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">adapter</span><span class="p">.</span><span class="n">get_columns_in_relation</span><span class="p">(</span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__customer&#39;</span><span class="p">))</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
<span class="w">        </span><span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="n">except_cols</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;_fivetran_synced&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;email&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;source_relation&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;customer_id&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;phone&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;created_at&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                </span><span class="s1">&#39;marketing_consent_updated_at&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;orders_count&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;total_spent&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;created_timestamp&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;updated_timestamp&#39;</span><span class="p">,</span>
<span class="w">                                </span><span class="s1">&#39;is_tax_exempt&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;is_verified_email&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
<span class="w">        </span><span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">cols</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
<span class="w">            </span><span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">col</span><span class="p">.</span><span class="k">column</span><span class="o">|</span><span class="k">lower</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">except_cols</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
<span class="w">            </span><span class="p">,</span><span class="w"> </span><span class="k">max</span><span class="p">(</span><span class="k">case</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="n">customers</span><span class="p">.</span><span class="n">customer_index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">customers</span><span class="p">.</span><span class="err">{{</span><span class="w"> </span><span class="n">col</span><span class="p">.</span><span class="k">column</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="k">end</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">col</span><span class="p">.</span><span class="k">column</span><span class="w"> </span><span class="err">}}</span>
<span class="w">            </span><span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="n">endif</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
<span class="w">        </span><span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="n">endfor</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">customers</span><span class="w"> </span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">customer_tags</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">customers</span><span class="p">.</span><span class="n">customer_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">customer_tags</span><span class="p">.</span><span class="n">customer_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">customers</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">customer_tags</span><span class="p">.</span><span class="n">source_relation</span>

<span class="w">    </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>

<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="n">rollup_customers</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_70Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">70. model.shopify.int_shopify__order__shipping_aggregates</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">order_shipping_line</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="n">order_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_shipping_line_id</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">price</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">shipping_price</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">discounted_price</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">discounted_shipping_price</span>
<span class="w">        </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_order_shipping_line&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="w">    </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span>

<span class="p">),</span><span class="w"> </span><span class="n">order_shipping_tax_line</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="n">order_shipping_line_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">price</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">shipping_tax</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_order_shipping_tax_line&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="w">    </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="w"> </span>

<span class="p">),</span><span class="w"> </span><span class="n">aggregated</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">order_shipping_line</span><span class="p">.</span><span class="n">order_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_shipping_line</span><span class="p">.</span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">order_shipping_line</span><span class="p">.</span><span class="n">shipping_price</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">shipping_price</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">order_shipping_line</span><span class="p">.</span><span class="n">discounted_shipping_price</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">discounted_shipping_price</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">order_shipping_tax_line</span><span class="p">.</span><span class="n">shipping_tax</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">shipping_tax</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">order_shipping_line</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">order_shipping_tax_line</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">order_shipping_line</span><span class="p">.</span><span class="n">order_shipping_line_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">order_shipping_tax_line</span><span class="p">.</span><span class="n">order_shipping_line_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">order_shipping_line</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">order_shipping_tax_line</span><span class="p">.</span><span class="n">source_relation</span>
<span class="w">    </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="k">from</span><span class="w"> </span><span class="n">aggregated</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_71Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">71. model.shopify.shopify__orders__order_refunds</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">refunds</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_refund&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="p">),</span><span class="w"> </span><span class="n">order_line_refunds</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_order_line_refund&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="w">    </span>
<span class="p">),</span><span class="w"> </span><span class="n">refund_join</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">refunds</span><span class="p">.</span><span class="n">refund_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">refunds</span><span class="p">.</span><span class="n">created_at</span><span class="p">,</span>
<span class="w">        </span><span class="n">refunds</span><span class="p">.</span><span class="n">order_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">refunds</span><span class="p">.</span><span class="n">user_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">refunds</span><span class="p">.</span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_line_refunds</span><span class="p">.</span><span class="n">order_line_refund_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_line_refunds</span><span class="p">.</span><span class="n">order_line_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_line_refunds</span><span class="p">.</span><span class="n">restock_type</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_line_refunds</span><span class="p">.</span><span class="n">quantity</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_line_refunds</span><span class="p">.</span><span class="n">subtotal</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_line_refunds</span><span class="p">.</span><span class="n">total_tax</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">refunds</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">order_line_refunds</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">refunds</span><span class="p">.</span><span class="n">refund_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">order_line_refunds</span><span class="p">.</span><span class="n">refund_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">refunds</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">order_line_refunds</span><span class="p">.</span><span class="n">source_relation</span>

<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="n">refund_join</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_72Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">72. model.shopify.shopify__transactions</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    Each record represents a transaction in Shopify.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="err">{{</span>
<span class="w">    </span><span class="n">config</span><span class="p">(</span>
<span class="w">        </span><span class="n">materialized</span><span class="o">=</span><span class="s1">&#39;table&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">target</span><span class="p">.</span><span class="k">type</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;bigquery&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;databricks&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;spark&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;incremental&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">unique_key</span><span class="o">=</span><span class="s1">&#39;transactions_unique_id&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">incremental_strategy</span><span class="o">=</span><span class="s1">&#39;delete+insert&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">target</span><span class="p">.</span><span class="k">type</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;postgres&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;redshift&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;snowflake&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;merge&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">cluster_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;transaction_id&#39;</span><span class="p">]</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span>
<span class="err">}}</span>

<span class="k">with</span><span class="w"> </span><span class="n">transactions</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="o">*</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_utils</span><span class="p">.</span><span class="n">generate_surrogate_key</span><span class="p">([</span><span class="s1">&#39;source_relation&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;transaction_id&#39;</span><span class="p">])</span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">transactions_unique_id</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_transaction&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="w">    </span><span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">is_incremental</span><span class="p">()</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
<span class="c1">-- use created_timestamp instead of processed_at since a record could be created but not processed</span>
<span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="k">cast</span><span class="p">(</span><span class="n">created_timestamp</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nb">date</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">shopify</span><span class="p">.</span><span class="n">shopify_lookback</span><span class="p">(</span><span class="n">from_date</span><span class="o">=</span><span class="ss">&quot;max(cast(created_timestamp as date))&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">interval</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;lookback_window&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">),</span><span class="w"> </span><span class="n">datepart</span><span class="o">=</span><span class="s1">&#39;day&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="w">    </span><span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="n">endif</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>

<span class="p">),</span><span class="w"> </span><span class="n">tender_transactions</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_tender_transaction&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="p">),</span><span class="w"> </span><span class="n">joined</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">transactions</span><span class="p">.</span><span class="o">*</span><span class="p">,</span>
<span class="w">        </span><span class="n">tender_transactions</span><span class="p">.</span><span class="n">payment_method</span><span class="p">,</span>
<span class="w">        </span><span class="n">parent_transactions</span><span class="p">.</span><span class="n">created_timestamp</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">parent_created_timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="n">parent_transactions</span><span class="p">.</span><span class="n">kind</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">parent_kind</span><span class="p">,</span>
<span class="w">        </span><span class="n">parent_transactions</span><span class="p">.</span><span class="n">amount</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">parent_amount</span><span class="p">,</span>
<span class="w">        </span><span class="n">parent_transactions</span><span class="p">.</span><span class="n">status</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">parent_status</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">transactions</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">tender_transactions</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">transactions</span><span class="p">.</span><span class="n">transaction_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tender_transactions</span><span class="p">.</span><span class="n">transaction_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">transactions</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tender_transactions</span><span class="p">.</span><span class="n">source_relation</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">transactions</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">parent_transactions</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">transactions</span><span class="p">.</span><span class="n">parent_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parent_transactions</span><span class="p">.</span><span class="n">transaction_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">transactions</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parent_transactions</span><span class="p">.</span><span class="n">source_relation</span>

<span class="p">),</span><span class="w"> </span><span class="n">exchange_rate</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="o">*</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="k">cast</span><span class="p">(</span><span class="k">nullif</span><span class="p">(</span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">json_parse</span><span class="p">(</span><span class="ss">&quot;receipt&quot;</span><span class="p">,[</span><span class="ss">&quot;charges&quot;</span><span class="p">,</span><span class="ss">&quot;data&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="ss">&quot;balance_transaction&quot;</span><span class="p">,</span><span class="ss">&quot;exchange_rate&quot;</span><span class="p">])</span><span class="w"> </span><span class="err">}}</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_numeric</span><span class="p">()</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">exchange_rate</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="k">cast</span><span class="p">(</span><span class="k">nullif</span><span class="p">(</span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">json_parse</span><span class="p">(</span><span class="ss">&quot;receipt&quot;</span><span class="p">,[</span><span class="ss">&quot;charges&quot;</span><span class="p">,</span><span class="ss">&quot;data&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="ss">&quot;balance_transaction&quot;</span><span class="p">,</span><span class="ss">&quot;exchange_rate&quot;</span><span class="p">])</span><span class="w"> </span><span class="err">}}</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_numeric</span><span class="p">()</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">currency_exchange_calculated_amount</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">joined</span>

<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="n">exchange_rate</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>transactions_unique_id</td>
  <td>Unique key representing a transaction. Hashed on 'transaction_id' and 'source_relation'.</td>
</tr>
<tr>
  <td>transaction_id</td>
  <td>The ID for the transaction.</td>
</tr>
<tr>
  <td>order_id</td>
  <td>The ID for the order that the transaction is associated with.</td>
</tr>
<tr>
  <td>refund_id</td>
  <td>The ID associated with a refund in the refund table.</td>
</tr>
<tr>
  <td>amount</td>
  <td>The amount of money included in the transaction in shop currency.</td>
</tr>
<tr>
  <td>authorization</td>
  <td>The authorization code associated with the transaction.</td>
</tr>
<tr>
  <td>created_timestamp</td>
  <td>The date and time when the transaction was created.</td>
</tr>
<tr>
  <td>processed_timestamp</td>
  <td>The date and time when a transaction was processed.</td>
</tr>
<tr>
  <td>device_id</td>
  <td>The ID for the device.</td>
</tr>
<tr>
  <td>gateway</td>
  <td>The name of the gateway the transaction was issued through.</td>
</tr>
<tr>
  <td>source_name</td>
  <td>The origin of the transaction.</td>
</tr>
<tr>
  <td>message</td>
  <td>A string generated by the payment provider with additional information about why the transaction succeeded or failed.</td>
</tr>
<tr>
  <td>currency</td>
  <td>The three-letter code (ISO 4217 format) for the currency used for the payment.</td>
</tr>
<tr>
  <td>location_id</td>
  <td>The ID of the physical location where the transaction was processed.</td>
</tr>
<tr>
  <td>parent_id</td>
  <td>The ID of an associated transaction.</td>
</tr>
<tr>
  <td>payment_avs_result_code</td>
  <td>The response code from the address verification system.</td>
</tr>
<tr>
  <td>payment_credit_card_bin</td>
  <td>The issuer identification number (IIN), formerly known as bank identification number (BIN) of the customer's credit card.</td>
</tr>
<tr>
  <td>payment_cvv_result_code</td>
  <td>The response code from the credit card company indicating whether the customer entered the card security code, or card verification value, correctly.</td>
</tr>
<tr>
  <td>payment_credit_card_number</td>
  <td>The customer's credit card number, with most of the leading digits redacted.</td>
</tr>
<tr>
  <td>payment_credit_card_company</td>
  <td>The name of the company that issued the customer's credit card.</td>
</tr>
<tr>
  <td>kind</td>
  <td>The transaction's type.</td>
</tr>
<tr>
  <td>receipt</td>
  <td>A transaction receipt attached to the transaction by the gateway.</td>
</tr>
<tr>
  <td>currency_exchange_id</td>
  <td>The ID of the adjustment.</td>
</tr>
<tr>
  <td>currency_exchange_adjustment</td>
  <td>The difference between the amounts on the associated transaction and the parent transaction.</td>
</tr>
<tr>
  <td>currency_exchange_original_amount</td>
  <td>The amount of the parent transaction in the shop currency.</td>
</tr>
<tr>
  <td>currency_exchange_final_amount</td>
  <td>The amount of the associated transaction in the shop currency.</td>
</tr>
<tr>
  <td>currency_exchange_currency</td>
  <td>The shop currency.</td>
</tr>
<tr>
  <td>error_code</td>
  <td>A standardized error code, independent of the payment provider.</td>
</tr>
<tr>
  <td>status</td>
  <td>The status of the transaction.</td>
</tr>
<tr>
  <td>user_id</td>
  <td>The ID for the user who was logged into the Shopify POS device when the order was processed, if applicable.</td>
</tr>
<tr>
  <td>_fivetran_synced</td>
  <td>Timestamp of the date the record was synced by Fivetran.</td>
</tr>
<tr>
  <td>exchange_rate</td>
  <td>The exchange rate between the home currency and the currency of sale at the time of the transaction.</td>
</tr>
<tr>
  <td>currency_exchange_calculated_amount</td>
  <td>The total amount of the transaction with the currency exchange rate applied.</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The schema or database this record came from, if you are unioning multiple connectors. Null if not.</td>
</tr>
<tr>
  <td>payment_method</td>
  <td>Method of payment.</td>
</tr>
<tr>
  <td>parent_created_timestamp</td>
  <td>Created on timestamp of the parent transaction.</td>
</tr>
<tr>
  <td>parent_kind</td>
  <td>Kind of the parent transaction.</td>
</tr>
<tr>
  <td>parent_amount</td>
  <td>Amount of the parent transaction.</td>
</tr>
<tr>
  <td>parent_status</td>
  <td>Status of the parent transaction.</td>
</tr>
<tr>
  <td>authorization_expires_at</td>
  <td>Timestamp when the authorization expires.</td>
</tr>
<tr>
  <td>authorization_code</td>
  <td>The authorization code associated with the transaction.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_73Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">73. model.shopify.int_shopify__discounts__abandoned_checkouts</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">abandoned_checkout</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_abandoned_checkout&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="w">    </span><span class="c1">-- &quot;deleted&quot; abandoned checkouts do not appear to have any data tying them to customers,</span>
<span class="w">    </span><span class="c1">-- discounts, or products (and should therefore not get joined in) but let&#39;s filter them out here</span>
<span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">coalesce</span><span class="p">(</span><span class="n">is_deleted</span><span class="p">,</span><span class="w"> </span><span class="k">false</span><span class="p">)</span>
<span class="p">),</span>

<span class="n">abandoned_checkout_discount_code</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_abandoned_checkout_discount_code&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="w">    </span><span class="c1">-- we need the TYPE of discount (shipping, percentage, fixed_amount) to avoid fanning out of joins</span>
<span class="w">    </span><span class="c1">-- so filter out records that have this</span>
<span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="k">coalesce</span><span class="p">(</span><span class="k">type</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s1">&#39;&#39;</span>
<span class="p">),</span>

<span class="n">abandoned_checkout_shipping_line</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_abandoned_checkout_shipping_line&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">roll_up_shipping_line</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">checkout_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">price</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">price</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">abandoned_checkout_shipping_line</span>
<span class="w">    </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
<span class="p">),</span>

<span class="n">abandoned_checkouts_aggregated</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">abandoned_checkout_discount_code</span><span class="p">.</span><span class="n">code</span><span class="p">,</span>
<span class="w">        </span><span class="n">abandoned_checkout_discount_code</span><span class="p">.</span><span class="k">type</span><span class="p">,</span>
<span class="w">        </span><span class="n">abandoned_checkout_discount_code</span><span class="p">.</span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">abandoned_checkout_discount_code</span><span class="p">.</span><span class="n">amount</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">total_abandoned_checkout_discount_amount</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="k">coalesce</span><span class="p">(</span><span class="n">abandoned_checkout</span><span class="p">.</span><span class="n">total_line_items_price</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">total_abandoned_checkout_line_items_price</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="k">coalesce</span><span class="p">(</span><span class="n">roll_up_shipping_line</span><span class="p">.</span><span class="n">price</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">total_abandoned_checkout_shipping_price</span><span class="p">,</span>
<span class="w">        </span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">customer_id</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_abandoned_checkout_customers</span><span class="p">,</span>
<span class="w">        </span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">email</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_abandoned_checkout_customer_emails</span><span class="p">,</span>
<span class="w">        </span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">abandoned_checkout</span><span class="p">.</span><span class="n">checkout_id</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_abandoned_checkouts</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">abandoned_checkout_discount_code</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">abandoned_checkout</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">abandoned_checkout_discount_code</span><span class="p">.</span><span class="n">checkout_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">abandoned_checkout</span><span class="p">.</span><span class="n">checkout_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">abandoned_checkout_discount_code</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">abandoned_checkout</span><span class="p">.</span><span class="n">source_relation</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">roll_up_shipping_line</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">roll_up_shipping_line</span><span class="p">.</span><span class="n">checkout_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">abandoned_checkout_discount_code</span><span class="p">.</span><span class="n">checkout_id</span><span class="w"> </span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">roll_up_shipping_line</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">abandoned_checkout_discount_code</span><span class="p">.</span><span class="n">source_relation</span>

<span class="w">    </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="n">abandoned_checkouts_aggregated</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_74Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">74. model.shopify.shopify__orders__order_line_aggregates</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="err">{{</span><span class="w"> </span><span class="n">config</span><span class="p">(</span><span class="n">materialized</span><span class="o">=</span><span class="s1">&#39;table&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="k">with</span><span class="w"> </span><span class="n">order_line</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_order_line&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="p">),</span><span class="w"> </span><span class="n">tax</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_tax_line&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="p">),</span><span class="w"> </span><span class="n">shipping</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;int_shopify__order__shipping_aggregates&#39;</span><span class="p">)</span><span class="err">}}</span>

<span class="p">),</span><span class="w"> </span><span class="n">tax_aggregates</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="n">order_line_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">price</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">price</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">tax</span>
<span class="w">    </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>

<span class="p">),</span><span class="w"> </span><span class="n">order_line_aggregates</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">order_line</span><span class="p">.</span><span class="n">order_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_line</span><span class="p">.</span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">line_item_count</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">order_line</span><span class="p">.</span><span class="n">quantity</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">order_total_quantity</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">tax_aggregates</span><span class="p">.</span><span class="n">price</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">order_total_tax</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">order_line</span><span class="p">.</span><span class="n">total_discount</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">order_total_discount</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">order_line</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">tax_aggregates</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">tax_aggregates</span><span class="p">.</span><span class="n">order_line_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">order_line</span><span class="p">.</span><span class="n">order_line_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">tax_aggregates</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">order_line</span><span class="p">.</span><span class="n">source_relation</span>
<span class="w">    </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>

<span class="p">),</span><span class="w"> </span><span class="k">final</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="n">order_line_aggregates</span><span class="p">.</span><span class="n">order_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_line_aggregates</span><span class="p">.</span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_line_aggregates</span><span class="p">.</span><span class="n">line_item_count</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_line_aggregates</span><span class="p">.</span><span class="n">order_total_quantity</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_line_aggregates</span><span class="p">.</span><span class="n">order_total_tax</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_line_aggregates</span><span class="p">.</span><span class="n">order_total_discount</span><span class="p">,</span>
<span class="w">        </span><span class="n">shipping</span><span class="p">.</span><span class="n">shipping_price</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">order_total_shipping</span><span class="p">,</span>
<span class="w">        </span><span class="n">shipping</span><span class="p">.</span><span class="n">discounted_shipping_price</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">order_total_shipping_with_discounts</span><span class="p">,</span>
<span class="w">        </span><span class="n">shipping</span><span class="p">.</span><span class="n">shipping_tax</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">order_total_shipping_tax</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">order_line_aggregates</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">shipping</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">shipping</span><span class="p">.</span><span class="n">order_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">order_line_aggregates</span><span class="p">.</span><span class="n">order_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">shipping</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">order_line_aggregates</span><span class="p">.</span><span class="n">source_relation</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="k">final</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_75Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">75. model.shopify.int_shopify__inventory_level__aggregates</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">order_lines</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_order_line&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">fulfillment</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_fulfillment&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">orders</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_order&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">coalesce</span><span class="p">(</span><span class="n">is_deleted</span><span class="p">,</span><span class="w"> </span><span class="k">false</span><span class="p">)</span>
<span class="p">),</span><span class="w"> </span>

<span class="n">refunds</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;shopify__orders__order_refunds&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="p">),</span><span class="w"> </span><span class="n">refunds_aggregated</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="n">order_line_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">quantity</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">quantity</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="k">coalesce</span><span class="p">(</span><span class="n">subtotal</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">subtotal</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">refunds</span>
<span class="w">    </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
<span class="p">),</span>

<span class="n">joined</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="n">order_lines</span><span class="p">.</span><span class="n">order_line_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_lines</span><span class="p">.</span><span class="n">variant_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_lines</span><span class="p">.</span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="n">fulfillment</span><span class="p">.</span><span class="n">location_id</span><span class="p">,</span><span class="w"> </span><span class="c1">-- location id is stored in fulfillment rather than order</span>
<span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="n">order_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="n">customer_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">fulfillment</span><span class="p">.</span><span class="n">fulfillment_id</span><span class="p">,</span>
<span class="w">        </span><span class="k">lower</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">email</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">email</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_lines</span><span class="p">.</span><span class="n">pre_tax_price</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_lines</span><span class="p">.</span><span class="n">quantity</span><span class="p">,</span>
<span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="n">created_timestamp</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">order_created_timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="n">fulfillment</span><span class="p">.</span><span class="n">status</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">fulfillment_status</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">refunds_aggregated</span><span class="p">.</span><span class="n">subtotal</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">subtotal_sold_refunds</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">refunds_aggregated</span><span class="p">.</span><span class="n">quantity</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">quantity_sold_refunds</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">order_lines</span>
<span class="w">    </span><span class="k">join</span><span class="w"> </span><span class="n">orders</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">order_lines</span><span class="p">.</span><span class="n">order_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">order_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">order_lines</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">source_relation</span>
<span class="w">    </span><span class="k">join</span><span class="w"> </span><span class="n">fulfillment</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">order_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fulfillment</span><span class="p">.</span><span class="n">order_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fulfillment</span><span class="p">.</span><span class="n">source_relation</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">refunds_aggregated</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">refunds_aggregated</span><span class="p">.</span><span class="n">order_line_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">order_lines</span><span class="p">.</span><span class="n">order_line_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">refunds_aggregated</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">order_lines</span><span class="p">.</span><span class="n">source_relation</span>
<span class="p">),</span>

<span class="n">aggregated</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="n">variant_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">location_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">pre_tax_price</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">subtotal_sold</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">quantity</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">quantity_sold</span><span class="p">,</span>
<span class="w">        </span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">order_id</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_distinct_orders</span><span class="p">,</span>
<span class="w">        </span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">customer_id</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_distinct_customers</span><span class="p">,</span>
<span class="w">        </span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">email</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_distinct_customer_emails</span><span class="p">,</span>
<span class="w">        </span><span class="k">min</span><span class="p">(</span><span class="n">order_created_timestamp</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">first_order_timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="k">max</span><span class="p">(</span><span class="n">order_created_timestamp</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">last_order_timestamp</span>

<span class="w">        </span><span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;pending&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;open&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;success&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;cancelled&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;failure&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="n">fulfillment_status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;{{ status }}&#39;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">fulfillment_id</span><span class="w"> </span><span class="k">end</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_fulfillment_</span><span class="err">{{</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="err">}}</span>
<span class="w">        </span><span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="n">endfor</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>

<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="k">coalesce</span><span class="p">(</span><span class="n">subtotal_sold_refunds</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">subtotal_sold_refunds</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="k">coalesce</span><span class="p">(</span><span class="n">quantity_sold_refunds</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">quantity_sold_refunds</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">joined</span>

<span class="w">    </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_utils</span><span class="p">.</span><span class="n">group_by</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="n">aggregated</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_76Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">76. model.shopify.int_shopify__products_with_aggregates</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">products</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_product&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span><span class="w"> </span>

<span class="n">collection_product</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_collection_product&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">collection</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_collection&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">coalesce</span><span class="p">(</span><span class="n">is_deleted</span><span class="p">,</span><span class="w"> </span><span class="k">false</span><span class="p">)</span><span class="w"> </span><span class="c1">-- limit to only active collections</span>
<span class="p">),</span>

<span class="n">product_tag</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_product_tag&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">product_variant</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_product_variant&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">product_image</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_product_image&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>


<span class="n">collections_aggregated</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="n">collection_product</span><span class="p">.</span><span class="n">product_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">collection_product</span><span class="p">.</span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">string_agg</span><span class="p">(</span><span class="n">field_to_agg</span><span class="o">=</span><span class="s1">&#39;collection.title&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">delimiter</span><span class="o">=</span><span class="ss">&quot;&#39;, &#39;&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">collections</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">collection_product</span><span class="w"> </span>
<span class="w">    </span><span class="k">join</span><span class="w"> </span><span class="n">collection</span><span class="w"> </span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">collection_product</span><span class="p">.</span><span class="n">collection_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">collection</span><span class="p">.</span><span class="n">collection_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">collection_product</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">collection</span><span class="p">.</span><span class="n">source_relation</span>
<span class="w">    </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
<span class="p">),</span>

<span class="n">tags_aggregated</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">product_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">string_agg</span><span class="p">(</span><span class="n">field_to_agg</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">delimiter</span><span class="o">=</span><span class="ss">&quot;&#39;, &#39;&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">tags</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">product_tag</span>
<span class="w">    </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
<span class="p">),</span>

<span class="n">variants_aggregated</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">product_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="k">count</span><span class="p">(</span><span class="n">variant_id</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_variants</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">product_variant</span>
<span class="w">    </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>

<span class="p">),</span>

<span class="n">images_aggregated</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">product_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_images</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">product_image</span>
<span class="w">    </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
<span class="p">),</span>

<span class="n">joined</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="n">products</span><span class="p">.</span><span class="o">*</span><span class="p">,</span>
<span class="w">        </span><span class="n">collections_aggregated</span><span class="p">.</span><span class="n">collections</span><span class="p">,</span>
<span class="w">        </span><span class="n">tags_aggregated</span><span class="p">.</span><span class="n">tags</span><span class="p">,</span>
<span class="w">        </span><span class="n">variants_aggregated</span><span class="p">.</span><span class="n">count_variants</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">images_aggregated</span><span class="p">.</span><span class="n">count_images</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">has_product_image</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">products</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">collections_aggregated</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">products</span><span class="p">.</span><span class="n">product_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">collections_aggregated</span><span class="p">.</span><span class="n">product_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">products</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">collections_aggregated</span><span class="p">.</span><span class="n">source_relation</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">tags_aggregated</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">products</span><span class="p">.</span><span class="n">product_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tags_aggregated</span><span class="p">.</span><span class="n">product_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">products</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tags_aggregated</span><span class="p">.</span><span class="n">source_relation</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">variants_aggregated</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">products</span><span class="p">.</span><span class="n">product_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">variants_aggregated</span><span class="p">.</span><span class="n">product_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">products</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">variants_aggregated</span><span class="p">.</span><span class="n">source_relation</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">images_aggregated</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">products</span><span class="p">.</span><span class="n">product_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">images_aggregated</span><span class="p">.</span><span class="n">product_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">products</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">images_aggregated</span><span class="p">.</span><span class="n">source_relation</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="n">joined</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_77Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">77. model.shopify.shopify__order_lines</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    Each record represents a line item of an order in Shopify.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="err">{{</span>
<span class="w">    </span><span class="n">config</span><span class="p">(</span>
<span class="w">        </span><span class="n">materialized</span><span class="o">=</span><span class="s1">&#39;table&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">target</span><span class="p">.</span><span class="k">type</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;bigquery&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;databricks&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;spark&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;incremental&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">unique_key</span><span class="o">=</span><span class="s1">&#39;order_lines_unique_key&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">incremental_strategy</span><span class="o">=</span><span class="s1">&#39;delete+insert&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">target</span><span class="p">.</span><span class="k">type</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;postgres&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;redshift&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;snowflake&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;merge&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">cluster_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;order_line_id&#39;</span><span class="p">]</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span>
<span class="err">}}</span>

<span class="k">with</span><span class="w"> </span><span class="n">order_lines</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="o">*</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_utils</span><span class="p">.</span><span class="n">generate_surrogate_key</span><span class="p">([</span><span class="s1">&#39;source_relation&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;order_line_id&#39;</span><span class="p">])</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">order_lines_unique_key</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_order_line&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="w">    </span><span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">is_incremental</span><span class="p">()</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
<span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="k">cast</span><span class="p">(</span><span class="n">_fivetran_synced</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nb">date</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">shopify</span><span class="p">.</span><span class="n">shopify_lookback</span><span class="p">(</span><span class="n">from_date</span><span class="o">=</span><span class="ss">&quot;max(cast(_fivetran_synced as date))&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">interval</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;lookback_window&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="n">datepart</span><span class="o">=</span><span class="s1">&#39;day&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="w">    </span><span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="n">endif</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>

<span class="p">),</span><span class="w"> </span><span class="n">product_variants</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_product_variant&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="p">),</span><span class="w"> </span><span class="n">refunds</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;shopify__orders__order_refunds&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="p">),</span><span class="w"> </span><span class="n">refunds_aggregated</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="n">order_line_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">quantity</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">quantity</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="k">coalesce</span><span class="p">(</span><span class="n">subtotal</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">subtotal</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">string_agg</span><span class="p">(</span><span class="ss">&quot;distinct cast(refunds.restock_type as &quot;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_string</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="ss">&quot;)&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;&#39;, &#39;&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">restock_types</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">refunds</span>
<span class="w">    </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>

<span class="p">),</span><span class="w"> </span><span class="n">tax_lines</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_tax_line&#39;</span><span class="p">)</span><span class="err">}}</span>

<span class="p">),</span><span class="w"> </span><span class="n">tax_lines_aggregated</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="n">tax_lines</span><span class="p">.</span><span class="n">order_line_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">tax_lines</span><span class="p">.</span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">tax_lines</span><span class="p">.</span><span class="n">price</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">order_line_tax</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">tax_lines</span>
<span class="w">    </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>

<span class="p">),</span><span class="w"> </span><span class="n">joined</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="n">order_lines</span><span class="p">.</span><span class="o">*</span><span class="p">,</span>
<span class="w">        </span>
<span class="w">        </span><span class="n">refunds_aggregated</span><span class="p">.</span><span class="n">restock_types</span><span class="p">,</span>

<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">refunds_aggregated</span><span class="p">.</span><span class="n">quantity</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">refunded_quantity</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">refunds_aggregated</span><span class="p">.</span><span class="n">subtotal</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">refunded_subtotal</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_lines</span><span class="p">.</span><span class="n">quantity</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">coalesce</span><span class="p">(</span><span class="n">refunds_aggregated</span><span class="p">.</span><span class="n">quantity</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">quantity_net_refunds</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_lines</span><span class="p">.</span><span class="n">pre_tax_price</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="k">coalesce</span><span class="p">(</span><span class="n">refunds_aggregated</span><span class="p">.</span><span class="n">subtotal</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">subtotal_net_refunds</span><span class="p">,</span>
<span class="w">        </span>
<span class="w">        </span><span class="n">product_variants</span><span class="p">.</span><span class="n">created_timestamp</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">variant_created_at</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_variants</span><span class="p">.</span><span class="n">updated_timestamp</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">variant_updated_at</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_variants</span><span class="p">.</span><span class="n">inventory_item_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_variants</span><span class="p">.</span><span class="n">image_id</span><span class="p">,</span>

<span class="w">        </span><span class="n">product_variants</span><span class="p">.</span><span class="n">price</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">variant_price</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_variants</span><span class="p">.</span><span class="n">sku</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">variant_sku</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_variants</span><span class="p">.</span><span class="k">position</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">variant_position</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_variants</span><span class="p">.</span><span class="n">inventory_policy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">variant_inventory_policy</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_variants</span><span class="p">.</span><span class="n">compare_at_price</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">variant_compare_at_price</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_variants</span><span class="p">.</span><span class="n">fulfillment_service</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">variant_fulfillment_service</span><span class="p">,</span>

<span class="w">        </span><span class="n">product_variants</span><span class="p">.</span><span class="n">is_taxable</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">variant_is_taxable</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_variants</span><span class="p">.</span><span class="n">barcode</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">variant_barcode</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_variants</span><span class="p">.</span><span class="n">grams</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">variant_grams</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_variants</span><span class="p">.</span><span class="n">inventory_quantity</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">variant_inventory_quantity</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_variants</span><span class="p">.</span><span class="n">weight</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">variant_weight</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_variants</span><span class="p">.</span><span class="n">weight_unit</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">variant_weight_unit</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_variants</span><span class="p">.</span><span class="n">option_1</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">variant_option_1</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_variants</span><span class="p">.</span><span class="n">option_2</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">variant_option_2</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_variants</span><span class="p">.</span><span class="n">option_3</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">variant_option_3</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_variants</span><span class="p">.</span><span class="n">tax_code</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">variant_tax_code</span><span class="p">,</span>

<span class="w">        </span><span class="n">tax_lines_aggregated</span><span class="p">.</span><span class="n">order_line_tax</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">order_lines</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">refunds_aggregated</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">refunds_aggregated</span><span class="p">.</span><span class="n">order_line_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">order_lines</span><span class="p">.</span><span class="n">order_line_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">refunds_aggregated</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">order_lines</span><span class="p">.</span><span class="n">source_relation</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">product_variants</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">product_variants</span><span class="p">.</span><span class="n">variant_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">order_lines</span><span class="p">.</span><span class="n">variant_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">product_variants</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">order_lines</span><span class="p">.</span><span class="n">source_relation</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">tax_lines_aggregated</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">tax_lines_aggregated</span><span class="p">.</span><span class="n">order_line_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">order_lines</span><span class="p">.</span><span class="n">order_line_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">tax_lines_aggregated</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">order_lines</span><span class="p">.</span><span class="n">source_relation</span>


<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="n">joined</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>order_lines_unique_key</td>
  <td>Unique key representing an order line. Hashed on 'order_line_id' and 'source_relation'.</td>
</tr>
<tr>
  <td>_fivetran_synced</td>
  <td>The time when a record was last updated by Fivetran.</td>
</tr>
<tr>
  <td>fulfillable_quantity</td>
  <td>The amount available to fulfill, calculated as follows: quantity - max(refunded_quantity, fulfilled_quantity) - pending_fulfilled_quantity - open_fulfilled_quantity\n</td>
</tr>
<tr>
  <td>fulfillment_status</td>
  <td>How far along an order is in terms line items fulfilled.</td>
</tr>
<tr>
  <td>is_gift_card</td>
  <td>Whether the item is a gift card. If true, then the item is not taxed or considered for shipping charges.</td>
</tr>
<tr>
  <td>grams</td>
  <td>The weight of the item in grams.</td>
</tr>
<tr>
  <td>order_line_id</td>
  <td>The ID of the line item.</td>
</tr>
<tr>
  <td>name</td>
  <td>The name of the product variant.</td>
</tr>
<tr>
  <td>order_id</td>
  <td>The ID of the related order.</td>
</tr>
<tr>
  <td>price</td>
  <td>The price of the item before discounts have been applied in the shop currency.</td>
</tr>
<tr>
  <td>product_id</td>
  <td>The ID of the product that the line item belongs to. Can be null if the original product associated with the order is deleted at a later date.</td>
</tr>
<tr>
  <td>quantity</td>
  <td>The number of items that were purchased.</td>
</tr>
<tr>
  <td>is_shipping_required</td>
  <td>Whether the item requires shipping.</td>
</tr>
<tr>
  <td>sku</td>
  <td>The item's SKU (stock keeping unit).</td>
</tr>
<tr>
  <td>is_taxable</td>
  <td>Whether the item was taxable.</td>
</tr>
<tr>
  <td>title</td>
  <td>The title of the product.</td>
</tr>
<tr>
  <td>total_discount</td>
  <td>The total amount of the discount allocated to the line item in the shop currency.</td>
</tr>
<tr>
  <td>variant_id</td>
  <td>The ID of the product variant.</td>
</tr>
<tr>
  <td>vendor</td>
  <td>The name of the item's supplier.</td>
</tr>
<tr>
  <td>refunded_quantity</td>
  <td>Quantity of the item that has been refunded.</td>
</tr>
<tr>
  <td>quantity_net_refunds</td>
  <td>Quantity ordered, excluding refunds.</td>
</tr>
<tr>
  <td>variant_barcode</td>
  <td>The barcode, UPC, or ISBN number for the product.</td>
</tr>
<tr>
  <td>variant_compare_at_price</td>
  <td>The original price of the item before an adjustment or a sale in shop currency.</td>
</tr>
<tr>
  <td>variant_created_at</td>
  <td>The date and time (ISO 8601 format) when the product variant was created.</td>
</tr>
<tr>
  <td>variant_fulfillment_service</td>
  <td>The fulfillment service associated with the product variant.</td>
</tr>
<tr>
  <td>variant_grams</td>
  <td>The weight of the product variant in grams.</td>
</tr>
<tr>
  <td>inventory_item_id</td>
  <td>The unique identifier for the inventory item, which is used in the Inventory API to query for inventory information.</td>
</tr>
<tr>
  <td>variant_inventory_management</td>
  <td>The fulfillment service that tracks the number of items in stock for the product variant.</td>
</tr>
<tr>
  <td>variant_inventory_policy</td>
  <td>Whether customers are allowed to place an order for the product variant when it's out of stock.</td>
</tr>
<tr>
  <td>variant_inventory_quantity</td>
  <td>An aggregate of inventory across all locations. To adjust inventory at a specific location, use the InventoryLevel resource.</td>
</tr>
<tr>
  <td>variant_option_1</td>
  <td>The custom properties that a shop owner uses to define product variants. You can define three options for a product variant: option1, option2, option3.</td>
</tr>
<tr>
  <td>variant_option_2</td>
  <td>The custom properties that a shop owner uses to define product variants. You can define three options for a product variant: option1, option2, option3.</td>
</tr>
<tr>
  <td>variant_option_3</td>
  <td>The custom properties that a shop owner uses to define product variants. You can define three options for a product variant: option1, option2, option3.</td>
</tr>
<tr>
  <td>variant_position</td>
  <td>The order of the product variant in the list of product variants. The first position in the list is 1. The position of variants is indicated by the order in which they are listed.</td>
</tr>
<tr>
  <td>variant_price</td>
  <td>The price of the product variant.</td>
</tr>
<tr>
  <td>variant_sku</td>
  <td>A unique identifier for the product variant in the shop. Required in order to connect to a FulfillmentService.</td>
</tr>
<tr>
  <td>variant_is_taxable</td>
  <td>Whether a tax is charged when the product variant is sold.</td>
</tr>
<tr>
  <td>variant_tax_code</td>
  <td>This parameter applies only to the stores that have the Avalara AvaTax app installed. Specifies the Avalara tax code for the product variant.</td>
</tr>
<tr>
  <td>variant_title</td>
  <td>The title of the product variant. The title field is a concatenation of the option1, option2, and option3 fields. You can only update title indirectly using the option fields.</td>
</tr>
<tr>
  <td>variant_updated_at</td>
  <td>The date and time when the product variant was last modified. Gets returned in ISO 8601 format.</td>
</tr>
<tr>
  <td>variant_weight</td>
  <td>The weight of the product variant in the unit system specified with weight_unit.</td>
</tr>
<tr>
  <td>variant_weight_unit</td>
  <td>The unit of measurement that applies to the product variant's weight. If you don't specify a value for weight_unit, then the shop's default unit of measurement is applied. Valid values: g, kg, oz, and lb.</td>
</tr>
<tr>
  <td>refunded_subtotal</td>
  <td>Subtotal amount of the refund applied to the order line in shop currency.</td>
</tr>
<tr>
  <td>subtotal_net_refunds</td>
  <td>Subtotal of the order line with refunds subtracted in shop currency.</td>
</tr>
<tr>
  <td>image_id</td>
  <td>Image id of the product variant associated with the order line.</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The schema or database this record came from, if you are unioning multiple connectors. Null if not.</td>
</tr>
<tr>
  <td>restock_types</td>
  <td>List of how this refund line item affects inventory levels.</td>
</tr>
<tr>
  <td>order_line_tax</td>
  <td>Total taxes for the line item.</td>
</tr>
<tr>
  <td>index</td>
  <td>The index associated with the order.</td>
</tr>
<tr>
  <td>pre_tax_price</td>
  <td>The total pre tax price of the order.</td>
</tr>
<tr>
  <td>tax_code</td>
  <td>This parameter applies only to the stores that have the Avalara AvaTax app installed. Specifies the Avalara tax code for the product variant.</td>
</tr>
<tr>
  <td>pre_tax_price_set</td>
  <td>The pre tax price of the line item in shop currency and presentment currency.</td>
</tr>
<tr>
  <td>price_set</td>
  <td>The price of the line item in shop and presentment currencies.</td>
</tr>
<tr>
  <td>total_discount_set</td>
  <td>The total amount allocated to the line item in the presentment currency.</td>
</tr>
<tr>
  <td>properties</td>
  <td>Line item properties.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_78Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">78. model.shopify.int_shopify__emails__order_aggregates</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_order&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="p">),</span><span class="w"> </span><span class="n">order_aggregates</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;shopify__orders__order_line_aggregates&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="p">),</span><span class="w"> </span><span class="n">transactions</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;shopify__transactions&#39;</span><span class="p">)</span><span class="err">}}</span>

<span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="k">lower</span><span class="p">(</span><span class="n">status</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;success&#39;</span>
<span class="w">    </span><span class="k">and</span><span class="w"> </span><span class="k">lower</span><span class="p">(</span><span class="n">kind</span><span class="p">)</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;authorization&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;void&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="k">and</span><span class="w"> </span><span class="k">lower</span><span class="p">(</span><span class="n">gateway</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s1">&#39;gift_card&#39;</span><span class="w"> </span><span class="c1">-- redeeming a giftcard does not introduce new revenue</span>

<span class="p">),</span><span class="w"> </span><span class="n">transaction_aggregates</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="c1">-- this is necessary as customers can pay via multiple payment gateways</span>
<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">order_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="k">lower</span><span class="p">(</span><span class="n">kind</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">kind</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">currency_exchange_calculated_amount</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">currency_exchange_calculated_amount</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">transactions</span>
<span class="w">    </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_utils</span><span class="p">.</span><span class="n">group_by</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="p">),</span><span class="w"> </span><span class="n">customer_emails</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="c1">-- in case any orders records don&#39;t have the customer email attached yet</span>
<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">customer_id</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="n">email</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_customer&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="n">email</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">null</span>
<span class="w">    </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_utils</span><span class="p">.</span><span class="n">group_by</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="w">    </span>
<span class="p">),</span><span class="w"> </span><span class="n">aggregated</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="k">lower</span><span class="p">(</span><span class="n">customer_emails</span><span class="p">.</span><span class="n">email</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">email</span><span class="p">,</span>
<span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="k">min</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">created_timestamp</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">first_order_timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="k">max</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">created_timestamp</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">most_recent_order_timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="k">avg</span><span class="p">(</span><span class="n">transaction_aggregates</span><span class="p">.</span><span class="n">currency_exchange_calculated_amount</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">avg_order_value</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">transaction_aggregates</span><span class="p">.</span><span class="n">currency_exchange_calculated_amount</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lifetime_total_spent</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">refunds</span><span class="p">.</span><span class="n">currency_exchange_calculated_amount</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lifetime_total_refunded</span><span class="p">,</span>
<span class="w">        </span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">order_id</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lifetime_count_orders</span><span class="p">,</span>
<span class="w">        </span><span class="k">avg</span><span class="p">(</span><span class="n">order_aggregates</span><span class="p">.</span><span class="n">order_total_quantity</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">avg_quantity_per_order</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">order_aggregates</span><span class="p">.</span><span class="n">order_total_tax</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lifetime_total_tax</span><span class="p">,</span>
<span class="w">        </span><span class="k">avg</span><span class="p">(</span><span class="n">order_aggregates</span><span class="p">.</span><span class="n">order_total_tax</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">avg_tax_per_order</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">order_aggregates</span><span class="p">.</span><span class="n">order_total_discount</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lifetime_total_discount</span><span class="p">,</span>
<span class="w">        </span><span class="k">avg</span><span class="p">(</span><span class="n">order_aggregates</span><span class="p">.</span><span class="n">order_total_discount</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">avg_discount_per_order</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">order_aggregates</span><span class="p">.</span><span class="n">order_total_shipping</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lifetime_total_shipping</span><span class="p">,</span>
<span class="w">        </span><span class="k">avg</span><span class="p">(</span><span class="n">order_aggregates</span><span class="p">.</span><span class="n">order_total_shipping</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">avg_shipping_per_order</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">order_aggregates</span><span class="p">.</span><span class="n">order_total_shipping_with_discounts</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lifetime_total_shipping_with_discounts</span><span class="p">,</span>
<span class="w">        </span><span class="k">avg</span><span class="p">(</span><span class="n">order_aggregates</span><span class="p">.</span><span class="n">order_total_shipping_with_discounts</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">avg_shipping_with_discounts_per_order</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">order_aggregates</span><span class="p">.</span><span class="n">order_total_shipping_tax</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lifetime_total_shipping_tax</span><span class="p">,</span>
<span class="w">        </span><span class="k">avg</span><span class="p">(</span><span class="n">order_aggregates</span><span class="p">.</span><span class="n">order_total_shipping_tax</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">avg_shipping_tax_per_order</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">orders</span>
<span class="w">    </span><span class="k">join</span><span class="w"> </span><span class="n">customer_emails</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">customer_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">customer_emails</span><span class="p">.</span><span class="n">customer_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">customer_emails</span><span class="p">.</span><span class="n">source_relation</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">transaction_aggregates</span><span class="w"> </span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">order_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">transaction_aggregates</span><span class="p">.</span><span class="n">order_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">transaction_aggregates</span><span class="p">.</span><span class="n">source_relation</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">transaction_aggregates</span><span class="p">.</span><span class="n">kind</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;sale&#39;</span><span class="p">,</span><span class="s1">&#39;capture&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">transaction_aggregates</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">refunds</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">order_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">refunds</span><span class="p">.</span><span class="n">order_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">refunds</span><span class="p">.</span><span class="n">source_relation</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">refunds</span><span class="p">.</span><span class="n">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;refund&#39;</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">order_aggregates</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">order_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">order_aggregates</span><span class="p">.</span><span class="n">order_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">order_aggregates</span><span class="p">.</span><span class="n">source_relation</span>

<span class="w">    </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>

<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="n">aggregated</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_79Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">79. model.shopify.shopify__customers__order_aggregates</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_order&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="n">customer_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">null</span>

<span class="p">),</span><span class="w"> </span><span class="n">order_aggregates</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;shopify__orders__order_line_aggregates&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="p">),</span><span class="w"> </span><span class="n">transactions</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;shopify__transactions&#39;</span><span class="p">)</span><span class="err">}}</span>

<span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="k">lower</span><span class="p">(</span><span class="n">status</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;success&#39;</span>
<span class="w">    </span><span class="k">and</span><span class="w"> </span><span class="k">lower</span><span class="p">(</span><span class="n">kind</span><span class="p">)</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;authorization&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;void&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="k">and</span><span class="w"> </span><span class="k">lower</span><span class="p">(</span><span class="n">gateway</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s1">&#39;gift_card&#39;</span><span class="w"> </span><span class="c1">-- redeeming a giftcard does not introduce new revenue</span>

<span class="p">),</span><span class="w"> </span><span class="n">transaction_aggregates</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="c1">-- this is necessary as customers can pay via multiple payment gateways</span>
<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">order_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="k">lower</span><span class="p">(</span><span class="n">kind</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">kind</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">currency_exchange_calculated_amount</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">currency_exchange_calculated_amount</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">transactions</span>
<span class="w">    </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_utils</span><span class="p">.</span><span class="n">group_by</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="p">),</span><span class="w"> </span><span class="n">customer_tags</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_customer_tag&#39;</span><span class="w"> </span><span class="p">)</span><span class="err">}}</span>

<span class="p">),</span><span class="w"> </span><span class="n">customer_tags_aggregated</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">customer_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">string_agg</span><span class="p">(</span><span class="ss">&quot;distinct cast(value as &quot;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_string</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="ss">&quot;)&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;&#39;, &#39;&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">customer_tags</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">customer_tags</span>
<span class="w">    </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>

<span class="p">),</span><span class="w"> </span><span class="n">aggregated</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="n">customer_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="n">customer_tags_aggregated</span><span class="p">.</span><span class="n">customer_tags</span><span class="p">,</span>
<span class="w">        </span><span class="k">min</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">created_timestamp</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">first_order_timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="k">max</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">created_timestamp</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">most_recent_order_timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="k">avg</span><span class="p">(</span><span class="n">transaction_aggregates</span><span class="p">.</span><span class="n">currency_exchange_calculated_amount</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">avg_order_value</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">transaction_aggregates</span><span class="p">.</span><span class="n">currency_exchange_calculated_amount</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lifetime_total_spent</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">refunds</span><span class="p">.</span><span class="n">currency_exchange_calculated_amount</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lifetime_total_refunded</span><span class="p">,</span>
<span class="w">        </span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">order_id</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lifetime_count_orders</span><span class="p">,</span>
<span class="w">        </span><span class="k">avg</span><span class="p">(</span><span class="n">order_aggregates</span><span class="p">.</span><span class="n">order_total_quantity</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">avg_quantity_per_order</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">order_aggregates</span><span class="p">.</span><span class="n">order_total_tax</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lifetime_total_tax</span><span class="p">,</span>
<span class="w">        </span><span class="k">avg</span><span class="p">(</span><span class="n">order_aggregates</span><span class="p">.</span><span class="n">order_total_tax</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">avg_tax_per_order</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">order_aggregates</span><span class="p">.</span><span class="n">order_total_discount</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lifetime_total_discount</span><span class="p">,</span>
<span class="w">        </span><span class="k">avg</span><span class="p">(</span><span class="n">order_aggregates</span><span class="p">.</span><span class="n">order_total_discount</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">avg_discount_per_order</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">order_aggregates</span><span class="p">.</span><span class="n">order_total_shipping</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lifetime_total_shipping</span><span class="p">,</span>
<span class="w">        </span><span class="k">avg</span><span class="p">(</span><span class="n">order_aggregates</span><span class="p">.</span><span class="n">order_total_shipping</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">avg_shipping_per_order</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">order_aggregates</span><span class="p">.</span><span class="n">order_total_shipping_with_discounts</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lifetime_total_shipping_with_discounts</span><span class="p">,</span>
<span class="w">        </span><span class="k">avg</span><span class="p">(</span><span class="n">order_aggregates</span><span class="p">.</span><span class="n">order_total_shipping_with_discounts</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">avg_shipping_with_discounts_per_order</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">order_aggregates</span><span class="p">.</span><span class="n">order_total_shipping_tax</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lifetime_total_shipping_tax</span><span class="p">,</span>
<span class="w">        </span><span class="k">avg</span><span class="p">(</span><span class="n">order_aggregates</span><span class="p">.</span><span class="n">order_total_shipping_tax</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">avg_shipping_tax_per_order</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">orders</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">transaction_aggregates</span><span class="w"> </span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">order_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">transaction_aggregates</span><span class="p">.</span><span class="n">order_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">transaction_aggregates</span><span class="p">.</span><span class="n">source_relation</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">transaction_aggregates</span><span class="p">.</span><span class="n">kind</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;sale&#39;</span><span class="p">,</span><span class="s1">&#39;capture&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">transaction_aggregates</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">refunds</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">order_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">refunds</span><span class="p">.</span><span class="n">order_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">refunds</span><span class="p">.</span><span class="n">source_relation</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">refunds</span><span class="p">.</span><span class="n">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;refund&#39;</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">order_aggregates</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">order_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">order_aggregates</span><span class="p">.</span><span class="n">order_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">order_aggregates</span><span class="p">.</span><span class="n">source_relation</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">customer_tags_aggregated</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">customer_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">customer_tags_aggregated</span><span class="p">.</span><span class="n">customer_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">customer_tags_aggregated</span><span class="p">.</span><span class="n">source_relation</span>
<span class="w">    </span>
<span class="w">    </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_utils</span><span class="p">.</span><span class="n">group_by</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="n">aggregated</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_80Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">80. model.shopify.shopify__inventory_levels</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    Model representing the current status of an inventory level in Shopify. Inventory Levels are unique pairings of  inventory items (which have a 1:1 relationship with product variants) and locations. 
Inventory Level = Inventory item @ a Location.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">inventory_level</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_inventory_level&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span><span class="w"> </span>

<span class="n">inventory_item</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_inventory_item&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="k">location</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_location&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">product_variant</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_product_variant&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">product</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_product&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">inventory_level_aggregated</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;int_shopify__inventory_level__aggregates&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">joined_info</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">inventory_level</span><span class="p">.</span><span class="o">*</span><span class="p">,</span>
<span class="w">        </span><span class="n">inventory_item</span><span class="p">.</span><span class="n">sku</span><span class="p">,</span>
<span class="w">        </span><span class="n">inventory_item</span><span class="p">.</span><span class="n">is_deleted</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">is_inventory_item_deleted</span><span class="p">,</span>
<span class="w">        </span><span class="n">inventory_item</span><span class="p">.</span><span class="n">cost</span><span class="p">,</span>
<span class="w">        </span><span class="n">inventory_item</span><span class="p">.</span><span class="n">country_code_of_origin</span><span class="p">,</span>
<span class="w">        </span><span class="n">inventory_item</span><span class="p">.</span><span class="n">province_code_of_origin</span><span class="p">,</span>
<span class="w">        </span><span class="n">inventory_item</span><span class="p">.</span><span class="n">is_shipping_required</span><span class="p">,</span>
<span class="w">        </span><span class="n">inventory_item</span><span class="p">.</span><span class="n">is_inventory_quantity_tracked</span><span class="p">,</span>
<span class="w">        </span><span class="n">inventory_item</span><span class="p">.</span><span class="n">created_at</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">inventory_item_created_at</span><span class="p">,</span>
<span class="w">        </span><span class="n">inventory_item</span><span class="p">.</span><span class="n">updated_at</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">inventory_item_updated_at</span><span class="p">,</span>

<span class="w">        </span><span class="k">location</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">location_name</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="k">location</span><span class="p">.</span><span class="n">is_deleted</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">is_location_deleted</span><span class="p">,</span>
<span class="w">        </span><span class="k">location</span><span class="p">.</span><span class="n">is_active</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">is_location_active</span><span class="p">,</span>
<span class="w">        </span><span class="k">location</span><span class="p">.</span><span class="n">address_1</span><span class="p">,</span>
<span class="w">        </span><span class="k">location</span><span class="p">.</span><span class="n">address_2</span><span class="p">,</span>
<span class="w">        </span><span class="k">location</span><span class="p">.</span><span class="n">city</span><span class="p">,</span>
<span class="w">        </span><span class="k">location</span><span class="p">.</span><span class="n">country</span><span class="p">,</span>
<span class="w">        </span><span class="k">location</span><span class="p">.</span><span class="n">country_code</span><span class="p">,</span>
<span class="w">        </span><span class="k">location</span><span class="p">.</span><span class="n">is_legacy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">is_legacy_location</span><span class="p">,</span>
<span class="w">        </span><span class="k">location</span><span class="p">.</span><span class="n">province</span><span class="p">,</span>
<span class="w">        </span><span class="k">location</span><span class="p">.</span><span class="n">province_code</span><span class="p">,</span>
<span class="w">        </span><span class="k">location</span><span class="p">.</span><span class="n">phone</span><span class="p">,</span>
<span class="w">        </span><span class="k">location</span><span class="p">.</span><span class="n">zip</span><span class="p">,</span>
<span class="w">        </span><span class="k">location</span><span class="p">.</span><span class="n">created_at</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">location_created_at</span><span class="p">,</span>
<span class="w">        </span><span class="k">location</span><span class="p">.</span><span class="n">updated_at</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">location_updated_at</span><span class="p">,</span>

<span class="w">        </span><span class="n">product_variant</span><span class="p">.</span><span class="n">variant_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_variant</span><span class="p">.</span><span class="n">product_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_variant</span><span class="p">.</span><span class="n">title</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">variant_title</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_variant</span><span class="p">.</span><span class="n">inventory_policy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">variant_inventory_policy</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_variant</span><span class="p">.</span><span class="n">price</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">variant_price</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_variant</span><span class="p">.</span><span class="n">image_id</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">variant_image_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_variant</span><span class="p">.</span><span class="n">fulfillment_service</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">variant_fulfillment_service</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_variant</span><span class="p">.</span><span class="n">inventory_management</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">variant_inventory_management</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_variant</span><span class="p">.</span><span class="n">is_taxable</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">is_variant_taxable</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_variant</span><span class="p">.</span><span class="n">barcode</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">variant_barcode</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_variant</span><span class="p">.</span><span class="n">grams</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">variant_grams</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">product_variant</span><span class="p">.</span><span class="n">inventory_quantity</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">variant_inventory_quantity</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_variant</span><span class="p">.</span><span class="n">weight</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">variant_weight</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_variant</span><span class="p">.</span><span class="n">weight_unit</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">variant_weight_unit</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_variant</span><span class="p">.</span><span class="n">option_1</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">variant_option_1</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_variant</span><span class="p">.</span><span class="n">option_2</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">variant_option_2</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_variant</span><span class="p">.</span><span class="n">option_3</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">variant_option_3</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_variant</span><span class="p">.</span><span class="n">tax_code</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">variant_tax_code</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_variant</span><span class="p">.</span><span class="n">created_timestamp</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">variant_created_at</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_variant</span><span class="p">.</span><span class="n">updated_timestamp</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">variant_updated_at</span>

<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">persist_pass_through_columns</span><span class="p">(</span><span class="s1">&#39;product_variant_pass_through_columns&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">identifier</span><span class="o">=</span><span class="s1">&#39;product_variant&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">inventory_level</span>
<span class="w">    </span><span class="k">join</span><span class="w"> </span><span class="n">inventory_item</span><span class="w"> </span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">inventory_level</span><span class="p">.</span><span class="n">inventory_item_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inventory_item</span><span class="p">.</span><span class="n">inventory_item_id</span><span class="w"> </span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">inventory_level</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inventory_item</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span>
<span class="w">    </span><span class="k">join</span><span class="w"> </span><span class="k">location</span><span class="w"> </span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">inventory_level</span><span class="p">.</span><span class="n">location_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">location</span><span class="p">.</span><span class="n">location_id</span><span class="w"> </span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">inventory_level</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">location</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span>
<span class="w">    </span><span class="k">join</span><span class="w"> </span><span class="n">product_variant</span><span class="w"> </span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">inventory_item</span><span class="p">.</span><span class="n">inventory_item_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">product_variant</span><span class="p">.</span><span class="n">inventory_item_id</span><span class="w"> </span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">inventory_item</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">product_variant</span><span class="p">.</span><span class="n">source_relation</span>

<span class="p">),</span>

<span class="n">joined_aggregates</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">joined_info</span><span class="p">.</span><span class="o">*</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">inventory_level_aggregated</span><span class="p">.</span><span class="n">subtotal_sold</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">subtotal_sold</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">inventory_level_aggregated</span><span class="p">.</span><span class="n">quantity_sold</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">quantity_sold</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">inventory_level_aggregated</span><span class="p">.</span><span class="n">count_distinct_orders</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_distinct_orders</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">inventory_level_aggregated</span><span class="p">.</span><span class="n">count_distinct_customers</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_distinct_customers</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">inventory_level_aggregated</span><span class="p">.</span><span class="n">count_distinct_customer_emails</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_distinct_customer_emails</span><span class="p">,</span>
<span class="w">        </span><span class="n">inventory_level_aggregated</span><span class="p">.</span><span class="n">first_order_timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="n">inventory_level_aggregated</span><span class="p">.</span><span class="n">last_order_timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">inventory_level_aggregated</span><span class="p">.</span><span class="n">subtotal_sold_refunds</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">subtotal_sold_refunds</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">inventory_level_aggregated</span><span class="p">.</span><span class="n">quantity_sold_refunds</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">quantity_sold_refunds</span>

<span class="w">        </span><span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;pending&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;open&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;success&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;cancelled&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;failure&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="k">coalesce</span><span class="p">(</span><span class="n">count_fulfillment_</span><span class="err">{{</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="err">}}</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_fulfillment_</span><span class="err">{{</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="err">}}</span>
<span class="w">        </span><span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="n">endfor</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">joined_info</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">inventory_level_aggregated</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">joined_info</span><span class="p">.</span><span class="n">location_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inventory_level_aggregated</span><span class="p">.</span><span class="n">location_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">joined_info</span><span class="p">.</span><span class="n">variant_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inventory_level_aggregated</span><span class="p">.</span><span class="n">variant_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">joined_info</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inventory_level_aggregated</span><span class="p">.</span><span class="n">source_relation</span>
<span class="p">),</span>

<span class="k">final</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="o">*</span><span class="p">,</span>
<span class="w">        </span><span class="n">subtotal_sold</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">subtotal_sold_refunds</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">net_subtotal_sold</span><span class="p">,</span>
<span class="w">        </span><span class="n">quantity_sold</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">quantity_sold_refunds</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">net_quantity_sold</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">joined_aggregates</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="k">from</span><span class="w"> </span><span class="k">final</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>_fivetran_synced</td>
  <td>The time when a record was last updated by Fivetran.</td>
</tr>
<tr>
  <td>available_quantity</td>
  <td>The available quantity of an inventory item at the inventory level's associated location. Returns null if the inventory item is not tracked.</td>
</tr>
<tr>
  <td>inventory_item_id</td>
  <td>The ID of the inventory item associated with the inventory level.</td>
</tr>
<tr>
  <td>location_id</td>
  <td>The ID of the location that the inventory level belongs to.</td>
</tr>
<tr>
  <td>updated_at</td>
  <td>The date and time (ISO 8601 format) when the inventory level was last modified.</td>
</tr>
<tr>
  <td>is_inventory_item_deleted</td>
  <td>Boolean representing whether the record was soft-deleted in Shopify.</td>
</tr>
<tr>
  <td>sku</td>
  <td>The unique SKU (stock keeping unit) of the inventory item.</td>
</tr>
<tr>
  <td>cost</td>
  <td>The unit cost of the inventory item. The shop's default currency is used.</td>
</tr>
<tr>
  <td>province_code_of_origin</td>
  <td>The province code (ISO 3166-2 alpha-2) of where the item came from. The province code is only used if the shipping provider for the inventory item is Canada Post.</td>
</tr>
<tr>
  <td>country_code_of_origin</td>
  <td>The country code (ISO 3166-1 alpha-2) of where the item came from.</td>
</tr>
<tr>
  <td>is_shipping_required</td>
  <td>Boolean representing whether a customer needs to provide a shipping address when placing an order containing the inventory item.</td>
</tr>
<tr>
  <td>is_inventory_quantity_tracked</td>
  <td>Boolean representing whether inventory levels are tracked for the item. If true, then the inventory quantity changes are tracked by Shopify.</td>
</tr>
<tr>
  <td>inventory_item_created_at</td>
  <td>The date and time (ISO 8601 format) when the inventory item was created.</td>
</tr>
<tr>
  <td>inventory_item_updated_at</td>
  <td>The date and time (ISO 8601 format) when the inventory item was last modified.</td>
</tr>
<tr>
  <td>is_location_deleted</td>
  <td>Boolean representing whether the record was soft-deleted in Shopify.</td>
</tr>
<tr>
  <td>is_location_active</td>
  <td>Boolean representing whether the location is active. If true, then the location can be used to sell products, stock inventory, and fulfill orders.\n</td>
</tr>
<tr>
  <td>address_1</td>
  <td>The location's street address.</td>
</tr>
<tr>
  <td>address_2</td>
  <td>The optional second line of the location's street address.</td>
</tr>
<tr>
  <td>city</td>
  <td>The city the location is in.</td>
</tr>
<tr>
  <td>country</td>
  <td>The country the location is in (two-letter code).</td>
</tr>
<tr>
  <td>country_code</td>
  <td>The two-letter code (ISO 3166-1 alpha-2 format) corresponding to country the location is in.</td>
</tr>
<tr>
  <td>location_created_at</td>
  <td>The date and time (ISO 8601 format) when the location was created.</td>
</tr>
<tr>
  <td>is_legacy_location</td>
  <td>Boolean representing whether this is a fulfillment service location. If true, then the location is a fulfillment service location.  If false, then the location was created by the merchant and isn't tied to a fulfillment service.\n</td>
</tr>
<tr>
  <td>location_name</td>
  <td>The name of the location.</td>
</tr>
<tr>
  <td>phone</td>
  <td>The phone number of the location. This value can contain special characters, such as - or +.</td>
</tr>
<tr>
  <td>province</td>
  <td>The province, state, or district of the location.</td>
</tr>
<tr>
  <td>province_code</td>
  <td>The province, state, or district code (ISO 3166-2 alpha-2 format) of the location.</td>
</tr>
<tr>
  <td>location_updated_at</td>
  <td>The date and time (ISO 8601 format) when the location was last updated.</td>
</tr>
<tr>
  <td>zip</td>
  <td>The zip or postal code.</td>
</tr>
<tr>
  <td>variant_barcode</td>
  <td>The barcode, UPC, or ISBN number for the product.</td>
</tr>
<tr>
  <td>variant_created_at</td>
  <td>The date and time (ISO 8601 format) when the product variant was created.</td>
</tr>
<tr>
  <td>variant_fulfillment_service</td>
  <td>The fulfillment service associated with the product variant.</td>
</tr>
<tr>
  <td>variant_grams</td>
  <td>The weight of the product variant in grams.</td>
</tr>
<tr>
  <td>variant_id</td>
  <td>The unique numeric identifier for the product variant.</td>
</tr>
<tr>
  <td>variant_image_id</td>
  <td>The unique numeric identifier for a product's image. The image must be associated to the same product as the variant.</td>
</tr>
<tr>
  <td>variant_inventory_management</td>
  <td>The fulfillment service that tracks the number of items in stock for the product variant.</td>
</tr>
<tr>
  <td>variant_inventory_policy</td>
  <td>Whether customers are allowed to place an order for the product variant when it's out of stock.</td>
</tr>
<tr>
  <td>variant_inventory_quantity</td>
  <td>An aggregate of inventory across all locations. To adjust inventory at a specific location, use the InventoryLevel resource.</td>
</tr>
<tr>
  <td>variant_option_1</td>
  <td>The custom properties that a shop owner uses to define product variants. You can define three options for a product variant: option1, option2, option3.</td>
</tr>
<tr>
  <td>variant_option_2</td>
  <td>The custom properties that a shop owner uses to define product variants. You can define three options for a product variant: option1, option2, option3.</td>
</tr>
<tr>
  <td>variant_option_3</td>
  <td>The custom properties that a shop owner uses to define product variants. You can define three options for a product variant: option1, option2, option3.</td>
</tr>
<tr>
  <td>variant_price</td>
  <td>The price of the product variant in shop currency.</td>
</tr>
<tr>
  <td>product_id</td>
  <td>The unique numeric identifier for the product.</td>
</tr>
<tr>
  <td>is_variant_taxable</td>
  <td>Whether a tax is charged when the product variant is sold.</td>
</tr>
<tr>
  <td>variant_tax_code</td>
  <td>This parameter applies only to the stores that have the Avalara AvaTax app installed. Specifies the Avalara tax code for the product variant.</td>
</tr>
<tr>
  <td>variant_title</td>
  <td>The title of the product variant. The title field is a concatenation of the option1, option2, and option3 fields. You can only update title indirectly using the option fields.</td>
</tr>
<tr>
  <td>variant_updated_at</td>
  <td>The date and time when the product variant was last modified. Gets returned in ISO 8601 format.</td>
</tr>
<tr>
  <td>variant_weight</td>
  <td>The weight of the product variant in the unit system specified with weight_unit.</td>
</tr>
<tr>
  <td>variant_weight_unit</td>
  <td>The unit of measurement that applies to the product variant's weight. If you don't specify a value for weight_unit, then the shop's default unit of measurement is applied. Valid values: g, kg, oz, and lb.</td>
</tr>
<tr>
  <td>subtotal_sold</td>
  <td>Total amount (monetary, in shop currency) sold from the inventory level. Includes refunds.</td>
</tr>
<tr>
  <td>quantity_sold</td>
  <td>Total quantity sold from the inventory level. Includes refunds.</td>
</tr>
<tr>
  <td>count_distinct_orders</td>
  <td>The number of distinct orders placed from this inventory level.</td>
</tr>
<tr>
  <td>count_distinct_customers</td>
  <td>The number of distinct customers (based on customer_id) that have placed orders against this inventory level.</td>
</tr>
<tr>
  <td>count_distinct_customer_emails</td>
  <td>The number of distinct customer emails that have placed orders against this inventory level.</td>
</tr>
<tr>
  <td>first_order_timestamp</td>
  <td>The timetamp of the first order against this inventory level.</td>
</tr>
<tr>
  <td>last_order_timestamp</td>
  <td>The timestamp of the first order against this inventory level.</td>
</tr>
<tr>
  <td>subtotal_sold_refunds</td>
  <td>The monetary amount (in shop currency) of inventory level goods that have been refunded.</td>
</tr>
<tr>
  <td>quantity_sold_refunds</td>
  <td>The quantity of inventory level goods that have been refunded.</td>
</tr>
<tr>
  <td>net_subtotal_sold</td>
  <td>Net monetary amount sold (in shop currency) from the inventory level. Excludes refunds.</td>
</tr>
<tr>
  <td>net_quantity_sold</td>
  <td>Net quantity sold from this inventory level. Excludes refunds.</td>
</tr>
<tr>
  <td>count_fulfillment_pending</td>
  <td>Count of currently pending distinct fulfillments for this inventory level. "Pending" = Shopify has created the fulfillment and is waiting for the third-party fulfillment service to transition it to 'open' or 'success'.\n</td>
</tr>
<tr>
  <td>count_fulfillment_open</td>
  <td>Count of currently open distinct fulfillments for this inventory level. "Open" = The fulfillment has been acknowledged by the service and is in processing.\n</td>
</tr>
<tr>
  <td>count_fulfillment_success</td>
  <td>Count of successful distinct fulfillments for this inventory level. "Success" = The fulfillment was successful.\n</td>
</tr>
<tr>
  <td>count_fulfillment_cancelled</td>
  <td>Count of cancelled distinct fulfillments for this inventory level. "Cancelled" = The fulfillment was cancelled.\n</td>
</tr>
<tr>
  <td>count_fulfillment_error</td>
  <td>Count of distinct fulfillments for this inventory level that encountered an error. "Error" = There was an error with the fulfillment request.\n</td>
</tr>
<tr>
  <td>count_fulfillment_failure</td>
  <td>Count of distinct fulfillments for this inventory level that failed. "Failure" = The fulfillment request failed.\n</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The schema or database this record came from if you are making use of the `shopify_union_schemas` or `shopify_union_databases` variables, respectively. Empty string if you are not using either of these variables to union together multiple Shopify connectors.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_81Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">81. model.shopify.shopify__orders</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    Each record represents an order in Shopify.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="err">{{</span>
<span class="w">    </span><span class="n">config</span><span class="p">(</span>
<span class="w">        </span><span class="n">materialized</span><span class="o">=</span><span class="s1">&#39;table&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">target</span><span class="p">.</span><span class="k">type</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;bigquery&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;databricks&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;spark&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;incremental&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">unique_key</span><span class="o">=</span><span class="s1">&#39;orders_unique_key&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">incremental_strategy</span><span class="o">=</span><span class="s1">&#39;delete+insert&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">target</span><span class="p">.</span><span class="k">type</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;postgres&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;redshift&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;snowflake&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;merge&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">cluster_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;order_id&#39;</span><span class="p">]</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span>
<span class="err">}}</span>

<span class="k">with</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="o">*</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_utils</span><span class="p">.</span><span class="n">generate_surrogate_key</span><span class="p">([</span><span class="s1">&#39;source_relation&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;order_id&#39;</span><span class="p">])</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">orders_unique_key</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_order&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="w">    </span><span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">is_incremental</span><span class="p">()</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
<span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="k">cast</span><span class="p">(</span><span class="k">coalesce</span><span class="p">(</span><span class="n">updated_timestamp</span><span class="p">,</span><span class="w"> </span><span class="n">created_timestamp</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nb">date</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">shopify</span><span class="p">.</span><span class="n">shopify_lookback</span><span class="p">(</span>
<span class="w">        </span><span class="n">from_date</span><span class="o">=</span><span class="ss">&quot;max(cast(coalesce(updated_timestamp, created_timestamp) as date))&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="nb">interval</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;lookback_window&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">),</span><span class="w"> </span>
<span class="w">        </span><span class="n">datepart</span><span class="o">=</span><span class="s1">&#39;day&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="w">    </span><span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="n">endif</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>

<span class="p">),</span><span class="w"> </span><span class="n">order_lines</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;shopify__orders__order_line_aggregates&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="p">),</span><span class="w"> </span><span class="n">order_adjustments</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_order_adjustment&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="p">),</span><span class="w"> </span><span class="n">order_adjustments_aggregates</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="n">order_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">amount</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">order_adjustment_amount</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">tax_amount</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">order_adjustment_tax_amount</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">order_adjustments</span>
<span class="w">    </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>

<span class="p">),</span><span class="w"> </span><span class="n">refunds</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;shopify__orders__order_refunds&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="p">),</span><span class="w"> </span><span class="n">refund_aggregates</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="n">order_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">subtotal</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">refund_subtotal</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">total_tax</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">refund_total_tax</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">refunds</span>
<span class="w">    </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>

<span class="p">),</span><span class="w"> </span><span class="n">order_discount_code</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_order_discount_code&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="p">),</span><span class="w"> </span><span class="n">discount_aggregates</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">order_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="k">case</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="k">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;shipping&#39;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">end</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">shipping_discount_amount</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="k">case</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="k">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;percentage&#39;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">end</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">percentage_calc_discount_amount</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="k">case</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="k">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;fixed_amount&#39;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">end</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">fixed_amount_discount_amount</span><span class="p">,</span>
<span class="w">        </span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">code</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_discount_codes_applied</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">order_discount_code</span>
<span class="w">    </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>

<span class="p">),</span><span class="w"> </span><span class="n">order_tag</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="n">order_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">string_agg</span><span class="p">(</span><span class="ss">&quot;distinct cast(value as &quot;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_string</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="ss">&quot;)&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;&#39;, &#39;&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">order_tags</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_order_tag&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="w">    </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>

<span class="p">),</span><span class="w"> </span><span class="n">order_url_tag</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="n">order_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">string_agg</span><span class="p">(</span><span class="ss">&quot;distinct cast(value as &quot;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_string</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="ss">&quot;)&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;&#39;, &#39;&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">order_url_tags</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_order_url_tag&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="w">    </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>

<span class="p">),</span><span class="w"> </span><span class="n">fulfillments</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">order_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="k">count</span><span class="p">(</span><span class="n">fulfillment_id</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">number_of_fulfillments</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">string_agg</span><span class="p">(</span><span class="ss">&quot;distinct cast(service as &quot;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_string</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="ss">&quot;)&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;&#39;, &#39;&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">fulfillment_services</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">string_agg</span><span class="p">(</span><span class="ss">&quot;distinct cast(tracking_company as &quot;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_string</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="ss">&quot;)&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;&#39;, &#39;&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">tracking_companies</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">string_agg</span><span class="p">(</span><span class="ss">&quot;distinct cast(tracking_number as &quot;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_string</span><span class="p">()</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="ss">&quot;)&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;&#39;, &#39;&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">tracking_numbers</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_fulfillment&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="w">    </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>

<span class="p">),</span><span class="w"> </span><span class="n">joined</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="o">*</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="k">cast</span><span class="p">(</span><span class="err">{{</span><span class="w"> </span><span class="n">fivetran_utils</span><span class="p">.</span><span class="n">json_parse</span><span class="p">(</span><span class="ss">&quot;total_shipping_price_set&quot;</span><span class="p">,[</span><span class="ss">&quot;shop_money&quot;</span><span class="p">,</span><span class="ss">&quot;amount&quot;</span><span class="p">])</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">type_float</span><span class="p">()</span><span class="w"> </span><span class="err">}}</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">shipping_cost</span><span class="p">,</span>
<span class="w">        </span>
<span class="w">        </span><span class="n">order_adjustments_aggregates</span><span class="p">.</span><span class="n">order_adjustment_amount</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_adjustments_aggregates</span><span class="p">.</span><span class="n">order_adjustment_tax_amount</span><span class="p">,</span>

<span class="w">        </span><span class="n">refund_aggregates</span><span class="p">.</span><span class="n">refund_subtotal</span><span class="p">,</span>
<span class="w">        </span><span class="n">refund_aggregates</span><span class="p">.</span><span class="n">refund_total_tax</span><span class="p">,</span>

<span class="w">        </span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">total_price</span>
<span class="w">            </span><span class="o">+</span><span class="w"> </span><span class="k">coalesce</span><span class="p">(</span><span class="n">order_adjustments_aggregates</span><span class="p">.</span><span class="n">order_adjustment_amount</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">coalesce</span><span class="p">(</span><span class="n">order_adjustments_aggregates</span><span class="p">.</span><span class="n">order_adjustment_tax_amount</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span>
<span class="w">            </span><span class="o">-</span><span class="w"> </span><span class="k">coalesce</span><span class="p">(</span><span class="n">refund_aggregates</span><span class="p">.</span><span class="n">refund_subtotal</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">coalesce</span><span class="p">(</span><span class="n">refund_aggregates</span><span class="p">.</span><span class="n">refund_total_tax</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">order_adjusted_total</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_lines</span><span class="p">.</span><span class="n">line_item_count</span><span class="p">,</span>

<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">discount_aggregates</span><span class="p">.</span><span class="n">shipping_discount_amount</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">shipping_discount_amount</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">discount_aggregates</span><span class="p">.</span><span class="n">percentage_calc_discount_amount</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">percentage_calc_discount_amount</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">discount_aggregates</span><span class="p">.</span><span class="n">fixed_amount_discount_amount</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">fixed_amount_discount_amount</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">discount_aggregates</span><span class="p">.</span><span class="n">count_discount_codes_applied</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_discount_codes_applied</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">order_lines</span><span class="p">.</span><span class="n">order_total_shipping_tax</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">order_total_shipping_tax</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_tag</span><span class="p">.</span><span class="n">order_tags</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_url_tag</span><span class="p">.</span><span class="n">order_url_tags</span><span class="p">,</span>
<span class="w">        </span><span class="n">fulfillments</span><span class="p">.</span><span class="n">number_of_fulfillments</span><span class="p">,</span>
<span class="w">        </span><span class="n">fulfillments</span><span class="p">.</span><span class="n">fulfillment_services</span><span class="p">,</span>
<span class="w">        </span><span class="n">fulfillments</span><span class="p">.</span><span class="n">tracking_companies</span><span class="p">,</span>
<span class="w">        </span><span class="n">fulfillments</span><span class="p">.</span><span class="n">tracking_numbers</span>


<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">orders</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">order_lines</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">order_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">order_lines</span><span class="p">.</span><span class="n">order_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">order_lines</span><span class="p">.</span><span class="n">source_relation</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">refund_aggregates</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">order_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">refund_aggregates</span><span class="p">.</span><span class="n">order_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">refund_aggregates</span><span class="p">.</span><span class="n">source_relation</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">order_adjustments_aggregates</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">order_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">order_adjustments_aggregates</span><span class="p">.</span><span class="n">order_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">order_adjustments_aggregates</span><span class="p">.</span><span class="n">source_relation</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">discount_aggregates</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">order_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">discount_aggregates</span><span class="p">.</span><span class="n">order_id</span><span class="w"> </span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">discount_aggregates</span><span class="p">.</span><span class="n">source_relation</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">order_tag</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">order_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">order_tag</span><span class="p">.</span><span class="n">order_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">order_tag</span><span class="p">.</span><span class="n">source_relation</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">order_url_tag</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">order_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">order_url_tag</span><span class="p">.</span><span class="n">order_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">order_url_tag</span><span class="p">.</span><span class="n">source_relation</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">fulfillments</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">order_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fulfillments</span><span class="p">.</span><span class="n">order_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fulfillments</span><span class="p">.</span><span class="n">source_relation</span>

<span class="p">),</span><span class="w"> </span><span class="n">windows</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="o">*</span><span class="p">,</span>
<span class="w">        </span><span class="n">row_number</span><span class="p">()</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="p">(</span>
<span class="w">            </span><span class="n">partition</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">shopify</span><span class="p">.</span><span class="n">shopify_partition_by_cols</span><span class="p">(</span><span class="s1">&#39;customer_id&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;source_relation&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="w">            </span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">created_timestamp</span><span class="p">)</span><span class="w"> </span>
<span class="w">            </span><span class="k">as</span><span class="w"> </span><span class="n">customer_order_seq_number</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">joined</span>

<span class="p">),</span><span class="w"> </span><span class="n">new_vs_repeat</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="o">*</span><span class="p">,</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span>
<span class="w">            </span><span class="k">when</span><span class="w"> </span><span class="n">customer_order_seq_number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="s1">&#39;new&#39;</span>
<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;repeat&#39;</span>
<span class="w">        </span><span class="k">end</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">new_vs_repeat</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">windows</span>

<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="n">new_vs_repeat</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>orders_unique_key</td>
  <td>Unique key representing an order. Hashed on 'order_id' and 'source_relation'.</td>
</tr>
<tr>
  <td>_fivetran_synced</td>
  <td>The time when a record was last updated by Fivetran.</td>
</tr>
<tr>
  <td>app_id</td>
  <td>The ID of the app that created the order.</td>
</tr>
<tr>
  <td>billing_address_address_1</td>
  <td>The street address of the billing address.</td>
</tr>
<tr>
  <td>billing_address_address_2</td>
  <td>An optional additional field for the street address of the billing address.</td>
</tr>
<tr>
  <td>billing_address_city</td>
  <td>The city, town, or village of the billing address.</td>
</tr>
<tr>
  <td>billing_address_company</td>
  <td>The company of the person associated with the billing address.</td>
</tr>
<tr>
  <td>billing_address_country</td>
  <td>The name of the country of the billing address.</td>
</tr>
<tr>
  <td>billing_address_country_code</td>
  <td>The two-letter code (ISO 3166-1 format) for the country of the billing address.</td>
</tr>
<tr>
  <td>billing_address_first_name</td>
  <td>The first name of the person associated with the payment method.</td>
</tr>
<tr>
  <td>billing_address_last_name</td>
  <td>The last name of the person associated with the payment method.</td>
</tr>
<tr>
  <td>billing_address_latitude</td>
  <td>The latitude of the billing address.</td>
</tr>
<tr>
  <td>billing_address_longitude</td>
  <td>The longitude of the billing address.</td>
</tr>
<tr>
  <td>billing_address_name</td>
  <td>The full name of the person associated with the payment method.</td>
</tr>
<tr>
  <td>billing_address_phone</td>
  <td>The phone number at the billing address.</td>
</tr>
<tr>
  <td>billing_address_province</td>
  <td>The name of the region (province, state, prefecture, ) of the billing address.</td>
</tr>
<tr>
  <td>billing_address_province_code</td>
  <td>The two-letter abbreviation of the region of the billing address.</td>
</tr>
<tr>
  <td>billing_address_zip</td>
  <td>The postal code (zip, postcode, Eircode, ) of the billing address.</td>
</tr>
<tr>
  <td>browser_ip</td>
  <td>The IP address of the browser used by the customer when they placed the order.</td>
</tr>
<tr>
  <td>has_buyer_accepted_marketing</td>
  <td>Whether the customer consented to receive email updates from the shop.</td>
</tr>
<tr>
  <td>cancel_reason</td>
  <td>The reason why the order was canceled.</td>
</tr>
<tr>
  <td>cancelled_timestamp</td>
  <td>The date and time when the order was canceled.</td>
</tr>
<tr>
  <td>cart_token</td>
  <td>The ID of the cart that's associated with the order.</td>
</tr>
<tr>
  <td>closed_timestamp</td>
  <td>The date and time when the order was closed (archived).</td>
</tr>
<tr>
  <td>created_timestamp</td>
  <td>The autogenerated date and time when the order was created in Shopify.</td>
</tr>
<tr>
  <td>currency</td>
  <td>The three-letter code for the shop currency.</td>
</tr>
<tr>
  <td>customer_id</td>
  <td>The ID of the order's customer.</td>
</tr>
<tr>
  <td>email</td>
  <td>The customer's email address.</td>
</tr>
<tr>
  <td>financial_status</td>
  <td>The status of payments associated with the order. Can only be set when the order is created</td>
</tr>
<tr>
  <td>fulfillment_status</td>
  <td>The order's status in terms of fulfilled line items.</td>
</tr>
<tr>
  <td>order_id</td>
  <td>The ID of the order, used for API purposes. This is different from the order_number property, which is the ID used by the shop owner and customer.</td>
</tr>
<tr>
  <td>landing_site_base_url</td>
  <td>The URL for the page where the buyer landed when they entered the shop.</td>
</tr>
<tr>
  <td>location_id</td>
  <td>The ID of the physical location where the order was processed.</td>
</tr>
<tr>
  <td>name</td>
  <td>The order name, generated by combining the order_number property with the order prefix and suffix that are set in the merchant's general settings.</td>
</tr>
<tr>
  <td>note</td>
  <td>An optional note that a shop owner can attach to the order.</td>
</tr>
<tr>
  <td>number</td>
  <td>The order's position in the shop's count of orders. Numbers are sequential and start at 1.</td>
</tr>
<tr>
  <td>order_number</td>
  <td>The order 's position in the shop's count of orders starting at 1001. Order numbers are sequential and start at 1001.</td>
</tr>
<tr>
  <td>processed_timestamp</td>
  <td>The date and time when an order was processed. This value is the date that appears on your orders and that's used in the analytic reports.</td>
</tr>
<tr>
  <td>referring_site</td>
  <td>The website where the customer clicked a link to the shop.</td>
</tr>
<tr>
  <td>shipping_address_address_1</td>
  <td>The street address of the shipping address.</td>
</tr>
<tr>
  <td>shipping_address_address_2</td>
  <td>An optional additional field for the street address of the shipping address.</td>
</tr>
<tr>
  <td>shipping_address_city</td>
  <td>The city, town, or village of the shipping address.</td>
</tr>
<tr>
  <td>shipping_address_company</td>
  <td>The company of the person associated with the shipping address.</td>
</tr>
<tr>
  <td>shipping_address_country</td>
  <td>The name of the country of the shipping address.</td>
</tr>
<tr>
  <td>shipping_address_country_code</td>
  <td>The two-letter code (ISO 3166-1 format) for the country of the shipping address.</td>
</tr>
<tr>
  <td>shipping_address_first_name</td>
  <td>The first name of the person associated with the shipping address.</td>
</tr>
<tr>
  <td>shipping_address_last_name</td>
  <td>The last name of the person associated with the shipping address.</td>
</tr>
<tr>
  <td>shipping_address_latitude</td>
  <td>The latitude of the shipping address.</td>
</tr>
<tr>
  <td>shipping_address_longitude</td>
  <td>The longitude of the shipping address.</td>
</tr>
<tr>
  <td>shipping_address_name</td>
  <td>The full name of the person associated with the payment method.</td>
</tr>
<tr>
  <td>shipping_address_phone</td>
  <td>The phone number at the shipping address.</td>
</tr>
<tr>
  <td>shipping_address_province</td>
  <td>The name of the region (province, state, prefecture, ) of the shipping address.</td>
</tr>
<tr>
  <td>shipping_address_province_code</td>
  <td>The two-letter abbreviation of the region of the shipping address.</td>
</tr>
<tr>
  <td>shipping_address_zip</td>
  <td>The postal code (zip, postcode, Eircode, ) of the shipping address.</td>
</tr>
<tr>
  <td>source_name</td>
  <td>Where the order originated. Can be set only during order creation, and is not writeable afterwards.</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The ID of the order placed on the originating platform. This value doesn't correspond to the Shopify ID that's generated from a completed draft.</td>
</tr>
<tr>
  <td>subtotal_price</td>
  <td>The price of the order in the shop currency after discounts but before shipping, taxes, and tips.</td>
</tr>
<tr>
  <td>has_taxes_included</td>
  <td>Whether taxes are included in the order subtotal.</td>
</tr>
<tr>
  <td>is_test_order</td>
  <td>Whether this is a test order.</td>
</tr>
<tr>
  <td>token</td>
  <td>A unique token for the order.</td>
</tr>
<tr>
  <td>total_discounts</td>
  <td>The total discounts applied to the price of the order in the shop currency.</td>
</tr>
<tr>
  <td>total_line_items_price</td>
  <td>The sum of all line item prices in the shop currency.</td>
</tr>
<tr>
  <td>total_price</td>
  <td>The sum of all line item prices, discounts, shipping, taxes, and tips in the shop currency. Must be positive.</td>
</tr>
<tr>
  <td>total_tax</td>
  <td>The sum of all the taxes applied to the order in th shop currency. Must be positive.</td>
</tr>
<tr>
  <td>total_weight</td>
  <td>The sum of all line item weights in grams.</td>
</tr>
<tr>
  <td>updated_timestamp</td>
  <td>The date and time (ISO 8601 format) when the order was last modified.</td>
</tr>
<tr>
  <td>user_id</td>
  <td>The ID of the user logged into Shopify POS who processed the order, if applicable.</td>
</tr>
<tr>
  <td>line_item_count</td>
  <td>Number of line items included in the order.</td>
</tr>
<tr>
  <td>customer_order_seq_number</td>
  <td>The sequential number of the order as it relates to the customer</td>
</tr>
<tr>
  <td>new_vs_repeat</td>
  <td>Whether the order was a new or repeat order for the customer.</td>
</tr>
<tr>
  <td>shipping_cost</td>
  <td>The shipping cost of the order.</td>
</tr>
<tr>
  <td>order_adjustment_amount</td>
  <td>Total adjustment amount applied to the order in shop currency.</td>
</tr>
<tr>
  <td>order_adjustment_tax_amount</td>
  <td>Total tax applied to the adjustment on the order in shop currency.</td>
</tr>
<tr>
  <td>refund_subtotal</td>
  <td>Total refund amount applied to the order in shop currency.</td>
</tr>
<tr>
  <td>refund_total_tax</td>
  <td>Total tax applied to the refund on the order in shop currency.</td>
</tr>
<tr>
  <td>order_adjusted_total</td>
  <td>Order total adjusted for refunds and other adjustments. The calculation used for this field is as follows: total price listed on the original order (including shipping costs and discounts) + adjustments + adjustments tax - total refunds - refunds tax The order_adjusted_total will equate to the total sales - refunds listed within the transactions table for the order (after currency exchange).\n</td>
</tr>
<tr>
  <td>checkout_token</td>
  <td>The checkout token applied to the order.</td>
</tr>
<tr>
  <td>total_shipping_price_set</td>
  <td>The total shipping price set to the order.</td>
</tr>
<tr>
  <td>order_total_shipping_tax</td>
  <td>Total shipping tax attributed to the order.</td>
</tr>
<tr>
  <td>order_tags</td>
  <td>List of tags associated with the order.</td>
</tr>
<tr>
  <td>order_url_tags</td>
  <td>List of url tags associated with the order.</td>
</tr>
<tr>
  <td>number_of_fulfillments</td>
  <td>Total fulfillments for the order.</td>
</tr>
<tr>
  <td>fulfillment_services</td>
  <td>List of fulfillment services for the order.</td>
</tr>
<tr>
  <td>tracking_companies</td>
  <td>List of tracking companies for the order.</td>
</tr>
<tr>
  <td>tracking_numbers</td>
  <td>List of tracking numbers for the order.</td>
</tr>
<tr>
  <td>total_tip_received</td>
  <td>The sum of all the tips in the order in the shop currency.</td>
</tr>
<tr>
  <td>checkout_id</td>
  <td>The ID for the checkout.</td>
</tr>
<tr>
  <td>client_details_user_agent</td>
  <td>Details of the browsing client, including software and operating versions.</td>
</tr>
<tr>
  <td>customer_locale</td>
  <td>The two or three-letter language code, optionally followed by a region modifier. Example values - en, en-CA.</td>
</tr>
<tr>
  <td>order_status_url</td>
  <td>The URL pointing to the order status web page, if applicable.</td>
</tr>
<tr>
  <td>presentment_currency</td>
  <td>The three-letter code (ISO 4217 format) of the currency that the customer used at checkout. For the shop's default currency, see `currency`.</td>
</tr>
<tr>
  <td>is_deleted</td>
  <td>Boolean representing whether the record was soft-deleted in Shopify.</td>
</tr>
<tr>
  <td>total_discounts_set</td>
  <td>The total discounts applied to the price of the order in shop and presentment currencies.</td>
</tr>
<tr>
  <td>total_line_items_price_set</td>
  <td>The total of all line item prices in shop and presentment currencies.</td>
</tr>
<tr>
  <td>total_price_set</td>
  <td>The total price of the order in shop and presentment currencies.</td>
</tr>
<tr>
  <td>total_tax_set</td>
  <td>The total tax applied to the order in shop and presentment currencies.</td>
</tr>
<tr>
  <td>is_confirmed</td>
  <td>Whether the order is confirmed.</td>
</tr>
<tr>
  <td>shipping_discount_amount</td>
  <td>The total amount of discount (in shop currency) allocated toward shipping.</td>
</tr>
<tr>
  <td>percentage_calc_discount_amount</td>
  <td>The total amount of discount (in shop currency) allocated via a percentage-based discount</td>
</tr>
<tr>
  <td>fixed_amount_discount_amount</td>
  <td>The total amount of discount (in shop currency) allocated via a fixed-amount discount</td>
</tr>
<tr>
  <td>count_discount_codes_applied</td>
  <td>Distinct discount codes applied on the order</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_82Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">82. model.shopify.shopify__customers</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    Each record represents a customer in Shopify.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">customers</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_utils</span><span class="p">.</span><span class="n">star</span><span class="p">(</span><span class="k">from</span><span class="o">=</span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_shopify__customer&#39;</span><span class="p">),</span><span class="w"> </span><span class="k">except</span><span class="o">=</span><span class="p">[</span><span class="ss">&quot;orders_count&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;total_spent&quot;</span><span class="p">])</span><span class="w"> </span><span class="err">}}</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_customer&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="p">),</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;shopify__customers__order_aggregates&#39;</span><span class="w"> </span><span class="p">)</span><span class="err">}}</span>

<span class="p">),</span><span class="w"> </span><span class="n">abandoned</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">customer_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">checkout_id</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lifetime_abandoned_checkouts</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_abandoned_checkout&#39;</span><span class="w"> </span><span class="p">)</span><span class="err">}}</span>
<span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="n">customer_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">null</span>
<span class="w">    </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>

<span class="p">),</span><span class="w"> </span><span class="n">joined</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">customers</span><span class="p">.</span><span class="o">*</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">abandoned</span><span class="p">.</span><span class="n">lifetime_abandoned_checkouts</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lifetime_abandoned_checkouts</span><span class="p">,</span>
<span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="n">first_order_timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="n">most_recent_order_timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="n">customer_tags</span><span class="p">,</span>
<span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="n">avg_order_value</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">lifetime_total_spent</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lifetime_total_spent</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">lifetime_total_refunded</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lifetime_total_refunded</span><span class="p">,</span>
<span class="w">        </span><span class="p">(</span><span class="k">coalesce</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">lifetime_total_spent</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">coalesce</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">lifetime_total_refunded</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lifetime_total_net</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">lifetime_count_orders</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lifetime_count_orders</span><span class="p">,</span>
<span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="n">avg_quantity_per_order</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">lifetime_total_tax</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lifetime_total_tax</span><span class="p">,</span>
<span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="n">avg_tax_per_order</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">lifetime_total_discount</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lifetime_total_discount</span><span class="p">,</span>
<span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="n">avg_discount_per_order</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">lifetime_total_shipping</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lifetime_total_shipping</span><span class="p">,</span>
<span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="n">avg_shipping_per_order</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">lifetime_total_shipping_with_discounts</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lifetime_total_shipping_with_discounts</span><span class="p">,</span>
<span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="n">avg_shipping_with_discounts_per_order</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">lifetime_total_shipping_tax</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lifetime_total_shipping_tax</span><span class="p">,</span>
<span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="n">avg_shipping_tax_per_order</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">customers</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">orders</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">customers</span><span class="p">.</span><span class="n">customer_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">customer_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">customers</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">source_relation</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">abandoned</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">customers</span><span class="p">.</span><span class="n">customer_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">abandoned</span><span class="p">.</span><span class="n">customer_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">customers</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">abandoned</span><span class="p">.</span><span class="n">source_relation</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="n">joined</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>_fivetran_synced</td>
  <td>The time when a record was last updated by Fivetran.</td>
</tr>
<tr>
  <td>created_timestamp</td>
  <td>The date and time when the customer was created.</td>
</tr>
<tr>
  <td>default_address_id</td>
  <td>The default address for the customer.</td>
</tr>
<tr>
  <td>email</td>
  <td>The unique email address of the customer. Attempting to assign the same email address to multiple customers returns an error.</td>
</tr>
<tr>
  <td>first_name</td>
  <td>The customer's first name.</td>
</tr>
<tr>
  <td>customer_id</td>
  <td>A unique identifier for the customer.</td>
</tr>
<tr>
  <td>last_name</td>
  <td>The customer's last name.</td>
</tr>
<tr>
  <td>lifetime_count_orders</td>
  <td>The number of orders associated with this customer.</td>
</tr>
<tr>
  <td>phone</td>
  <td>The unique phone number (E.164 format) for this customer. Attempting to assign the same phone number to multiple customers returns an error.</td>
</tr>
<tr>
  <td>account_state</td>
  <td>The state of the customer's account with a shop.</td>
</tr>
<tr>
  <td>is_tax_exempt</td>
  <td>Whether the customer is exempt from paying taxes on their order. If true, then taxes won't be applied to an order at checkout. If false, then taxes will be applied at checkout.</td>
</tr>
<tr>
  <td>updated_timestamp</td>
  <td>The date and time when the customer information was last updated.</td>
</tr>
<tr>
  <td>is_verified_email</td>
  <td>Whether the customer has verified their email address.</td>
</tr>
<tr>
  <td>first_order_timestamp</td>
  <td>The timestamp the customer completed their first order.</td>
</tr>
<tr>
  <td>most_recent_order_timestamp</td>
  <td>The timestamp the customer completed their most recent order.</td>
</tr>
<tr>
  <td>avg_order_value</td>
  <td>The average order value for the customer.</td>
</tr>
<tr>
  <td>lifetime_total_spent</td>
  <td>The total amount of money in shop currency that the customer has spent on orders across their order history.</td>
</tr>
<tr>
  <td>lifetime_total_refunded</td>
  <td>The total amount of money that the customer has been refunded on orders across their order history.</td>
</tr>
<tr>
  <td>lifetime_total_net</td>
  <td>The total amount of money (minus refunds) that the customer has spent across their order history.</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The schema or database this record came from, if you are unioning multiple connectors. Null if not.</td>
</tr>
<tr>
  <td>lifetime_abandoned_checkouts</td>
  <td>Total number of abandoned checkouts abandoned by the customer.</td>
</tr>
<tr>
  <td>customer_tags</td>
  <td>A string aggregated list of all tags associated with a customer.</td>
</tr>
<tr>
  <td>avg_quantity_per_order</td>
  <td>Average quantity of items per order customer orders.</td>
</tr>
<tr>
  <td>lifetime_total_tax</td>
  <td>Total amount of tax attributed to the customer.</td>
</tr>
<tr>
  <td>avg_tax_per_order</td>
  <td>Average tax per order attributed to the customer.</td>
</tr>
<tr>
  <td>lifetime_total_discount</td>
  <td>Total discounts attributed to the customer.</td>
</tr>
<tr>
  <td>avg_discount_per_order</td>
  <td>Average discount per order attributed to the customer.</td>
</tr>
<tr>
  <td>lifetime_total_shipping</td>
  <td>Total shipping costs attributed to the customer.</td>
</tr>
<tr>
  <td>avg_shipping_per_order</td>
  <td>Average shipping cost per order attributed to the customer.</td>
</tr>
<tr>
  <td>lifetime_total_shipping_with_discounts</td>
  <td>Total shipping costs after discounts attributed to the customer.</td>
</tr>
<tr>
  <td>avg_shipping_with_discounts_per_order</td>
  <td>Average shipping costs after discounts per order attributed to the customer.</td>
</tr>
<tr>
  <td>lifetime_total_shipping_tax</td>
  <td>Total shipping tax attributed to the customer.</td>
</tr>
<tr>
  <td>avg_shipping_tax_per_order</td>
  <td>Average shipping tax per order attributed to the customer.</td>
</tr>
<tr>
  <td>currency</td>
  <td>The three-letter code (ISO 4217 format) for the currency that the customer used when they paid for their last order. Defaults to the shop currency. Returns the shop currency for test orders.</td>
</tr>
<tr>
  <td>note</td>
  <td>A note about the customer.</td>
</tr>
<tr>
  <td>marketing_consent_updated_at</td>
  <td>The date and time when the customer consented to receive marketing material by email. If no date is provided, then the date and time when the consent information was sent is used.</td>
</tr>
<tr>
  <td>marketing_opt_in_level</td>
  <td>The marketing subscription opt-in level, as described in the M3AAWG Sender Best Common Practices, that the customer gave when they consented to receive marketing material by email.</td>
</tr>
<tr>
  <td>marketing_consent_state</td>
  <td>Field indicating if the customer has consented to receive marketing material via email. Coalescing of the new `email_marketing_consent_state` field and the deprecated `accepts_marketing` field. Records with the old field will be marked with '(legacy)'.\n</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_83Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">83. model.shopify.shopify__customer_emails</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    Each record represents a customer email in Shopify.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">customer_emails</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_utils</span><span class="p">.</span><span class="n">star</span><span class="p">(</span><span class="k">from</span><span class="o">=</span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;int_shopify__customer_email_rollup&#39;</span><span class="p">),</span><span class="w"> </span><span class="k">except</span><span class="o">=</span><span class="p">[</span><span class="ss">&quot;orders_count&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;total_spent&quot;</span><span class="p">])</span><span class="w"> </span><span class="err">}}</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;int_shopify__customer_email_rollup&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="p">),</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;int_shopify__emails__order_aggregates&#39;</span><span class="w"> </span><span class="p">)</span><span class="err">}}</span>
<span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="n">email</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">null</span>

<span class="p">),</span><span class="w"> </span><span class="n">abandoned</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="k">lower</span><span class="p">(</span><span class="n">email</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">email</span><span class="p">,</span>
<span class="w">        </span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">checkout_id</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lifetime_abandoned_checkouts</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_abandoned_checkout&#39;</span><span class="w"> </span><span class="p">)</span><span class="err">}}</span>
<span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="n">email</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">null</span>
<span class="w">    </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>

<span class="p">),</span><span class="w"> </span><span class="n">joined</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">customer_emails</span><span class="p">.</span><span class="o">*</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">abandoned</span><span class="p">.</span><span class="n">lifetime_abandoned_checkouts</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lifetime_abandoned_checkouts</span><span class="p">,</span>
<span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="n">first_order_timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="n">most_recent_order_timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="n">avg_order_value</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">lifetime_total_spent</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lifetime_total_spent</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">lifetime_total_refunded</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lifetime_total_refunded</span><span class="p">,</span>
<span class="w">        </span><span class="p">(</span><span class="k">coalesce</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">lifetime_total_spent</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">coalesce</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">lifetime_total_refunded</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lifetime_total_net</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">lifetime_count_orders</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lifetime_count_orders</span><span class="p">,</span>
<span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="n">avg_quantity_per_order</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">lifetime_total_tax</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lifetime_total_tax</span><span class="p">,</span>
<span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="n">avg_tax_per_order</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">lifetime_total_discount</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lifetime_total_discount</span><span class="p">,</span>
<span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="n">avg_discount_per_order</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">lifetime_total_shipping</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lifetime_total_shipping</span><span class="p">,</span>
<span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="n">avg_shipping_per_order</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">lifetime_total_shipping_with_discounts</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lifetime_total_shipping_with_discounts</span><span class="p">,</span>
<span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="n">avg_shipping_with_discounts_per_order</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">lifetime_total_shipping_tax</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lifetime_total_shipping_tax</span><span class="p">,</span>
<span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="n">avg_shipping_tax_per_order</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">customer_emails</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">orders</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">customer_emails</span><span class="p">.</span><span class="n">email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">email</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">customer_emails</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">source_relation</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">abandoned</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">customer_emails</span><span class="p">.</span><span class="n">email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">abandoned</span><span class="p">.</span><span class="n">email</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">customer_emails</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">abandoned</span><span class="p">.</span><span class="n">source_relation</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="n">joined</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>last_fivetran_synced</td>
  <td>The time when a record was last updated by Fivetran.</td>
</tr>
<tr>
  <td>default_address_id</td>
  <td>The default address for the customer.</td>
</tr>
<tr>
  <td>email</td>
  <td>The unique email address of the customer.</td>
</tr>
<tr>
  <td>first_name</td>
  <td>The customer's first name.</td>
</tr>
<tr>
  <td>customer_ids</td>
  <td>Comma-separated list of customer IDs associated with the email.</td>
</tr>
<tr>
  <td>last_name</td>
  <td>The customer's last name.</td>
</tr>
<tr>
  <td>lifetime_count_orders</td>
  <td>The number of orders associated with this customer.</td>
</tr>
<tr>
  <td>phone_numbers</td>
  <td>Comma-separated list of phone numbers associated with this email.</td>
</tr>
<tr>
  <td>account_state</td>
  <td>The state of the customer's account with a shop.</td>
</tr>
<tr>
  <td>is_tax_exempt</td>
  <td>Whether the customer is exempt from paying taxes on their order. If true, then taxes won't be applied to an order at checkout. If false, then taxes will be applied at checkout.</td>
</tr>
<tr>
  <td>last_updated_at</td>
  <td>The date and time when the customer information was last updated.</td>
</tr>
<tr>
  <td>is_verified_email</td>
  <td>Whether the customer has verified their email address.</td>
</tr>
<tr>
  <td>first_order_timestamp</td>
  <td>The timestamp the customer completed their first order.</td>
</tr>
<tr>
  <td>most_recent_order_timestamp</td>
  <td>The timestamp the customer completed their most recent order.</td>
</tr>
<tr>
  <td>avg_order_value</td>
  <td>The average order value for the customer.</td>
</tr>
<tr>
  <td>lifetime_total_spent</td>
  <td>The total amount of money that the customer has spent on orders across their order history (in shop currency).</td>
</tr>
<tr>
  <td>lifetime_total_refunded</td>
  <td>The total amount of money that the customer has been refunded on orders across their order history.</td>
</tr>
<tr>
  <td>lifetime_total_net</td>
  <td>The total amount of money (minus refunds) that the customer has spent across their order history.</td>
</tr>
<tr>
  <td>first_account_created_at</td>
  <td>Timestamp of when the first account associated with this email was created.</td>
</tr>
<tr>
  <td>last_account_created_at</td>
  <td>Timestamp of when the last account associated with this email was created.</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The schema or database this record came from, if you are unioning multiple connectors. Null if not.</td>
</tr>
<tr>
  <td>lifetime_abandoned_checkouts</td>
  <td>Total number of abandoned checkouts abandoned by the customer.</td>
</tr>
<tr>
  <td>customer_tags</td>
  <td>A string aggregated list of all tags associated with a customer.</td>
</tr>
<tr>
  <td>avg_quantity_per_order</td>
  <td>Average quantity of items per order customer orders.</td>
</tr>
<tr>
  <td>lifetime_total_tax</td>
  <td>Total amount of tax attributed to the customer.</td>
</tr>
<tr>
  <td>avg_tax_per_order</td>
  <td>Average tax per order attributed to the customer.</td>
</tr>
<tr>
  <td>lifetime_total_discount</td>
  <td>Total discounts attributed to the customer.</td>
</tr>
<tr>
  <td>avg_discount_per_order</td>
  <td>Average discount per order attributed to the customer.</td>
</tr>
<tr>
  <td>lifetime_total_shipping</td>
  <td>Total shipping costs attributed to the customer.</td>
</tr>
<tr>
  <td>avg_shipping_per_order</td>
  <td>Average shipping cost per order attributed to the customer.</td>
</tr>
<tr>
  <td>lifetime_total_shipping_with_discounts</td>
  <td>Total shipping costs after discounts attributed to the customer.</td>
</tr>
<tr>
  <td>avg_shipping_with_discounts_per_order</td>
  <td>Average shipping costs after discounts per order attributed to the customer.</td>
</tr>
<tr>
  <td>lifetime_total_shipping_tax</td>
  <td>Total shipping tax attributed to the customer.</td>
</tr>
<tr>
  <td>avg_shipping_tax_per_order</td>
  <td>Average shipping tax per order attributed to the customer.</td>
</tr>
<tr>
  <td>marketing_consent_updated_at</td>
  <td>The date and time when the customer consented to receive marketing material by email. If no date is provided, then the date and time when the consent information was sent is used.</td>
</tr>
<tr>
  <td>currency</td>
  <td>The three-letter code (ISO 4217 format) for the currency that the customer used when they paid for their last order. Defaults to the shop currency. Returns the shop currency for test orders.</td>
</tr>
<tr>
  <td>marketing_consent_state</td>
  <td>Field indicating if the customer has consented to receive marketing material via email. Coalescing of the new `email_marketing_consent_state` field and the deprecated `accepts_marketing` field. Records with the old field will be marked with '(legacy)'.\n</td>
</tr>
<tr>
  <td>marketing_opt_in_level</td>
  <td>The marketing subscription opt-in level, as described in the M3AAWG Sender Best Common Practices, that the customer gave when they consented to receive marketing material by email.</td>
</tr>
<tr>
  <td>note</td>
  <td>A note about the customer.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_84Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">84. model.shopify.int_shopify__discounts__order_aggregates</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">order_discount_code</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_order_discount_code&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">orders</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;shopify__orders&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">orders_aggregated</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">order_discount_code</span><span class="p">.</span><span class="n">code</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_discount_code</span><span class="p">.</span><span class="k">type</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_discount_code</span><span class="p">.</span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="k">avg</span><span class="p">(</span><span class="n">order_discount_code</span><span class="p">.</span><span class="n">amount</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">avg_order_discount_amount</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">order_discount_code</span><span class="p">.</span><span class="n">amount</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">total_order_discount_amount</span><span class="p">,</span>
<span class="w">        </span><span class="k">max</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">total_line_items_price</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">total_order_line_items_price</span><span class="p">,</span><span class="w"> </span><span class="c1">-- summing would multiply the total by the # of discount codes applied to an order</span>
<span class="w">        </span><span class="k">max</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">shipping_cost</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">total_order_shipping_cost</span><span class="p">,</span><span class="w"> </span><span class="c1">-- summing would multiply the total by the # of discount codes applied to an order</span>
<span class="w">        </span><span class="k">max</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">refund_subtotal</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">refund_total_tax</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">total_order_refund_amount</span><span class="p">,</span><span class="w"> </span><span class="c1">-- summing would multiply the total by the # of discount codes applied to an order</span>
<span class="w">        </span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">customer_id</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_customers</span><span class="p">,</span>
<span class="w">        </span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">email</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_customer_emails</span><span class="p">,</span>
<span class="w">        </span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">order_discount_code</span><span class="p">.</span><span class="n">order_id</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_orders</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">order_discount_code</span>
<span class="w">    </span><span class="k">join</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">order_discount_code</span><span class="p">.</span><span class="n">order_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">order_id</span><span class="w"> </span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">order_discount_code</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">source_relation</span>

<span class="w">    </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="n">orders_aggregated</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_85Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">85. model.shopify.int_shopify__daily_orders</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;shopify__orders&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">coalesce</span><span class="p">(</span><span class="n">is_deleted</span><span class="p">,</span><span class="w"> </span><span class="k">false</span><span class="p">)</span>
<span class="p">),</span>

<span class="n">order_lines</span><span class="w"> </span><span class="k">as</span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;shopify__order_lines&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">order_aggregates</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="k">cast</span><span class="p">(</span><span class="err">{{</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">date_trunc</span><span class="p">(</span><span class="s1">&#39;day&#39;</span><span class="p">,</span><span class="s1">&#39;created_timestamp&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nb">date</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">date_day</span><span class="p">,</span>
<span class="w">        </span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">order_id</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_orders</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">line_item_count</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_line_items</span><span class="p">,</span>
<span class="w">        </span><span class="k">avg</span><span class="p">(</span><span class="n">line_item_count</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">avg_line_item_count</span><span class="p">,</span>
<span class="w">        </span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">customer_id</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_customers</span><span class="p">,</span>
<span class="w">        </span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">email</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_customer_emails</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">order_adjusted_total</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">order_adjusted_total</span><span class="p">,</span>
<span class="w">        </span><span class="k">avg</span><span class="p">(</span><span class="n">order_adjusted_total</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">avg_order_value</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">shipping_cost</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">shipping_cost</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">order_adjustment_amount</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">order_adjustment_amount</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">order_adjustment_tax_amount</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">order_adjustment_tax_amount</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">refund_subtotal</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">refund_subtotal</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">refund_total_tax</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">refund_total_tax</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">total_discounts</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">total_discounts</span><span class="p">,</span>
<span class="w">        </span><span class="k">avg</span><span class="p">(</span><span class="n">total_discounts</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">avg_discount</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">shipping_discount_amount</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">shipping_discount_amount</span><span class="p">,</span>
<span class="w">        </span><span class="k">avg</span><span class="p">(</span><span class="n">shipping_discount_amount</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">avg_shipping_discount_amount</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">percentage_calc_discount_amount</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">percentage_calc_discount_amount</span><span class="p">,</span>
<span class="w">        </span><span class="k">avg</span><span class="p">(</span><span class="n">percentage_calc_discount_amount</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">avg_percentage_calc_discount_amount</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">fixed_amount_discount_amount</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">fixed_amount_discount_amount</span><span class="p">,</span>
<span class="w">        </span><span class="k">avg</span><span class="p">(</span><span class="n">fixed_amount_discount_amount</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">avg_fixed_amount_discount_amount</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">count_discount_codes_applied</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_discount_codes_applied</span><span class="p">,</span>
<span class="w">        </span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">location_id</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_locations_ordered_from</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="k">case</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="n">count_discount_codes_applied</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">end</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_orders_with_discounts</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="k">case</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="n">refund_subtotal</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">end</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_orders_with_refunds</span><span class="p">,</span>
<span class="w">        </span><span class="k">min</span><span class="p">(</span><span class="n">created_timestamp</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">first_order_timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="k">max</span><span class="p">(</span><span class="n">created_timestamp</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">last_order_timestamp</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">orders</span>
<span class="w">    </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>

<span class="p">),</span>

<span class="n">order_line_aggregates</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="n">order_lines</span><span class="p">.</span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="k">cast</span><span class="p">(</span><span class="err">{{</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">date_trunc</span><span class="p">(</span><span class="s1">&#39;day&#39;</span><span class="p">,</span><span class="s1">&#39;orders.created_timestamp&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nb">date</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">date_day</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">order_lines</span><span class="p">.</span><span class="n">quantity</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">quantity_sold</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">order_lines</span><span class="p">.</span><span class="n">refunded_quantity</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">quantity_refunded</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">order_lines</span><span class="p">.</span><span class="n">quantity_net_refunds</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">quantity_net</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">order_lines</span><span class="p">.</span><span class="n">quantity</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">order_lines</span><span class="p">.</span><span class="n">order_id</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">avg_quantity_sold</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">order_lines</span><span class="p">.</span><span class="n">quantity_net_refunds</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">order_lines</span><span class="p">.</span><span class="n">order_id</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">avg_quantity_net</span><span class="p">,</span>
<span class="w">        </span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">order_lines</span><span class="p">.</span><span class="n">variant_id</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_variants_sold</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">order_lines</span><span class="p">.</span><span class="n">product_id</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_products_sold</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="k">case</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="n">order_lines</span><span class="p">.</span><span class="n">is_gift_card</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">order_lines</span><span class="p">.</span><span class="n">quantity_net_refunds</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">end</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">quantity_gift_cards_sold</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="k">case</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="n">order_lines</span><span class="p">.</span><span class="n">is_shipping_required</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">order_lines</span><span class="p">.</span><span class="n">quantity_net_refunds</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">end</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">quantity_requiring_shipping</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">order_lines</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="c1">-- just joining with order to get the created_timestamp</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">order_lines</span><span class="p">.</span><span class="n">order_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">order_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">order_lines</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">source_relation</span>

<span class="w">    </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
<span class="p">),</span>

<span class="k">final</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">order_aggregates</span><span class="p">.</span><span class="o">*</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_line_aggregates</span><span class="p">.</span><span class="n">quantity_sold</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_line_aggregates</span><span class="p">.</span><span class="n">quantity_refunded</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_line_aggregates</span><span class="p">.</span><span class="n">quantity_net</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_line_aggregates</span><span class="p">.</span><span class="n">count_variants_sold</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_line_aggregates</span><span class="p">.</span><span class="n">count_products_sold</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_line_aggregates</span><span class="p">.</span><span class="n">quantity_gift_cards_sold</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_line_aggregates</span><span class="p">.</span><span class="n">quantity_requiring_shipping</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_line_aggregates</span><span class="p">.</span><span class="n">avg_quantity_sold</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_line_aggregates</span><span class="p">.</span><span class="n">avg_quantity_net</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">order_aggregates</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">order_line_aggregates</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">order_aggregates</span><span class="p">.</span><span class="n">date_day</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">order_line_aggregates</span><span class="p">.</span><span class="n">date_day</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">order_aggregates</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">order_line_aggregates</span><span class="p">.</span><span class="n">source_relation</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="k">final</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_86Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">86. model.shopify.int_shopify__product__order_line_aggregates</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
     Model description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">order_lines</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;shopify__order_lines&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="p">),</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;shopify__orders&#39;</span><span class="p">)</span><span class="err">}}</span>

<span class="p">),</span><span class="w"> </span><span class="n">product_aggregated</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">order_lines</span><span class="p">.</span><span class="n">product_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">order_lines</span><span class="p">.</span><span class="n">source_relation</span><span class="p">,</span>

<span class="w">        </span><span class="c1">-- moved over from shopify__products</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">order_lines</span><span class="p">.</span><span class="n">quantity</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">quantity_sold</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">order_lines</span><span class="p">.</span><span class="n">pre_tax_price</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">subtotal_sold</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">order_lines</span><span class="p">.</span><span class="n">quantity_net_refunds</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">quantity_sold_net_refunds</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">order_lines</span><span class="p">.</span><span class="n">subtotal_net_refunds</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">subtotal_sold_net_refunds</span><span class="p">,</span>
<span class="w">        </span><span class="k">min</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">created_timestamp</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">first_order_timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="k">max</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">created_timestamp</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">most_recent_order_timestamp</span><span class="p">,</span>

<span class="w">        </span><span class="c1">-- new columns</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">order_lines</span><span class="p">.</span><span class="n">total_discount</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">product_total_discount</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">order_lines</span><span class="p">.</span><span class="n">order_line_tax</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">product_total_tax</span><span class="p">,</span>
<span class="w">        </span><span class="k">avg</span><span class="p">(</span><span class="n">order_lines</span><span class="p">.</span><span class="n">quantity</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">avg_quantity_per_order_line</span><span class="p">,</span>
<span class="w">        </span><span class="k">avg</span><span class="p">(</span><span class="n">order_lines</span><span class="p">.</span><span class="n">total_discount</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">product_avg_discount_per_order_line</span><span class="p">,</span>
<span class="w">        </span><span class="k">avg</span><span class="p">(</span><span class="n">order_lines</span><span class="p">.</span><span class="n">order_line_tax</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">product_avg_tax_per_order_line</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">order_lines</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">orders</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">order_lines</span><span class="p">.</span><span class="n">order_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">order_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">order_lines</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">source_relation</span>
<span class="w">    </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>

<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="n">product_aggregated</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
     Column description is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_87Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">87. model.shopify.shopify__discounts</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    Each record represents a unique discount, enriched with information about its associated `price_rule` and metrics regarding orders and abandoned checkouts.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="err">{{</span>
<span class="w">    </span><span class="n">config</span><span class="p">(</span>
<span class="w">        </span><span class="n">materialized</span><span class="o">=</span><span class="s1">&#39;table&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">target</span><span class="p">.</span><span class="k">type</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;bigquery&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;databricks&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;spark&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;incremental&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">unique_key</span><span class="o">=</span><span class="s1">&#39;discounts_unique_key&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">incremental_strategy</span><span class="o">=</span><span class="s1">&#39;delete+insert&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">target</span><span class="p">.</span><span class="k">type</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;postgres&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;redshift&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;snowflake&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;merge&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">cluster_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;discount_code_id&#39;</span><span class="p">]</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span>
<span class="err">}}</span>

<span class="k">with</span><span class="w"> </span><span class="n">discount</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="o">*</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_utils</span><span class="p">.</span><span class="n">generate_surrogate_key</span><span class="p">([</span><span class="s1">&#39;source_relation&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;discount_code_id&#39;</span><span class="p">])</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">discounts_unique_key</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_discount_code&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="w">    </span><span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">is_incremental</span><span class="p">()</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
<span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="k">cast</span><span class="p">(</span><span class="k">coalesce</span><span class="p">(</span><span class="n">updated_at</span><span class="p">,</span><span class="w"> </span><span class="n">created_at</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nb">date</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">shopify</span><span class="p">.</span><span class="n">shopify_lookback</span><span class="p">(</span>
<span class="w">        </span><span class="n">from_date</span><span class="o">=</span><span class="ss">&quot;max(cast(coalesce(updated_at, created_at) as date))&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="nb">interval</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;lookback_window&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">),</span><span class="w"> </span>
<span class="w">        </span><span class="n">datepart</span><span class="o">=</span><span class="s1">&#39;day&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="w">    </span><span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="n">endif</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
<span class="p">),</span>

<span class="n">price_rule</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_price_rule&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">orders_aggregated</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;int_shopify__discounts__order_aggregates&#39;</span><span class="p">)</span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">abandoned_checkouts_aggregated</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;int_shopify__discounts__abandoned_checkouts&#39;</span><span class="p">)</span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">discount_price_rule_joined</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="n">discount</span><span class="p">.</span><span class="o">*</span><span class="p">,</span>
<span class="w">        </span><span class="n">price_rule</span><span class="p">.</span><span class="n">target_selection</span><span class="p">,</span>
<span class="w">        </span><span class="n">price_rule</span><span class="p">.</span><span class="n">target_type</span><span class="p">,</span>
<span class="w">        </span><span class="n">price_rule</span><span class="p">.</span><span class="n">title</span><span class="p">,</span>
<span class="w">        </span><span class="n">price_rule</span><span class="p">.</span><span class="n">usage_limit</span><span class="p">,</span>
<span class="w">        </span><span class="n">price_rule</span><span class="p">.</span><span class="n">value</span><span class="p">,</span>
<span class="w">        </span><span class="n">price_rule</span><span class="p">.</span><span class="n">value_type</span><span class="p">,</span>
<span class="w">        </span><span class="n">price_rule</span><span class="p">.</span><span class="n">allocation_limit</span><span class="p">,</span>
<span class="w">        </span><span class="n">price_rule</span><span class="p">.</span><span class="n">allocation_method</span><span class="p">,</span>
<span class="w">        </span><span class="n">price_rule</span><span class="p">.</span><span class="n">is_once_per_customer</span><span class="p">,</span>
<span class="w">        </span><span class="n">price_rule</span><span class="p">.</span><span class="n">customer_selection</span><span class="p">,</span>
<span class="w">        </span><span class="c1">-- the below are NULL if customer_selection = all</span>
<span class="w">        </span><span class="n">price_rule</span><span class="p">.</span><span class="n">prereq_min_quantity</span><span class="p">,</span>
<span class="w">        </span><span class="n">price_rule</span><span class="p">.</span><span class="n">prereq_max_shipping_price</span><span class="p">,</span>
<span class="w">        </span><span class="n">price_rule</span><span class="p">.</span><span class="n">prereq_min_subtotal</span><span class="p">,</span>
<span class="w">        </span><span class="n">price_rule</span><span class="p">.</span><span class="n">prereq_min_purchase_quantity_for_entitlement</span><span class="p">,</span>
<span class="w">        </span><span class="n">price_rule</span><span class="p">.</span><span class="n">prereq_buy_x_get_this</span><span class="p">,</span>
<span class="w">        </span><span class="n">price_rule</span><span class="p">.</span><span class="n">prereq_buy_this_get_y</span><span class="p">,</span>
<span class="w">        </span><span class="n">price_rule</span><span class="p">.</span><span class="n">starts_at</span><span class="p">,</span>
<span class="w">        </span><span class="n">price_rule</span><span class="p">.</span><span class="n">ends_at</span><span class="p">,</span>
<span class="w">        </span><span class="n">price_rule</span><span class="p">.</span><span class="n">created_at</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">price_rule_created_at</span><span class="p">,</span>
<span class="w">        </span><span class="n">price_rule</span><span class="p">.</span><span class="n">updated_at</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">price_rule_updated_at</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">discount</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">price_rule</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">discount</span><span class="p">.</span><span class="n">price_rule_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">price_rule</span><span class="p">.</span><span class="n">price_rule_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">discount</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">price_rule</span><span class="p">.</span><span class="n">source_relation</span>
<span class="p">),</span>

<span class="n">aggregates_joined</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">discount_price_rule_joined</span><span class="p">.</span><span class="o">*</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">orders_aggregated</span><span class="p">.</span><span class="n">count_orders</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_orders</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">abandoned_checkouts_aggregated</span><span class="p">.</span><span class="n">count_abandoned_checkouts</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_abandoned_checkouts</span><span class="p">,</span>
<span class="w">        </span><span class="n">orders_aggregated</span><span class="p">.</span><span class="n">avg_order_discount_amount</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">orders_aggregated</span><span class="p">.</span><span class="n">total_order_discount_amount</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">total_order_discount_amount</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">abandoned_checkouts_aggregated</span><span class="p">.</span><span class="n">total_abandoned_checkout_discount_amount</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">total_abandoned_checkout_discount_amount</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">orders_aggregated</span><span class="p">.</span><span class="n">total_order_line_items_price</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">total_order_line_items_price</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">orders_aggregated</span><span class="p">.</span><span class="n">total_order_shipping_cost</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">total_order_shipping_cost</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">abandoned_checkouts_aggregated</span><span class="p">.</span><span class="n">total_abandoned_checkout_shipping_price</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">total_abandoned_checkout_shipping_price</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">orders_aggregated</span><span class="p">.</span><span class="n">total_order_refund_amount</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">total_order_refund_amount</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">orders_aggregated</span><span class="p">.</span><span class="n">count_customers</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_customers</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">orders_aggregated</span><span class="p">.</span><span class="n">count_customer_emails</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_customer_emails</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">abandoned_checkouts_aggregated</span><span class="p">.</span><span class="n">count_abandoned_checkout_customers</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_abandoned_checkout_customers</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">abandoned_checkouts_aggregated</span><span class="p">.</span><span class="n">count_abandoned_checkout_customer_emails</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_abandoned_checkout_customer_emails</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">discount_price_rule_joined</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">orders_aggregated</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">discount_price_rule_joined</span><span class="p">.</span><span class="n">code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orders_aggregated</span><span class="p">.</span><span class="n">code</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">discount_price_rule_joined</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orders_aggregated</span><span class="p">.</span><span class="n">source_relation</span>
<span class="w">        </span><span class="c1">-- in case one CODE can apply to both shipping and line items, percentages and fixed_amounts</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="k">case</span><span class="w"> </span>
<span class="w">                </span><span class="k">when</span><span class="w"> </span><span class="n">discount_price_rule_joined</span><span class="p">.</span><span class="n">target_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;shipping_line&#39;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="s1">&#39;shipping&#39;</span><span class="w"> </span><span class="c1">-- when target_type = &#39;shipping&#39;, value_type = &#39;percentage&#39;</span>
<span class="w">                </span><span class="k">else</span><span class="w"> </span><span class="n">discount_price_rule_joined</span><span class="p">.</span><span class="n">value_type</span><span class="w"> </span><span class="k">end</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orders_aggregated</span><span class="p">.</span><span class="k">type</span>
<span class="w">        </span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">abandoned_checkouts_aggregated</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">discount_price_rule_joined</span><span class="p">.</span><span class="n">code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">abandoned_checkouts_aggregated</span><span class="p">.</span><span class="n">code</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">discount_price_rule_joined</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">abandoned_checkouts_aggregated</span><span class="p">.</span><span class="n">source_relation</span>
<span class="w">        </span><span class="c1">-- in case one CODE can apply to both shipping and line items, percentages and fixed_amounts</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="k">case</span><span class="w"> </span>
<span class="w">                </span><span class="k">when</span><span class="w"> </span><span class="n">discount_price_rule_joined</span><span class="p">.</span><span class="n">target_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;shipping_line&#39;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="s1">&#39;shipping&#39;</span><span class="w"> </span><span class="c1">-- when target_type = &#39;shipping&#39;, value_type = &#39;percentage&#39;</span>
<span class="w">                </span><span class="k">else</span><span class="w"> </span><span class="n">discount_price_rule_joined</span><span class="p">.</span><span class="n">value_type</span><span class="w"> </span><span class="k">end</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">abandoned_checkouts_aggregated</span><span class="p">.</span><span class="k">type</span><span class="w"> </span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="k">from</span><span class="w"> </span><span class="n">aggregates_joined</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>discounts_unique_key</td>
  <td>Unique key representing a discount. Hashed on 'discount_code_id' and 'source_relation'.</td>
</tr>
<tr>
  <td>_fivetran_synced</td>
  <td>The time when a record was last updated by Fivetran.</td>
</tr>
<tr>
  <td>code</td>
  <td>The case-insensitive discount code that customers use at checkout. Shopify recommends this map onto the associated `price_rule.title`.</td>
</tr>
<tr>
  <td>created_at</td>
  <td>The date and time (ISO 8601 format) when the discount code was created.</td>
</tr>
<tr>
  <td>discount_code_id</td>
  <td>The ID for the discount code.</td>
</tr>
<tr>
  <td>price_rule_id</td>
  <td>The ID for the price rule.</td>
</tr>
<tr>
  <td>updated_at</td>
  <td>The date and time (ISO 8601 format) when the discount code was updated.</td>
</tr>
<tr>
  <td>usage_count</td>
  <td>The number of times that the discount code has been redeemed.</td>
</tr>
<tr>
  <td>allocation_limit</td>
  <td>The number of times the discount can be allocated on the cart - if eligible. For example a Buy 1 hat Get 1 hat for free discount can be applied 3 times on a cart having more than 6 hats,  where maximum of 3 hats get discounted - if the allocation_limit is 3. Empty (null) allocation_limit means unlimited number of allocations.\n</td>
</tr>
<tr>
  <td>allocation_method</td>
  <td>The allocation method of the price rule. Valid values include `each` (the discount is applied to each of the entitled items. For example, for a price rule that takes $15 off, each entitled line item in a checkout will be discounted by $15) and `across` (the calculated discount amount will be applied across the entitled items. For example, for a price rule that takes $15 off, the discount will be applied across all the entitled items).\n</td>
</tr>
<tr>
  <td>price_rule_created_at</td>
  <td>The date and time (ISO 8601 format) when the price rule was created.</td>
</tr>
<tr>
  <td>customer_selection</td>
  <td>The customer selection for the price rule. Valid values include `all` (the price rule is valid for all customers) and `prerequisite`  (the customer must either belong to one of the customer segments specified by customer_segment_prerequisite_ids, or be one of the customers specified by prerequisite_customer_ids).\n</td>
</tr>
<tr>
  <td>ends_at</td>
  <td>The date and time (ISO 8601 format) when the price rule ends. Must be after starts_at.</td>
</tr>
<tr>
  <td>is_once_per_customer</td>
  <td>Boolean representing whether the generated discount code will be valid only for a single use per customer. This is tracked using customer ID.</td>
</tr>
<tr>
  <td>prereq_min_quantity</td>
  <td>If `customer_selection` is `prerequisite`, the minimum number of items for the price rule to be applicable. The quantity of an entitled cart item must be greater than or equal to this value.</td>
</tr>
<tr>
  <td>prereq_max_shipping_price</td>
  <td>If `customer_selection` is `prerequisite`, the maximum shipping price for the price rule to be applicable. The shipping price must be less than or equal to this value</td>
</tr>
<tr>
  <td>prereq_min_subtotal</td>
  <td>If `customer_selection` is `prerequisite`, the minimum subtotal for the price rule to be applicable. The subtotal of the entitled cart items must be greater than or equal to this value for the discount to apply.</td>
</tr>
<tr>
  <td>prereq_min_purchase_quantity_for_entitlement</td>
  <td>If `customer_selection` is `prerequisite`, the prerequisite purchase for a Buy X Get Y discount. The minimum purchase amount required to be entitled to the discount.</td>
</tr>
<tr>
  <td>prereq_buy_x_get_this</td>
  <td>If `customer_selection` is `prerequisite`, in a Buy/Get ratio for a Buy X Get Y discount, this is the offered 'get' quantity.</td>
</tr>
<tr>
  <td>prereq_buy_this_get_y</td>
  <td>If `customer_selection` is `prerequisite`, in a Buy/Get ratio for a Buy X Get Y discount, this defines the necessary 'buy' quantity.</td>
</tr>
<tr>
  <td>starts_at</td>
  <td>The date and time (ISO 8601 format) when the price rule starts.</td>
</tr>
<tr>
  <td>target_selection</td>
  <td>The target selection method of the price rule. Valid values include `all` (the price rule applies the discount to all line items in the checkout) and  `entitled` (the price rule applies the discount to selected entitlements only).\n</td>
</tr>
<tr>
  <td>target_type</td>
  <td>The target type that the price rule applies to. Valid values include `line_item` (the price rule applies to the cart's line items) and `shipping_line` (the price rule applies to the cart's shipping lines).</td>
</tr>
<tr>
  <td>title</td>
  <td>The title of the price rule. This is used by the Shopify admin search to retrieve discounts. It is also displayed on the Discounts page of the Shopify admin for bulk discounts.  Shopify recommends that this map onto the associated `discount_code.code`.\n</td>
</tr>
<tr>
  <td>price_rule_updated_at</td>
  <td>The date and time (ISO 8601 format) when the price rule was updated.</td>
</tr>
<tr>
  <td>usage_limit</td>
  <td>The maximum number of times the price rule can be used, per discount code.</td>
</tr>
<tr>
  <td>value</td>
  <td>The value of the price rule. If if the value of `target_type` is `shipping_line`, then only -100 is accepted. The value must be negative.</td>
</tr>
<tr>
  <td>value_type</td>
  <td>The value type of the price rule. Valid values include `fixed_amount` (applies a discount of value as a unit of the store's currency. For example, if value is -30 and the store's currency is USD, then $30 USD is deducted when the discount is applied) and `percentage` (applies a percentage discount of value. For example, if value is -30, then 30% will be deducted when the discount is applied).\nIf `target_type` is `shipping_line`, then only `percentage` is accepted.\n</td>
</tr>
<tr>
  <td>total_order_discount_amount</td>
  <td>Total monetary amount (in shop currency) of discounts taken off of orders.</td>
</tr>
<tr>
  <td>total_abandoned_checkout_discount_amount</td>
  <td>Total monetary amount (in shop currency) of discounts taken off abandoned checkout orders.</td>
</tr>
<tr>
  <td>total_order_line_items_price</td>
  <td>Total monetary amount (in shop currency) of line items for orders that have used this discount.</td>
</tr>
<tr>
  <td>total_order_shipping_cost</td>
  <td>Total shipping costs for orders that used this discount.</td>
</tr>
<tr>
  <td>total_abandoned_checkout_shipping_price</td>
  <td>Total projected shipping costs for abandoned checkouts that applied this discount first.</td>
</tr>
<tr>
  <td>total_order_refund_amount</td>
  <td>Total refunded amount (in shop currency) for orders that used this discount code.</td>
</tr>
<tr>
  <td>count_customers</td>
  <td>Count of distinct customers who placed orders using this discount.</td>
</tr>
<tr>
  <td>count_customer_emails</td>
  <td>Count of distinct customer emails who placed orders using this discount.</td>
</tr>
<tr>
  <td>avg_order_discount_amount</td>
  <td>Average amount (in shop currency) of discount taken off orders.</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The schema or database this record came from if you are making use of the `shopify_union_schemas` or `shopify_union_databases` variables, respectively. Empty string if you are not using either of these variables to union together multiple Shopify connectors.</td>
</tr>
<tr>
  <td>count_orders</td>
  <td>Count of orders in which this discount code was applied.</td>
</tr>
<tr>
  <td>count_abandoned_checkouts</td>
  <td>Count of abandoned checkouts in which this discount code was applied.</td>
</tr>
<tr>
  <td>count_abandoned_checkout_customers</td>
  <td>Distinct count of customers who applied this discount in a checkout that they abandoned.</td>
</tr>
<tr>
  <td>count_abandoned_checkout_customer_emails</td>
  <td>Distinct count of customer emails who applied this discount in a checkout that they abandoned.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_88Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">88. model.shopify.shopify__daily_shop</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    Each record represents a day in your Shop, enriched with a suite of metrics.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">shop</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_shop&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">calendar</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;shopify__calendar&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="k">cast</span><span class="p">(</span><span class="err">{{</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">date_trunc</span><span class="p">(</span><span class="s1">&#39;day&#39;</span><span class="p">,</span><span class="s1">&#39;date_day&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nb">date</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">date_day</span>
<span class="p">),</span>

<span class="n">daily_orders</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;int_shopify__daily_orders&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">daily_abandoned_checkouts</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;int_shopify__daily_abandoned_checkouts&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_using_fulfillment_event&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">false</span><span class="p">)</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
<span class="n">daily_fulfillment</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;int_shopify__daily_fulfillment&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>
<span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="n">endif</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>

<span class="n">shop_calendar</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="k">cast</span><span class="p">(</span><span class="err">{{</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">date_trunc</span><span class="p">(</span><span class="s1">&#39;day&#39;</span><span class="p">,</span><span class="s1">&#39;calendar.date_day&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nb">date</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">date_day</span><span class="p">,</span>
<span class="w">        </span><span class="n">shop</span><span class="p">.</span><span class="n">shop_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">shop</span><span class="p">.</span><span class="n">name</span><span class="p">,</span>
<span class="w">        </span><span class="n">shop</span><span class="p">.</span><span class="k">domain</span><span class="p">,</span>
<span class="w">        </span><span class="n">shop</span><span class="p">.</span><span class="n">is_deleted</span><span class="p">,</span>
<span class="w">        </span><span class="n">shop</span><span class="p">.</span><span class="n">currency</span><span class="p">,</span>
<span class="w">        </span><span class="n">shop</span><span class="p">.</span><span class="n">enabled_presentment_currencies</span><span class="p">,</span>
<span class="w">        </span><span class="n">shop</span><span class="p">.</span><span class="n">iana_timezone</span><span class="p">,</span>
<span class="w">        </span><span class="n">shop</span><span class="p">.</span><span class="n">created_at</span><span class="p">,</span>
<span class="w">        </span><span class="n">shop</span><span class="p">.</span><span class="n">source_relation</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">calendar</span>
<span class="w">    </span><span class="k">join</span><span class="w"> </span><span class="n">shop</span><span class="w"> </span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="k">cast</span><span class="p">(</span><span class="n">shop</span><span class="p">.</span><span class="n">created_at</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nb">date</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">calendar</span><span class="p">.</span><span class="n">date_day</span>
<span class="p">),</span>

<span class="k">final</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">shop_calendar</span><span class="p">.</span><span class="o">*</span><span class="p">,</span>

<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">daily_orders</span><span class="p">.</span><span class="n">count_orders</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_orders</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">daily_orders</span><span class="p">.</span><span class="n">count_line_items</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_line_items</span><span class="p">,</span>
<span class="w">        </span><span class="n">daily_orders</span><span class="p">.</span><span class="n">avg_line_item_count</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">daily_orders</span><span class="p">.</span><span class="n">count_customers</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_customers</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">daily_orders</span><span class="p">.</span><span class="n">count_customer_emails</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_customer_emails</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">daily_orders</span><span class="p">.</span><span class="n">order_adjusted_total</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">order_adjusted_total</span><span class="p">,</span>
<span class="w">        </span><span class="n">daily_orders</span><span class="p">.</span><span class="n">avg_order_value</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">daily_orders</span><span class="p">.</span><span class="n">shipping_cost</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">shipping_cost</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">daily_orders</span><span class="p">.</span><span class="n">order_adjustment_amount</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">order_adjustment_amount</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">daily_orders</span><span class="p">.</span><span class="n">order_adjustment_tax_amount</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">order_adjustment_tax_amount</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">daily_orders</span><span class="p">.</span><span class="n">refund_subtotal</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">refund_subtotal</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">daily_orders</span><span class="p">.</span><span class="n">refund_total_tax</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">refund_total_tax</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">daily_orders</span><span class="p">.</span><span class="n">total_discounts</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">total_discounts</span><span class="p">,</span>
<span class="w">        </span><span class="n">daily_orders</span><span class="p">.</span><span class="n">avg_discount</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">daily_orders</span><span class="p">.</span><span class="n">shipping_discount_amount</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">shipping_discount_amount</span><span class="p">,</span>
<span class="w">        </span><span class="n">daily_orders</span><span class="p">.</span><span class="n">avg_shipping_discount_amount</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">daily_orders</span><span class="p">.</span><span class="n">percentage_calc_discount_amount</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">percentage_calc_discount_amount</span><span class="p">,</span>
<span class="w">        </span><span class="n">daily_orders</span><span class="p">.</span><span class="n">avg_percentage_calc_discount_amount</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">daily_orders</span><span class="p">.</span><span class="n">fixed_amount_discount_amount</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">fixed_amount_discount_amount</span><span class="p">,</span>
<span class="w">        </span><span class="n">daily_orders</span><span class="p">.</span><span class="n">avg_fixed_amount_discount_amount</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">daily_orders</span><span class="p">.</span><span class="n">count_discount_codes_applied</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_discount_codes_applied</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">daily_orders</span><span class="p">.</span><span class="n">count_locations_ordered_from</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_locations_ordered_from</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">daily_orders</span><span class="p">.</span><span class="n">count_orders_with_discounts</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_orders_with_discounts</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">daily_orders</span><span class="p">.</span><span class="n">count_orders_with_refunds</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_orders_with_refunds</span><span class="p">,</span>
<span class="w">        </span><span class="n">daily_orders</span><span class="p">.</span><span class="n">first_order_timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="n">daily_orders</span><span class="p">.</span><span class="n">last_order_timestamp</span><span class="p">,</span>

<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">daily_orders</span><span class="p">.</span><span class="n">quantity_sold</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">quantity_sold</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">daily_orders</span><span class="p">.</span><span class="n">quantity_refunded</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">quantity_refunded</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">daily_orders</span><span class="p">.</span><span class="n">quantity_net</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">quantity_net</span><span class="p">,</span>
<span class="w">        </span><span class="n">daily_orders</span><span class="p">.</span><span class="n">avg_quantity_sold</span><span class="p">,</span>
<span class="w">        </span><span class="n">daily_orders</span><span class="p">.</span><span class="n">avg_quantity_net</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">daily_orders</span><span class="p">.</span><span class="n">count_variants_sold</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_variants_sold</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">daily_orders</span><span class="p">.</span><span class="n">count_products_sold</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_products_sold</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">daily_orders</span><span class="p">.</span><span class="n">quantity_gift_cards_sold</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">quantity_gift_cards_sold</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">daily_orders</span><span class="p">.</span><span class="n">quantity_requiring_shipping</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">quantity_requiring_shipping</span><span class="p">,</span>

<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">daily_abandoned_checkouts</span><span class="p">.</span><span class="n">count_abandoned_checkouts</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_abandoned_checkouts</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">daily_abandoned_checkouts</span><span class="p">.</span><span class="n">count_customers_abandoned_checkout</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_customers_abandoned_checkout</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">daily_abandoned_checkouts</span><span class="p">.</span><span class="n">count_customer_emails_abandoned_checkout</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_customer_emails_abandoned_checkout</span>

<span class="w">        </span><span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_using_fulfillment_event&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">false</span><span class="p">)</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
<span class="w">            </span><span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;attempted_delivery&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;delayed&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;delivered&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;failure&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;in_transit&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;out_for_delivery&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ready_for_pickup&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;picked_up&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;label_printed&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;label_purchased&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;confirmed&#39;</span><span class="p">]</span><span class="o">%</span><span class="err">}</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="k">coalesce</span><span class="p">(</span><span class="n">count_fulfillment_</span><span class="err">{{</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="err">}}</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count_fulfillment_</span><span class="err">{{</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="err">}}</span>
<span class="w">            </span><span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="n">endfor</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
<span class="w">        </span><span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="n">endif</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">shop_calendar</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">daily_orders</span><span class="w"> </span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">shop_calendar</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">daily_orders</span><span class="p">.</span><span class="n">source_relation</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">shop_calendar</span><span class="p">.</span><span class="n">date_day</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">daily_orders</span><span class="p">.</span><span class="n">date_day</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">daily_abandoned_checkouts</span><span class="w"> </span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">shop_calendar</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">daily_abandoned_checkouts</span><span class="p">.</span><span class="n">source_relation</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">shop_calendar</span><span class="p">.</span><span class="n">date_day</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">daily_abandoned_checkouts</span><span class="p">.</span><span class="n">date_day</span>
<span class="w">    </span><span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;shopify_using_fulfillment_event&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">false</span><span class="p">)</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">daily_fulfillment</span><span class="w"> </span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">shop_calendar</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">daily_fulfillment</span><span class="p">.</span><span class="n">source_relation</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">shop_calendar</span><span class="p">.</span><span class="n">date_day</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">daily_fulfillment</span><span class="p">.</span><span class="n">date_day</span>
<span class="w">    </span><span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="n">endif</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
<span class="w">    </span>
<span class="p">)</span>


<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="k">final</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>date_day</td>
  <td>Day for which the shop activity is being measured.</td>
</tr>
<tr>
  <td>shop_id</td>
  <td>The ID for the shop. A 64-bit unsigned integer.</td>
</tr>
<tr>
  <td>name</td>
  <td>The name of the shop.</td>
</tr>
<tr>
  <td>domain</td>
  <td>The shop's domain.</td>
</tr>
<tr>
  <td>is_deleted</td>
  <td>Boolean representing whether the record was soft-deleted in Shopify.</td>
</tr>
<tr>
  <td>currency</td>
  <td>The three-letter code (ISO 4217 format) for the shop's default currency.</td>
</tr>
<tr>
  <td>enabled_presentment_currencies</td>
  <td>An array of of enabled currencies (ISO 4217 format) that the shop accepts. Merchants can enable currencies from their Shopify Payments settings in the Shopify Admin.</td>
</tr>
<tr>
  <td>iana_timezone</td>
  <td>The name of the timezone assigned by the [IANA](https://www.iana.org/time-zones).</td>
</tr>
<tr>
  <td>created_at</td>
  <td>The date and time (ISO 8601) when the shop was created.</td>
</tr>
<tr>
  <td>count_orders</td>
  <td>Count of the distinct orders placed on this day.</td>
</tr>
<tr>
  <td>count_line_items</td>
  <td>Count of the line items included in orders placed on this day.</td>
</tr>
<tr>
  <td>count_customers</td>
  <td>Count of distinct customers who placed an order on this day.</td>
</tr>
<tr>
  <td>count_customer_emails</td>
  <td>Count of distinct customer email addresses who placed an order on this day.</td>
</tr>
<tr>
  <td>order_adjusted_total</td>
  <td>Order total adjusted for refunds and other adjustments. The calculation used for this field is as follows: total price listed on the original order (including shipping costs and discounts) + adjustments + adjustments tax - total refunds - refunds tax The order_adjusted_total will equate to the total sales - refunds listed within the transactions table for the order (after currency exchange).\n</td>
</tr>
<tr>
  <td>avg_order_value</td>
  <td>Average adjusted total per order placed on this day (in shop currency).</td>
</tr>
<tr>
  <td>shipping_cost</td>
  <td>The shipping cost of the orders placed on this day (in shop currency).</td>
</tr>
<tr>
  <td>order_adjustment_amount</td>
  <td>Total adjustment amount (in shop currency) applied to the orders placed on this day.</td>
</tr>
<tr>
  <td>order_adjustment_tax_amount</td>
  <td>Total tax applied to adjustments (in shop currency) on the orders placed on this day.</td>
</tr>
<tr>
  <td>refund_subtotal</td>
  <td>Total refund amount applied to the orders placed on this day.</td>
</tr>
<tr>
  <td>refund_total_tax</td>
  <td>Total tax applied to the refund on the orders placed on this day (in shop currency).</td>
</tr>
<tr>
  <td>total_discounts</td>
  <td>The total amount of the discount allocated to this day's orders in the shop's currency.</td>
</tr>
<tr>
  <td>shipping_discount_amount</td>
  <td>The total amount of discount (in shop currency) allocated toward shipping for orders placed on this day.</td>
</tr>
<tr>
  <td>percentage_calc_discount_amount</td>
  <td>The total amount of discount (in shop currency) allocated via a percentage-based discount for orders placed on this day.</td>
</tr>
<tr>
  <td>fixed_amount_discount_amount</td>
  <td>The total amount of discount (in shop currency) allocated via a fixed-amount discount for orders placed on this day.</td>
</tr>
<tr>
  <td>count_discount_codes_applied</td>
  <td>Distinct discount codes applied by customers on orders for this day.</td>
</tr>
<tr>
  <td>count_locations_ordered_from</td>
  <td>Distinct locations with orders placed against them on this day.</td>
</tr>
<tr>
  <td>count_orders_with_discounts</td>
  <td>Count of orders in which a discount was applied.</td>
</tr>
<tr>
  <td>count_orders_with_refunds</td>
  <td>Count of orders in which there was a refund.</td>
</tr>
<tr>
  <td>first_order_timestamp</td>
  <td>Timestamp of the first order of the day for the shop.</td>
</tr>
<tr>
  <td>last_order_timestamp</td>
  <td>Timestamp of the last order of the day for the shop.</td>
</tr>
<tr>
  <td>quantity_sold</td>
  <td>Total quantity sold from the inventory level. Includes refunds.</td>
</tr>
<tr>
  <td>quantity_refunded</td>
  <td>The quantity of goods ORDERED on this day that have been refunded.</td>
</tr>
<tr>
  <td>quantity_net</td>
  <td>Net quantity sold from this shop on this day. Excludes refunds.</td>
</tr>
<tr>
  <td>count_variants_sold</td>
  <td>Distinct product variants sold on this day (includes refunds).</td>
</tr>
<tr>
  <td>count_products_sold</td>
  <td>Distinct products sold on this day (includes refunds).</td>
</tr>
<tr>
  <td>quantity_gift_cards_sold</td>
  <td>Quantity of gift cards sold on this day.</td>
</tr>
<tr>
  <td>quantity_requiring_shipping</td>
  <td>Quantity of goods sold on this day that require shipping.</td>
</tr>
<tr>
  <td>count_abandoned_checkouts</td>
  <td>Count of abandoned checkouts on this day.</td>
</tr>
<tr>
  <td>count_customers_abandoned_checkout</td>
  <td>Count of distinct customers who abandoned checkouts on this day.</td>
</tr>
<tr>
  <td>count_customer_emails_abandoned_checkout</td>
  <td>Count of distinct customer emails who abandoned checkouts on this day.</td>
</tr>
<tr>
  <td>count_fulfillment_attempted_delivery</td>
  <td>Count of distinct fulfillments on this day where the delivery of the shipment was attempted, but unable to be completed.</td>
</tr>
<tr>
  <td>count_fulfillment_delivered</td>
  <td>Count of successful distinct fulfillments successfully delivered on this day.</td>
</tr>
<tr>
  <td>count_fulfillment_failure</td>
  <td>Count of failed distinct fulfillments on this day. Something went wrong when pulling tracking information for the shipment, such as the tracking number was invalid or the shipment was canceled.</td>
</tr>
<tr>
  <td>count_fulfillment_in_transit</td>
  <td>Count of distinct fulfillments in transit on this day. Each shipment is being transported between shipping facilities on the way to its destination.</td>
</tr>
<tr>
  <td>count_fulfillment_out_for_delivery</td>
  <td>Count of distinct fulfillments being delivered to their final destination.</td>
</tr>
<tr>
  <td>count_fulfillment_ready_for_pickup</td>
  <td>Count of distinct fulfillments ready for pickup at a shipping depot.</td>
</tr>
<tr>
  <td>count_fulfillment_picked_up</td>
  <td>Count of distinct fulfillments successfully picked up on this day.</td>
</tr>
<tr>
  <td>count_fulfillment_label_printed</td>
  <td>Count of distinct fulfillments for which a purchased shipping label has been printed on this day.</td>
</tr>
<tr>
  <td>count_fulfillment_label_purchased</td>
  <td>Count of distinct fulfillments for which a shipping label has been purchased (but not printed yet) on this day.</td>
</tr>
<tr>
  <td>count_fulfillment_confirmed</td>
  <td>Count of confirmed distinct fulfillments. This is the default status when no other information is available about a fulfillment.</td>
</tr>
<tr>
  <td>count_fulfillment_delayed</td>
  <td>Count of delayed distinct fulfillments.</td>
</tr>
<tr>
  <td>avg_line_item_count</td>
  <td>Average line item count for orders placed on this day.</td>
</tr>
<tr>
  <td>avg_discount</td>
  <td>Average total discount placed on orders on this day (in shop currency).</td>
</tr>
<tr>
  <td>avg_shipping_discount_amount</td>
  <td>Average discount amount (in shop currency) allocated toward shipping on orders placed on this day.</td>
</tr>
<tr>
  <td>avg_percentage_calc_discount_amount</td>
  <td>Average discount amount (in shop currency) allocated via a percentage-based-discount on orders placed on this day.</td>
</tr>
<tr>
  <td>avg_fixed_amount_discount_amount</td>
  <td>Average discount amount (in shop currency) allocated via a fixed-amount-discount on orders placed on this day.</td>
</tr>
<tr>
  <td>avg_quantity_sold</td>
  <td>Average quantity sold per order on this day. Includes refunds. (in shop currency)</td>
</tr>
<tr>
  <td>avg_quantity_net</td>
  <td>Average net quantity sold per order on this day. Excludes refunds. (in shop currency)</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The schema or database this record came from if you are making use of the `shopify_union_schemas` or `shopify_union_databases` variables, respectively. Empty string if you are not using either of these variables to union together multiple Shopify connectors.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_89Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">89. model.shopify.shopify__customer_cohorts</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    Each record represents a customer's performance in a calendar month.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="err">{{</span>
<span class="w">    </span><span class="n">config</span><span class="p">(</span>
<span class="w">        </span><span class="n">materialized</span><span class="o">=</span><span class="s1">&#39;table&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">shopify</span><span class="p">.</span><span class="n">shopify_is_databricks_sql_warehouse</span><span class="p">()</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;incremental&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">unique_key</span><span class="o">=</span><span class="s1">&#39;customer_cohort_id&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">incremental_strategy</span><span class="o">=</span><span class="s1">&#39;insert_overwrite&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">target</span><span class="p">.</span><span class="k">type</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;bigquery&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;databricks&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;spark&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;delete+insert&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">partition_by</span><span class="o">=</span><span class="err">{</span>
<span class="w">            </span><span class="ss">&quot;field&quot;</span><span class="p">:</span><span class="w"> </span><span class="ss">&quot;date_month&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="ss">&quot;data_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="ss">&quot;date&quot;</span>
<span class="w">            </span><span class="err">}</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">target</span><span class="p">.</span><span class="k">type</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;spark&#39;</span><span class="p">,</span><span class="s1">&#39;databricks&#39;</span><span class="p">)</span><span class="w"> </span>
<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;date_month&#39;</span><span class="p">],</span>
<span class="w">        </span><span class="n">cluster_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;date_month&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;customer_id&#39;</span><span class="p">],</span>
<span class="w">        </span><span class="n">file_format</span><span class="o">=</span><span class="s1">&#39;delta&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">shopify</span><span class="p">.</span><span class="n">shopify_is_databricks_sql_warehouse</span><span class="p">()</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;parquet&#39;</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span>
<span class="err">}}</span>

<span class="k">with</span><span class="w"> </span><span class="n">calendar</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;shopify__calendar&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="k">cast</span><span class="p">(</span><span class="err">{{</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">date_trunc</span><span class="p">(</span><span class="s1">&#39;month&#39;</span><span class="p">,</span><span class="s1">&#39;date_day&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nb">date</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">date_day</span>

<span class="w">    </span><span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">is_incremental</span><span class="p">()</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
<span class="w">    </span><span class="k">and</span><span class="w"> </span><span class="k">cast</span><span class="p">(</span><span class="n">date_day</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nb">date</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">shopify</span><span class="p">.</span><span class="n">shopify_lookback</span><span class="p">(</span><span class="n">from_date</span><span class="o">=</span><span class="ss">&quot;max(date_month)&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">interval</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">datepart</span><span class="o">=</span><span class="s1">&#39;month&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="w">    </span><span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="n">endif</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>

<span class="p">),</span><span class="w"> </span><span class="n">customers</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;shopify__customers&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="p">),</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;shopify__orders&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="p">),</span><span class="w"> </span><span class="n">customer_calendar</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="k">cast</span><span class="p">(</span><span class="n">calendar</span><span class="p">.</span><span class="n">date_day</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nb">date</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">date_month</span><span class="p">,</span>
<span class="w">        </span><span class="n">customers</span><span class="p">.</span><span class="n">customer_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">customers</span><span class="p">.</span><span class="n">first_order_timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="n">customers</span><span class="p">.</span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="k">cast</span><span class="p">(</span><span class="err">{{</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">date_trunc</span><span class="p">(</span><span class="s1">&#39;month&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;first_order_timestamp&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nb">date</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">cohort_month</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">calendar</span>
<span class="w">    </span><span class="k">inner</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">customers</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="k">cast</span><span class="p">(</span><span class="err">{{</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">date_trunc</span><span class="p">(</span><span class="s1">&#39;month&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;first_order_timestamp&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nb">date</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">calendar</span><span class="p">.</span><span class="n">date_day</span>

<span class="p">),</span><span class="w"> </span><span class="n">orders_joined</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">customer_calendar</span><span class="p">.</span><span class="n">date_month</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">customer_calendar</span><span class="p">.</span><span class="n">customer_id</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">customer_calendar</span><span class="p">.</span><span class="n">first_order_timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="n">customer_calendar</span><span class="p">.</span><span class="n">cohort_month</span><span class="p">,</span>
<span class="w">        </span><span class="n">customer_calendar</span><span class="p">.</span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">order_id</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">order_count_in_month</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="k">sum</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">order_adjusted_total</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">total_price_in_month</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="k">sum</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">line_item_count</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">line_item_count_in_month</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">customer_calendar</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">orders</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">customer_calendar</span><span class="p">.</span><span class="n">customer_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">customer_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">customer_calendar</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">source_relation</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">customer_calendar</span><span class="p">.</span><span class="n">date_month</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">cast</span><span class="p">(</span><span class="err">{{</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">date_trunc</span><span class="p">(</span><span class="s1">&#39;month&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;created_timestamp&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nb">date</span><span class="p">)</span>
<span class="w">    </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_utils</span><span class="p">.</span><span class="n">group_by</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="p">),</span><span class="w"> </span><span class="n">windows</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="n">partition_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;partition by &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">shopify</span><span class="p">.</span><span class="n">shopify_partition_by_cols</span><span class="p">(</span><span class="s1">&#39;customer_id&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;source_relation&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;order by date_month rows between unbounded preceding and current row&#39;</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="o">*</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">total_price_in_month</span><span class="p">)</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="p">(</span><span class="err">{{</span><span class="w"> </span><span class="n">partition_string</span><span class="w"> </span><span class="err">}}</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">total_price_lifetime</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">order_count_in_month</span><span class="p">)</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="p">(</span><span class="err">{{</span><span class="w"> </span><span class="n">partition_string</span><span class="w"> </span><span class="err">}}</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">order_count_lifetime</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">line_item_count_in_month</span><span class="p">)</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="p">(</span><span class="err">{{</span><span class="w"> </span><span class="n">partition_string</span><span class="w"> </span><span class="err">}}</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">line_item_count_lifetime</span><span class="p">,</span>
<span class="w">        </span><span class="n">row_number</span><span class="p">()</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="p">(</span><span class="w"> </span>
<span class="w">            </span><span class="n">partition</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">shopify</span><span class="p">.</span><span class="n">shopify_partition_by_cols</span><span class="p">(</span><span class="s1">&#39;customer_id&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;source_relation&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="w">            </span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">date_month</span><span class="w"> </span><span class="k">asc</span><span class="p">)</span><span class="w"> </span>
<span class="w">            </span><span class="k">as</span><span class="w"> </span><span class="n">cohort_month_number</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">orders_joined</span>

<span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">is_incremental</span><span class="p">()</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
<span class="p">),</span><span class="w"> </span><span class="n">backfill_lifetime_sums</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="c1">-- for incremental runs we need to fetch the prior lifetimes to properly continue adding to them</span>
<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="n">customer_id</span><span class="p">,</span>
<span class="w">        </span><span class="k">max</span><span class="p">(</span><span class="n">total_price_lifetime</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">previous_total_price_lifetime</span><span class="p">,</span>
<span class="w">        </span><span class="k">max</span><span class="p">(</span><span class="n">order_count_lifetime</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">previous_order_count_lifetime</span><span class="p">,</span>
<span class="w">        </span><span class="k">max</span><span class="p">(</span><span class="n">line_item_count_lifetime</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">previous_line_item_count_lifetime</span><span class="p">,</span>
<span class="w">        </span><span class="k">max</span><span class="p">(</span><span class="n">cohort_month_number</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">previous_cohort_month_number</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="err">}}</span>
<span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="n">date_month</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">shopify</span><span class="p">.</span><span class="n">shopify_lookback</span><span class="p">(</span><span class="n">from_date</span><span class="o">=</span><span class="ss">&quot;max(date_month)&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">interval</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">datepart</span><span class="o">=</span><span class="s1">&#39;month&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="w">    </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>

<span class="p">),</span><span class="w"> </span><span class="k">final</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">windows</span><span class="p">.</span><span class="n">date_month</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">windows</span><span class="p">.</span><span class="n">customer_id</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">windows</span><span class="p">.</span><span class="n">first_order_timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="n">windows</span><span class="p">.</span><span class="n">cohort_month</span><span class="p">,</span>
<span class="w">        </span><span class="n">windows</span><span class="p">.</span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="n">windows</span><span class="p">.</span><span class="n">order_count_in_month</span><span class="p">,</span>
<span class="w">        </span><span class="n">windows</span><span class="p">.</span><span class="n">total_price_in_month</span><span class="p">,</span>
<span class="w">        </span><span class="n">windows</span><span class="p">.</span><span class="n">line_item_count_in_month</span><span class="p">,</span>
<span class="w">        </span><span class="n">backfill_lifetime_sums</span><span class="p">.</span><span class="n">previous_cohort_month_number</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">windows</span><span class="p">.</span><span class="n">cohort_month_number</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">cohort_month_number</span><span class="p">,</span>
<span class="w">        </span><span class="n">backfill_lifetime_sums</span><span class="p">.</span><span class="n">previous_total_price_lifetime</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">windows</span><span class="p">.</span><span class="n">total_price_lifetime</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">total_price_lifetime</span><span class="p">,</span>
<span class="w">        </span><span class="n">backfill_lifetime_sums</span><span class="p">.</span><span class="n">previous_order_count_lifetime</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">windows</span><span class="p">.</span><span class="n">order_count_lifetime</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">order_count_lifetime</span><span class="p">,</span>
<span class="w">        </span><span class="n">backfill_lifetime_sums</span><span class="p">.</span><span class="n">previous_line_item_count_lifetime</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">windows</span><span class="p">.</span><span class="n">line_item_count_lifetime</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">line_item_count_lifetime</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_utils</span><span class="p">.</span><span class="n">generate_surrogate_key</span><span class="p">([</span><span class="s1">&#39;windows.date_month&#39;</span><span class="p">,</span><span class="s1">&#39;windows.customer_id&#39;</span><span class="p">,</span><span class="s1">&#39;windows.source_relation&#39;</span><span class="p">])</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">customer_cohort_id</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">windows</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">backfill_lifetime_sums</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">backfill_lifetime_sums</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">windows</span><span class="p">.</span><span class="n">source_relation</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">backfill_lifetime_sums</span><span class="p">.</span><span class="n">customer_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">windows</span><span class="p">.</span><span class="n">customer_id</span>

<span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
<span class="p">),</span><span class="w"> </span><span class="k">final</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="o">*</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_utils</span><span class="p">.</span><span class="n">generate_surrogate_key</span><span class="p">([</span><span class="s1">&#39;date_month&#39;</span><span class="p">,</span><span class="s1">&#39;customer_id&#39;</span><span class="p">,</span><span class="s1">&#39;source_relation&#39;</span><span class="p">])</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">customer_cohort_id</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">windows</span>

<span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="n">endif</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="k">final</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>cohort_month</td>
  <td>The month the cohort belongs to, i.e the first month the customer had an order.</td>
</tr>
<tr>
  <td>cohort_month_number</td>
  <td>The 'number' of the `date_month` of the record, i.e. how many months from their start month this cohort occurred</td>
</tr>
<tr>
  <td>customer_cohort_id</td>
  <td>Unique key representing a customer in a given month. Hashed on 'date_month', 'customer_id', and 'source_relation'.</td>
</tr>
<tr>
  <td>customer_id</td>
  <td>The ID of the related customer.</td>
</tr>
<tr>
  <td>date_month</td>
  <td>The calendar month the customer stats relate to.</td>
</tr>
<tr>
  <td>first_order_timestamp</td>
  <td>The timestamp of the customer's first order.</td>
</tr>
<tr>
  <td>line_item_count_in_month</td>
  <td>Number of line items purchased in the `date_month`</td>
</tr>
<tr>
  <td>line_item_count_lifetime</td>
  <td>Number of line items purchased up until and including this `date_month`.</td>
</tr>
<tr>
  <td>order_count_in_month</td>
  <td>Number of orders purchased in the `date_month`</td>
</tr>
<tr>
  <td>order_count_lifetime</td>
  <td>Number of orders purchased up until and including this `date_month`.</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The schema or database this record came from if you are making use of the `shopify_union_schemas` or `shopify_union_databases` variables, respectively. Empty string if you are not using either of these variables to union together multiple Shopify connectors.</td>
</tr>
<tr>
  <td>total_price_in_month</td>
  <td>Total amount (in shop currency) purchased in the `date_month`</td>
</tr>
<tr>
  <td>total_price_lifetime</td>
  <td>Total amount (in shop currency) up until and including this `date_month`.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_90Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">90. model.shopify.shopify__customer_email_cohorts</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    Each record represents a customer's (on the EMAIL grain) performance in a calendar month.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="err">{{</span>
<span class="w">    </span><span class="n">config</span><span class="p">(</span>
<span class="w">        </span><span class="n">materialized</span><span class="o">=</span><span class="s1">&#39;table&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">shopify</span><span class="p">.</span><span class="n">shopify_is_databricks_sql_warehouse</span><span class="p">()</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;incremental&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">unique_key</span><span class="o">=</span><span class="s1">&#39;customer_cohort_id&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">incremental_strategy</span><span class="o">=</span><span class="s1">&#39;insert_overwrite&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">target</span><span class="p">.</span><span class="k">type</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;bigquery&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;databricks&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;spark&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;delete+insert&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">partition_by</span><span class="o">=</span><span class="err">{</span>
<span class="w">            </span><span class="ss">&quot;field&quot;</span><span class="p">:</span><span class="w"> </span><span class="ss">&quot;date_month&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="ss">&quot;data_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="ss">&quot;date&quot;</span>
<span class="w">            </span><span class="err">}</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">target</span><span class="p">.</span><span class="k">type</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;spark&#39;</span><span class="p">,</span><span class="s1">&#39;databricks&#39;</span><span class="p">)</span><span class="w"> </span>
<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;date_month&#39;</span><span class="p">],</span>
<span class="w">        </span><span class="n">cluster_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;date_month&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;email&#39;</span><span class="p">],</span>
<span class="w">        </span><span class="n">file_format</span><span class="o">=</span><span class="s1">&#39;delta&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">shopify</span><span class="p">.</span><span class="n">shopify_is_databricks_sql_warehouse</span><span class="p">()</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;parquet&#39;</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span>
<span class="err">}}</span>

<span class="k">with</span><span class="w"> </span><span class="n">calendar</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;shopify__calendar&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="k">cast</span><span class="p">(</span><span class="err">{{</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">date_trunc</span><span class="p">(</span><span class="s1">&#39;month&#39;</span><span class="p">,</span><span class="s1">&#39;date_day&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nb">date</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">date_day</span>

<span class="w">    </span><span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">is_incremental</span><span class="p">()</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
<span class="w">    </span><span class="k">and</span><span class="w"> </span><span class="k">cast</span><span class="p">(</span><span class="n">date_day</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nb">date</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">shopify</span><span class="p">.</span><span class="n">shopify_lookback</span><span class="p">(</span><span class="n">from_date</span><span class="o">=</span><span class="ss">&quot;max(date_month)&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">interval</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">datepart</span><span class="o">=</span><span class="s1">&#39;month&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="w">    </span><span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="n">endif</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>

<span class="p">),</span><span class="w"> </span><span class="n">customers</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;shopify__customer_emails&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="p">),</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;shopify__orders&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="p">),</span><span class="w"> </span><span class="n">customer_calendar</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="k">cast</span><span class="p">(</span><span class="n">calendar</span><span class="p">.</span><span class="n">date_day</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nb">date</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">date_month</span><span class="p">,</span>
<span class="w">        </span><span class="n">customers</span><span class="p">.</span><span class="n">email</span><span class="p">,</span>
<span class="w">        </span><span class="n">customers</span><span class="p">.</span><span class="n">first_order_timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="n">customers</span><span class="p">.</span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">date_trunc</span><span class="p">(</span><span class="s1">&#39;month&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;first_order_timestamp&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">cohort_month</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">calendar</span>
<span class="w">    </span><span class="k">inner</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">customers</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="k">cast</span><span class="p">(</span><span class="err">{{</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">date_trunc</span><span class="p">(</span><span class="s1">&#39;month&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;first_order_timestamp&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nb">date</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">calendar</span><span class="p">.</span><span class="n">date_day</span>

<span class="p">),</span><span class="w"> </span><span class="n">orders_joined</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">customer_calendar</span><span class="p">.</span><span class="n">date_month</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">customer_calendar</span><span class="p">.</span><span class="n">email</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">customer_calendar</span><span class="p">.</span><span class="n">first_order_timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="n">customer_calendar</span><span class="p">.</span><span class="n">cohort_month</span><span class="p">,</span>
<span class="w">        </span><span class="n">customer_calendar</span><span class="p">.</span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">order_id</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">order_count_in_month</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="k">sum</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">order_adjusted_total</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">total_price_in_month</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="k">sum</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">line_item_count</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">line_item_count_in_month</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">customer_calendar</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">orders</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">customer_calendar</span><span class="p">.</span><span class="n">email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">email</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">customer_calendar</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="n">source_relation</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">customer_calendar</span><span class="p">.</span><span class="n">date_month</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">cast</span><span class="p">(</span><span class="err">{{</span><span class="w"> </span><span class="n">dbt</span><span class="p">.</span><span class="n">date_trunc</span><span class="p">(</span><span class="s1">&#39;month&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;created_timestamp&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nb">date</span><span class="p">)</span>
<span class="w">    </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_utils</span><span class="p">.</span><span class="n">group_by</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="p">),</span><span class="w"> </span><span class="n">windows</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="n">partition_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;partition by &#39;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">shopify</span><span class="p">.</span><span class="n">shopify_partition_by_cols</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;source_relation&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;order by date_month rows between unbounded preceding and current row&#39;</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="o">*</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">total_price_in_month</span><span class="p">)</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="p">(</span><span class="err">{{</span><span class="w"> </span><span class="n">partition_string</span><span class="w"> </span><span class="err">}}</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">total_price_lifetime</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">order_count_in_month</span><span class="p">)</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="p">(</span><span class="err">{{</span><span class="w"> </span><span class="n">partition_string</span><span class="w"> </span><span class="err">}}</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">order_count_lifetime</span><span class="p">,</span>
<span class="w">        </span><span class="k">sum</span><span class="p">(</span><span class="n">line_item_count_in_month</span><span class="p">)</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="p">(</span><span class="err">{{</span><span class="w"> </span><span class="n">partition_string</span><span class="w"> </span><span class="err">}}</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">line_item_count_lifetime</span><span class="p">,</span>
<span class="w">        </span><span class="n">row_number</span><span class="p">()</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="p">(</span><span class="w"> </span>
<span class="w">            </span><span class="n">partition</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">shopify</span><span class="p">.</span><span class="n">shopify_partition_by_cols</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;source_relation&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="w">            </span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">date_month</span><span class="w"> </span><span class="k">asc</span><span class="p">)</span><span class="w"> </span>
<span class="w">            </span><span class="k">as</span><span class="w"> </span><span class="n">cohort_month_number</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">orders_joined</span>

<span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">is_incremental</span><span class="p">()</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
<span class="p">),</span><span class="w"> </span><span class="n">backfill_lifetime_sums</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="c1">-- for incremental runs we need to fetch the prior lifetimes to properly continue adding to them</span>
<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="n">email</span><span class="p">,</span>
<span class="w">        </span><span class="k">max</span><span class="p">(</span><span class="n">total_price_lifetime</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">previous_total_price_lifetime</span><span class="p">,</span>
<span class="w">        </span><span class="k">max</span><span class="p">(</span><span class="n">order_count_lifetime</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">previous_order_count_lifetime</span><span class="p">,</span>
<span class="w">        </span><span class="k">max</span><span class="p">(</span><span class="n">line_item_count_lifetime</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">previous_line_item_count_lifetime</span><span class="p">,</span>
<span class="w">        </span><span class="k">max</span><span class="p">(</span><span class="n">cohort_month_number</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">previous_cohort_month_number</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="err">}}</span>
<span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="n">date_month</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">shopify</span><span class="p">.</span><span class="n">shopify_lookback</span><span class="p">(</span><span class="n">from_date</span><span class="o">=</span><span class="ss">&quot;max(date_month)&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">interval</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">datepart</span><span class="o">=</span><span class="s1">&#39;month&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="w">    </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>

<span class="p">),</span><span class="w"> </span><span class="k">final</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="n">windows</span><span class="p">.</span><span class="n">date_month</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">windows</span><span class="p">.</span><span class="n">email</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="n">windows</span><span class="p">.</span><span class="n">first_order_timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="n">windows</span><span class="p">.</span><span class="n">cohort_month</span><span class="p">,</span>
<span class="w">        </span><span class="n">windows</span><span class="p">.</span><span class="n">source_relation</span><span class="p">,</span>
<span class="w">        </span><span class="n">windows</span><span class="p">.</span><span class="n">order_count_in_month</span><span class="p">,</span>
<span class="w">        </span><span class="n">windows</span><span class="p">.</span><span class="n">total_price_in_month</span><span class="p">,</span>
<span class="w">        </span><span class="n">windows</span><span class="p">.</span><span class="n">line_item_count_in_month</span><span class="p">,</span>
<span class="w">        </span><span class="n">backfill_lifetime_sums</span><span class="p">.</span><span class="n">previous_cohort_month_number</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">windows</span><span class="p">.</span><span class="n">cohort_month_number</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">cohort_month_number</span><span class="p">,</span>
<span class="w">        </span><span class="n">backfill_lifetime_sums</span><span class="p">.</span><span class="n">previous_total_price_lifetime</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">windows</span><span class="p">.</span><span class="n">total_price_lifetime</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">total_price_lifetime</span><span class="p">,</span>
<span class="w">        </span><span class="n">backfill_lifetime_sums</span><span class="p">.</span><span class="n">previous_order_count_lifetime</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">windows</span><span class="p">.</span><span class="n">order_count_lifetime</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">order_count_lifetime</span><span class="p">,</span>
<span class="w">        </span><span class="n">backfill_lifetime_sums</span><span class="p">.</span><span class="n">previous_line_item_count_lifetime</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">windows</span><span class="p">.</span><span class="n">line_item_count_lifetime</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">line_item_count_lifetime</span><span class="p">,</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_utils</span><span class="p">.</span><span class="n">generate_surrogate_key</span><span class="p">([</span><span class="s1">&#39;windows.date_month&#39;</span><span class="p">,</span><span class="s1">&#39;windows.email&#39;</span><span class="p">,</span><span class="s1">&#39;windows.source_relation&#39;</span><span class="p">])</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">customer_cohort_id</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">windows</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">backfill_lifetime_sums</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">backfill_lifetime_sums</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">windows</span><span class="p">.</span><span class="n">source_relation</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">backfill_lifetime_sums</span><span class="p">.</span><span class="n">email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">windows</span><span class="p">.</span><span class="n">email</span>

<span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
<span class="p">),</span><span class="w"> </span><span class="k">final</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span>
<span class="w">        </span><span class="o">*</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">dbt_utils</span><span class="p">.</span><span class="n">generate_surrogate_key</span><span class="p">([</span><span class="s1">&#39;date_month&#39;</span><span class="p">,</span><span class="s1">&#39;email&#39;</span><span class="p">,</span><span class="s1">&#39;source_relation&#39;</span><span class="p">])</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">customer_cohort_id</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">windows</span>

<span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="n">endif</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="k">final</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>cohort_month</td>
  <td>The month the cohort belongs to, i.e the first month the customer had an order.</td>
</tr>
<tr>
  <td>cohort_month_number</td>
  <td>The 'number' of the `date_month` of the record, i.e. how many months from their start month this cohort occurred</td>
</tr>
<tr>
  <td>customer_cohort_id</td>
  <td>Unique key representing a customer in a given month. Hashed on 'date_month','email', and 'source_relation'.</td>
</tr>
<tr>
  <td>email</td>
  <td>The ID of the related customer.</td>
</tr>
<tr>
  <td>date_month</td>
  <td>The calendar month the customer stats relate to.</td>
</tr>
<tr>
  <td>first_order_timestamp</td>
  <td>The timestamp of the customer's first order.</td>
</tr>
<tr>
  <td>line_item_count_in_month</td>
  <td>Number of line items purchased in the `date_month`</td>
</tr>
<tr>
  <td>line_item_count_lifetime</td>
  <td>Number of line items purchased up until and including this `date_month`.</td>
</tr>
<tr>
  <td>order_count_in_month</td>
  <td>Number of orders purchased in the `date_month`</td>
</tr>
<tr>
  <td>order_count_lifetime</td>
  <td>Number of orders purchased up until and including this `date_month`.</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The schema or database this record came from if you are making use of the `shopify_union_schemas` or `shopify_union_databases` variables, respectively. Empty string if you are not using either of these variables to union together multiple Shopify connectors.</td>
</tr>
<tr>
  <td>total_price_in_month</td>
  <td>Total amount (in shop currency) purchased in the `date_month`</td>
</tr>
<tr>
  <td>total_price_lifetime</td>
  <td>Total amount (in shop currency) up until and including this `date_month`.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
        <div class="collapse" id="model_summary_all_91Content" data-bs-parent="#model_summary_all">
            <h5 class="mb-3">91. model.shopify.shopify__products</h5>
<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Model Description
</div>

<div class="card-body">
    Each record represents a product in Shopify.
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    SQL
</div>

<div class="card-body">
    <div class="highlight"><pre><span></span><span class="k">with</span><span class="w"> </span><span class="n">products</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;int_shopify__products_with_aggregates&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="p">),</span><span class="w"> </span><span class="n">product_order_lines</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;int_shopify__product__order_line_aggregates&#39;</span><span class="p">)</span><span class="err">}}</span>

<span class="p">),</span><span class="w"> </span><span class="n">joined</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="n">products</span><span class="p">.</span><span class="o">*</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">product_order_lines</span><span class="p">.</span><span class="n">quantity_sold</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">total_quantity_sold</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">product_order_lines</span><span class="p">.</span><span class="n">subtotal_sold</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">subtotal_sold</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">product_order_lines</span><span class="p">.</span><span class="n">quantity_sold_net_refunds</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">quantity_sold_net_refunds</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">product_order_lines</span><span class="p">.</span><span class="n">subtotal_sold_net_refunds</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">subtotal_sold_net_refunds</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_order_lines</span><span class="p">.</span><span class="n">first_order_timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_order_lines</span><span class="p">.</span><span class="n">most_recent_order_timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_order_lines</span><span class="p">.</span><span class="n">avg_quantity_per_order_line</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">avg_quantity_per_order_line</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">product_order_lines</span><span class="p">.</span><span class="n">product_total_discount</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">product_total_discount</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_order_lines</span><span class="p">.</span><span class="n">product_avg_discount_per_order_line</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">product_avg_discount_per_order_line</span><span class="p">,</span>
<span class="w">        </span><span class="k">coalesce</span><span class="p">(</span><span class="n">product_order_lines</span><span class="p">.</span><span class="n">product_total_tax</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">product_total_tax</span><span class="p">,</span>
<span class="w">        </span><span class="n">product_order_lines</span><span class="p">.</span><span class="n">product_avg_tax_per_order_line</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">product_avg_tax_per_order_line</span>

<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">products</span>
<span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">product_order_lines</span>
<span class="w">        </span><span class="k">on</span><span class="w"> </span><span class="n">products</span><span class="p">.</span><span class="n">product_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">product_order_lines</span><span class="p">.</span><span class="n">product_id</span>
<span class="w">        </span><span class="k">and</span><span class="w"> </span><span class="n">products</span><span class="p">.</span><span class="n">source_relation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">product_order_lines</span><span class="p">.</span><span class="n">source_relation</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="n">joined</span>
</pre></div>

</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Description
</div>

<div class="card-body">
    <table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
  <th>column_name</th>
  <th>description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>is_deleted</td>
  <td>Whether the record has been deleted in the source system.</td>
</tr>
<tr>
  <td>_fivetran_synced</td>
  <td>The time when a record was last updated by Fivetran.</td>
</tr>
<tr>
  <td>created_timestamp</td>
  <td>The date and time when the product was created.</td>
</tr>
<tr>
  <td>handle</td>
  <td>A unique human-friendly string for the product. Automatically generated from the product's title.</td>
</tr>
<tr>
  <td>product_id</td>
  <td>An unsigned 64-bit integer that's used as a unique identifier for the product. Each id is unique across the Shopify system. No two products will have the same id, even if they're from different shops.</td>
</tr>
<tr>
  <td>product_type</td>
  <td>A categorization for the product used for filtering and searching products.</td>
</tr>
<tr>
  <td>published_timestamp</td>
  <td>The date and time (ISO 8601 format) when the product was published. Can be set to null to unpublish the product from the Online Store channel.</td>
</tr>
<tr>
  <td>published_scope</td>
  <td>Whether the product is published to the Point of Sale channel.</td>
</tr>
<tr>
  <td>title</td>
  <td>The name of the product.</td>
</tr>
<tr>
  <td>updated_timestamp</td>
  <td>The date and time when the product was last modified.</td>
</tr>
<tr>
  <td>vendor</td>
  <td>The name of the product's vendor.</td>
</tr>
<tr>
  <td>total_quantity_sold</td>
  <td>Quantity of the product sold.</td>
</tr>
<tr>
  <td>subtotal_sold</td>
  <td>Total amount (in shop currency) of the product sold.</td>
</tr>
<tr>
  <td>quantity_sold_net_refunds</td>
  <td>Quantity of the product sold, excluding refunds.</td>
</tr>
<tr>
  <td>subtotal_sold_net_refunds</td>
  <td>Total amount (in shop currency) of the product sold, excluding refunds.</td>
</tr>
<tr>
  <td>first_order_timestamp</td>
  <td>The timestamp the product was first ordered.</td>
</tr>
<tr>
  <td>most_recent_order_timestamp</td>
  <td>The timestamp the product was most recently ordered.</td>
</tr>
<tr>
  <td>source_relation</td>
  <td>The schema or database this record came from, if you are unioning multiple connectors. Null if not.</td>
</tr>
<tr>
  <td>avg_quantity_per_order_line</td>
  <td>Average quantity per order line with this product.</td>
</tr>
<tr>
  <td>product_total_discount</td>
  <td>Total discounts associated with the product.</td>
</tr>
<tr>
  <td>product_avg_discount_per_order_line</td>
  <td>Average discount per order line with this product.</td>
</tr>
<tr>
  <td>product_total_tax</td>
  <td>Total taxes associated with the product.</td>
</tr>
<tr>
  <td>product_avg_tax_per_order_line</td>
  <td>Average taxes per order line with this product.</td>
</tr>
<tr>
  <td>count_variants</td>
  <td>Count of product variants.</td>
</tr>
<tr>
  <td>has_product_image</td>
  <td>If the product has an image.</td>
</tr>
<tr>
  <td>status</td>
  <td>The status of the product. Valid values: - active: The product is ready to sell and is available to customers on the online store, sales channels, and apps. By default, existing products are set to active. - archived: The product is no longer being sold and isn't available to customers on sales channels and apps. - draft: The product isn't ready to sell and is unavailable to customers on sales channels and apps. By default, duplicated and unarchived products are set to draft.\n</td>
</tr>
<tr>
  <td>collections</td>
  <td>Comma-separated list of collections associated with the product.</td>
</tr>
<tr>
  <td>tags</td>
  <td>Comma-separated list of tags associated with the product.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="card mb-4 shadow-sm">

<div class="card-header bg-secondary text-white">
    Column Lineage
</div>

<div class="card-body">
     Column lineage is missing from the provided dbt project. <br>  Run Cocoon Deep RAG to automatically generate it for better RAG.
</div>
</div>

        </div>
        
</div>
                    
                            
                
                    </div>
                </div>
            </div>
            <hr>
            <h3 class="h3 mt-5  mb-2 text-center">Step 2: Power Copilot with RAG</h3>
            <p class="text-muted text-center mb-4"><small>Ask any question about data pipelines. The copilot knows your large data pipeline, thanks to Cocoon RAG.</small></p>
        
            <!-- Online Query Section -->
            <div>
                <div class="card">
                    <div class="card-body">
                        <form class="search-form" onsubmit="return handleSubmit(event)">
                            <input 
                                type="text" 
                                class="search-input" 
                                id="question" 
                                placeholder="Enter your question about Shopify DBT project"
                                maxlength="500"
                                required
                            >
                            <button type="submit" class="search-button">Ask Copilot</button>
                        </form>
                        <div class="recommended">
                            <a href="#" onclick="document.getElementById('question').value='What end reports are this DBT project building?'; return false;">Project Summary: Summarize the reports</a>
                            <a href="#" onclick="document.getElementById('question').value='Include the profit margins in the `shopify__product` model'; return false;">New Metric: Build Profit Margins</a>
                            <a href="#" onclick="document.getElementById('question').value='How is the `product_avg_tax_per_order_line` in `shopify__products` model computed?'; return false;">Model Debug: check upstream lineage</a>
                            <a href="#" onclick="document.getElementById('question').value='For `stg_shopify__abandoned_checkout`, I want to update `checkout_id` to `abandoned_checkout_id`. Help me find the edits I need to make for downstream models.'; return false;">Safe Model Edit: check downstream lineage</a>
                            <a href="#" onclick="document.getElementById('question').value='How many abandoned checkouts were there last month?'; return false;">New Model: fast pipeline prototyping</a>
                            <a href="#" onclick="document.getElementById('question').value='Are there any bottlenecks in our shipping process?'; return false;">High-level Business Question: quick brainstorm</a>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="bg-light p-4 mb-5 text-center">
            <a href="https://github.com/Cocoon-Data-Transformation/cocoon" target="_blank">
                <img src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png" alt="GitHub Logo" style="width: 100px; height: 100px;">
            </a>
            <h3 class="h4 mt-3">This project is open-sourced</h3>
            <p class="mb-2">Need support or have questions?</p>
            <p>Contact: <a href="mailto:zh2408@columbia.edu">zh2408@columbia.edu</a></p>
        </section>
  </div>




    <script>
        function cleanQuestion(question) {
            const validCharsRegex = /[a-zA-Z0-9 .,?!-]/g;
            const cleanedChars = question.match(validCharsRegex) || [];
            return cleanedChars.join('');
        }

        function handleSubmit(event) {
            event.preventDefault();
            const question = document.getElementById('question').value;
            const cleanedQuestion = cleanQuestion(question);
            window.location.href = `http://34.123.27.155:5000/genai/dbt_shopify/${encodeURIComponent(cleanedQuestion)}`;
            return false;
        }
    </script>
</body>
</html>