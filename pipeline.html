<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shopify DBT RAG for Copilot</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #333;
        }
        .highlight {
            background: #272822;
            color: #f8f8f2;
            border-radius: 4px;
            padding: 1em;
            margin: 1em 0;
            overflow-x: auto;
            font-size: 12px;
        }

        .container {
            max-width: 1200px;
            padding: 40px 20px;
        }
        .search-form {
            display: flex;
            margin-bottom: 30px;
        }
        .search-input {
            flex-grow: 1;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 4px 0 0 4px;
            font-size: 16px;
        }
        .search-button {
            background-color: #000;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 0 4px 4px 0;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        .search-button:hover {
            background-color: #333;
        }
        .recommended {
            margin-top: 30px;
        }
        .recommended a {
            display: inline-block;
            margin-right: 10px;
            margin-bottom: 10px;
            padding: 8px 16px;
            border: 1px solid #ddd;
            border-radius: 20px;
            text-decoration: none;
            color: #555;
            font-size: 14px;
            transition: all 0.3s;
        }
        .recommended a:hover {
            background-color: #e9ecef;
            color: #333;
        }
        .header {
            margin-bottom: 40px;
        }
        .logo {
            font-size: 24px;
            font-weight: bold;
        }
        .subtitle {
            font-size: 16px;
            color: #6c757d;
        }
        .cocoon-info {
            background-color: #e9ecef;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
        }
        .video-container {
            margin-top: 40px;
            text-align: center;
        }
        .lineage-container {
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin-top: 30px;
        }
        .project-link {
            color: inherit;
            text-decoration: underline;
        }
        .project-link:hover {
            color: inherit;
        }
    </style>
</head>
<body class="bg-light">
  <div class="container py-5">
      <header class="text-center mb-5">
          <h1 class="fw-bold mb-3">Cocoon: RAG large Data Pipeline with Lineage</h1>
          <p class="lead mb-4 mx-auto">This solves the key challenge: DBT copilot is hard because data models are overwhelmingly large and complex</p>
      </header>

      <!-- Live RAG Demo Section -->
      <section class="bg-white p-4 rounded shadow-sm mb-5">
        <h2 class="h3 mb-4 text-center">Try Our Live RAG Demo on <a href="https://github.com/fivetran/dbt_shopify" target="_blank" class="project-link">Shopify dbt project</a></h2>
          <form onsubmit="return handleSubmit(event)">
              <div class="input-group mb-3">
                  <input type="text" class="form-control form-control-lg" id="question" placeholder="Enter your question about Shopify DBT project to see how RAG works" maxlength="500">
                  <button type="submit" class="btn btn-primary btn-lg">Ask Copilot</button>
              </div>
          </form>

          <div class="recommended">
            <a href="#" onclick="document.getElementById('question').value='What end reports are this DBT project building?'; return false;">Project Summary: Summarize the reports</a>
            <a href="#" onclick="document.getElementById('question').value='Include the profit margins in the `shopify__product` model'; return false;">New Metric: Build Profit Margins</a>
            <a href="#" onclick="document.getElementById('question').value='How is the `product_avg_tax_per_order_line` in `shopify__products` model computed?'; return false;">Model Debug: check upstream lineage</a>
            <a href="#" onclick="document.getElementById('question').value='For `stg_shopify__abandoned_checkout`, I want to update `checkout_id` to `abandoned_checkout_id`. Help me find the edits I need to make for downstream models.'; return false;">Safe Model Edit: check downstream lineage</a>
            <a href="#" onclick="document.getElementById('question').value='How many abandoned checkouts were there last month?'; return false;">New Model: fast pipeline prototyping</a>
            <a href="#" onclick="document.getElementById('question').value='Are there any bottlenecks in our shipping process?'; return false;">High-level Business Question: quick brainstorm</a>
        </div>
      </section>

      <!-- Video and Notebook CTA Section -->
      <section class="bg-white p-4 rounded shadow-sm">
          <div class="row align-items-center">
              <div class="col-lg-7 mb-4 mb-lg-0">
                  <div class="ratio ratio-16x9">
                      <iframe src="https://www.youtube.com/embed/kv5mwTkpfY0" allowfullscreen></iframe>
                  </div>
              </div>
              <div class="col-lg-5">
                  <h2 class="h3 mb-4">Get Started with Cocoon</h2>
                  <p class="mb-4">Watch our demo video to see how Cocoon works, then try it yourself with our interactive notebook.</p>
                  <a href="https://colab.research.google.com/github/Cocoon-Data-Transformation/cocoon/blob/main/demo/Cocoon_RAG_pipeline.ipynb" target="_blank" class="btn btn-primary btn-lg w-100">Try the Notebook</a>
              </div>
          </div>
      </section>
  </div>




    <script>
        function cleanQuestion(question) {
            const validCharsRegex = /[a-zA-Z0-9 .,?!-]/g;
            const cleanedChars = question.match(validCharsRegex) || [];
            return cleanedChars.join('');
        }

        function handleSubmit(event) {
            event.preventDefault();
            const question = document.getElementById('question').value;
            const cleanedQuestion = cleanQuestion(question);
            window.location.href = `http://34.123.27.155:5000/genai/dbt_shopify/${encodeURIComponent(cleanedQuestion)}`;
            return false;
        }
    </script>
</body>
</html>